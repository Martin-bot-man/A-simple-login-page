"use strict";(()=>{var bI=Object.create;var po=Object.defineProperty;var qI=Object.getOwnPropertyDescriptor;var RI=Object.getOwnPropertyNames;var JI=Object.getPrototypeOf,TI=Object.prototype.hasOwnProperty;var $A=(A,e)=>()=>(e||A((e={exports:{}}).exports,e),e.exports);var KI=(A,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of RI(e))!TI.call(A,o)&&o!==t&&po(A,o,{get:()=>e[o],enumerable:!(i=qI(e,o))||i.enumerable});return A};var M=(A,e,t)=>(t=A!=null?bI(JI(A)):{},KI(e||!A||!A.__esModule?po(t,"default",{value:A,enumerable:!0}):t,A));var q=$A((Ci,dn)=>{(function(A,e){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],e);else if(typeof Ci<"u")e(dn);else{var t={exports:{}};e(t),A.browser=t.exports}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Ci,function(A){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){let e="The message port closed before a response was received.",t=i=>{let o={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(o).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(l,g=void 0){super(g),this.createItem=l}get(l){return this.has(l)||this.set(l,this.createItem(l)),super.get(l)}}let a=B=>B&&typeof B=="object"&&typeof B.then=="function",n=(B,l)=>(...g)=>{i.runtime.lastError?B.reject(new Error(i.runtime.lastError.message)):l.singleCallbackArg||g.length<=1&&l.singleCallbackArg!==!1?B.resolve(g[0]):B.resolve(g)},I=B=>B==1?"argument":"arguments",s=(B,l)=>function(c,...D){if(D.length<l.minArgs)throw new Error(`Expected at least ${l.minArgs} ${I(l.minArgs)} for ${B}(), got ${D.length}`);if(D.length>l.maxArgs)throw new Error(`Expected at most ${l.maxArgs} ${I(l.maxArgs)} for ${B}(), got ${D.length}`);return new Promise((G,O)=>{if(l.fallbackToNoCallback)try{c[B](...D,n({resolve:G,reject:O},l))}catch{c[B](...D),l.fallbackToNoCallback=!1,l.noCallback=!0,G()}else l.noCallback?(c[B](...D),G()):c[B](...D,n({resolve:G,reject:O},l))})},E=(B,l,g)=>new Proxy(l,{apply(c,D,G){return g.call(D,B,...G)}}),f=Function.call.bind(Object.prototype.hasOwnProperty),y=(B,l={},g={})=>{let c=Object.create(null),D={has(O,N){return N in B||N in c},get(O,N,eA){if(N in c)return c[N];if(!(N in B))return;let Y=B[N];if(typeof Y=="function")if(typeof l[N]=="function")Y=E(B,B[N],l[N]);else if(f(g,N)){let mA=s(N,g[N]);Y=E(B,B[N],mA)}else Y=Y.bind(B);else if(typeof Y=="object"&&Y!==null&&(f(l,N)||f(g,N)))Y=y(Y,l[N],g[N]);else if(f(g,"*"))Y=y(Y,l[N],g["*"]);else return Object.defineProperty(c,N,{configurable:!0,enumerable:!0,get(){return B[N]},set(mA){B[N]=mA}}),Y;return c[N]=Y,Y},set(O,N,eA,Y){return N in c?c[N]=eA:B[N]=eA,!0},defineProperty(O,N,eA){return Reflect.defineProperty(c,N,eA)},deleteProperty(O,N){return Reflect.deleteProperty(c,N)}},G=Object.create(B);return new Proxy(G,D)},C=B=>({addListener(l,g,...c){l.addListener(B.get(g),...c)},hasListener(l,g){return l.hasListener(B.get(g))},removeListener(l,g){l.removeListener(B.get(g))}}),k=new r(B=>typeof B!="function"?B:function(g){let c=y(g,{},{getContent:{minArgs:0,maxArgs:0}});B(c)}),S=new r(B=>typeof B!="function"?B:function(g,c,D){let G=!1,O,N=new Promise(h=>{O=function(F){G=!0,h(F)}}),eA;try{eA=B(g,c,O)}catch(h){eA=Promise.reject(h)}let Y=eA!==!0&&a(eA);if(eA!==!0&&!Y&&!G)return!1;let mA=h=>{h.then(F=>{D(F)},F=>{let K;F&&(F instanceof Error||typeof F.message=="string")?K=F.message:K="An unexpected error occurred",D({__mozWebExtensionPolyfillReject__:!0,message:K})}).catch(F=>{})};return mA(Y?eA:N),!0}),p=({reject:B,resolve:l},g)=>{i.runtime.lastError?i.runtime.lastError.message===e?l():B(new Error(i.runtime.lastError.message)):g&&g.__mozWebExtensionPolyfillReject__?B(new Error(g.message)):l(g)},w=(B,l,g,...c)=>{if(c.length<l.minArgs)throw new Error(`Expected at least ${l.minArgs} ${I(l.minArgs)} for ${B}(), got ${c.length}`);if(c.length>l.maxArgs)throw new Error(`Expected at most ${l.maxArgs} ${I(l.maxArgs)} for ${B}(), got ${c.length}`);return new Promise((D,G)=>{let O=p.bind(null,{resolve:D,reject:G});c.push(O),g.sendMessage(...c)})},d={devtools:{network:{onRequestFinished:C(k)}},runtime:{onMessage:C(S),onMessageExternal:C(S),sendMessage:w.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:w.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},m={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return o.privacy={network:{"*":m},services:{"*":m},websites:{"*":m}},y(i,d,o)};A.exports=t(chrome)}else A.exports=globalThis.browser})});var Kn=$A((nw,Ht)=>{(function(){"use strict";var A={}.hasOwnProperty;function e(){for(var o="",r=0;r<arguments.length;r++){var a=arguments[r];a&&(o=i(o,t(a)))}return o}function t(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return e.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var r="";for(var a in o)A.call(o,a)&&o[a]&&(r=i(r,a));return r}function i(o,r){return r?o?o+" "+r:o+r:o}typeof Ht<"u"&&Ht.exports?(e.default=e,Ht.exports=e):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return e}):window.classNames=e})()});var Na=$A(H=>{"use strict";var Oe=Symbol.for("react.element"),RC=Symbol.for("react.portal"),JC=Symbol.for("react.fragment"),TC=Symbol.for("react.strict_mode"),KC=Symbol.for("react.profiler"),PC=Symbol.for("react.provider"),vC=Symbol.for("react.context"),_C=Symbol.for("react.forward_ref"),OC=Symbol.for("react.suspense"),YC=Symbol.for("react.memo"),LC=Symbol.for("react.lazy"),ma=Symbol.iterator;function zC(A){return A===null||typeof A!="object"?null:(A=ma&&A[ma]||A["@@iterator"],typeof A=="function"?A:null)}var wa={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Fa=Object.assign,Da={};function Fe(A,e,t){this.props=A,this.context=e,this.refs=Da,this.updater=t||wa}Fe.prototype.isReactComponent={};Fe.prototype.setState=function(A,e){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,e,"setState")};Fe.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function ka(){}ka.prototype=Fe.prototype;function Ji(A,e,t){this.props=A,this.context=e,this.refs=Da,this.updater=t||wa}var Ti=Ji.prototype=new ka;Ti.constructor=Ji;Fa(Ti,Fe.prototype);Ti.isPureReactComponent=!0;var ha=Array.isArray,Sa=Object.prototype.hasOwnProperty,Ki={current:null},Ga={key:!0,ref:!0,__self:!0,__source:!0};function xa(A,e,t){var i,o={},r=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(r=""+e.key),e)Sa.call(e,i)&&!Ga.hasOwnProperty(i)&&(o[i]=e[i]);var n=arguments.length-2;if(n===1)o.children=t;else if(1<n){for(var I=Array(n),s=0;s<n;s++)I[s]=arguments[s+2];o.children=I}if(A&&A.defaultProps)for(i in n=A.defaultProps,n)o[i]===void 0&&(o[i]=n[i]);return{$$typeof:Oe,type:A,key:r,ref:a,props:o,_owner:Ki.current}}function VC(A,e){return{$$typeof:Oe,type:A.type,key:e,ref:A.ref,props:A.props,_owner:A._owner}}function Pi(A){return typeof A=="object"&&A!==null&&A.$$typeof===Oe}function XC(A){var e={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(t){return e[t]})}var ya=/\/+/g;function Ri(A,e){return typeof A=="object"&&A!==null&&A.key!=null?XC(""+A.key):e.toString(36)}function Kt(A,e,t,i,o){var r=typeof A;(r==="undefined"||r==="boolean")&&(A=null);var a=!1;if(A===null)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(A.$$typeof){case Oe:case RC:a=!0}}if(a)return a=A,o=o(a),A=i===""?"."+Ri(a,0):i,ha(o)?(t="",A!=null&&(t=A.replace(ya,"$&/")+"/"),Kt(o,e,t,"",function(s){return s})):o!=null&&(Pi(o)&&(o=VC(o,t+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(ya,"$&/")+"/")+A)),e.push(o)),1;if(a=0,i=i===""?".":i+":",ha(A))for(var n=0;n<A.length;n++){r=A[n];var I=i+Ri(r,n);a+=Kt(r,e,t,I,o)}else if(I=zC(A),typeof I=="function")for(A=I.call(A),n=0;!(r=A.next()).done;)r=r.value,I=i+Ri(r,n++),a+=Kt(r,e,t,I,o);else if(r==="object")throw e=String(A),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Tt(A,e,t){if(A==null)return A;var i=[],o=0;return Kt(A,i,"","",function(r){return e.call(t,r,o++)}),i}function WC(A){if(A._status===-1){var e=A._result;e=e(),e.then(function(t){(A._status===0||A._status===-1)&&(A._status=1,A._result=t)},function(t){(A._status===0||A._status===-1)&&(A._status=2,A._result=t)}),A._status===-1&&(A._status=0,A._result=e)}if(A._status===1)return A._result.default;throw A._result}var cA={current:null},Pt={transition:null},ZC={ReactCurrentDispatcher:cA,ReactCurrentBatchConfig:Pt,ReactCurrentOwner:Ki};H.Children={map:Tt,forEach:function(A,e,t){Tt(A,function(){e.apply(this,arguments)},t)},count:function(A){var e=0;return Tt(A,function(){e++}),e},toArray:function(A){return Tt(A,function(e){return e})||[]},only:function(A){if(!Pi(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};H.Component=Fe;H.Fragment=JC;H.Profiler=KC;H.PureComponent=Ji;H.StrictMode=TC;H.Suspense=OC;H.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZC;H.cloneElement=function(A,e,t){if(A==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+A+".");var i=Fa({},A.props),o=A.key,r=A.ref,a=A._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,a=Ki.current),e.key!==void 0&&(o=""+e.key),A.type&&A.type.defaultProps)var n=A.type.defaultProps;for(I in e)Sa.call(e,I)&&!Ga.hasOwnProperty(I)&&(i[I]=e[I]===void 0&&n!==void 0?n[I]:e[I])}var I=arguments.length-2;if(I===1)i.children=t;else if(1<I){n=Array(I);for(var s=0;s<I;s++)n[s]=arguments[s+2];i.children=n}return{$$typeof:Oe,type:A.type,key:o,ref:r,props:i,_owner:a}};H.createContext=function(A){return A={$$typeof:vC,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},A.Provider={$$typeof:PC,_context:A},A.Consumer=A};H.createElement=xa;H.createFactory=function(A){var e=xa.bind(null,A);return e.type=A,e};H.createRef=function(){return{current:null}};H.forwardRef=function(A){return{$$typeof:_C,render:A}};H.isValidElement=Pi;H.lazy=function(A){return{$$typeof:LC,_payload:{_status:-1,_result:A},_init:WC}};H.memo=function(A,e){return{$$typeof:YC,type:A,compare:e===void 0?null:e}};H.startTransition=function(A){var e=Pt.transition;Pt.transition={};try{A()}finally{Pt.transition=e}};H.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};H.useCallback=function(A,e){return cA.current.useCallback(A,e)};H.useContext=function(A){return cA.current.useContext(A)};H.useDebugValue=function(){};H.useDeferredValue=function(A){return cA.current.useDeferredValue(A)};H.useEffect=function(A,e){return cA.current.useEffect(A,e)};H.useId=function(){return cA.current.useId()};H.useImperativeHandle=function(A,e,t){return cA.current.useImperativeHandle(A,e,t)};H.useInsertionEffect=function(A,e){return cA.current.useInsertionEffect(A,e)};H.useLayoutEffect=function(A,e){return cA.current.useLayoutEffect(A,e)};H.useMemo=function(A,e){return cA.current.useMemo(A,e)};H.useReducer=function(A,e,t){return cA.current.useReducer(A,e,t)};H.useRef=function(A){return cA.current.useRef(A)};H.useState=function(A){return cA.current.useState(A)};H.useSyncExternalStore=function(A,e,t){return cA.current.useSyncExternalStore(A,e,t)};H.useTransition=function(){return cA.current.useTransition()};H.version="18.2.0"});var vi=$A((vF,Ua)=>{"use strict";Ua.exports=Na()});var Ta=$A((AD,Ja)=>{"use strict";Ja.exports=()=>{let A={};return A.promise=new Promise((e,t)=>{A.resolve=e,A.reject=t}),A}});var Pa=$A((eD,Ka)=>{"use strict";var id=Ta();function od(A,e="maxAge"){let t,i,o,r=async()=>{if(t!==void 0)return;let I=async s=>{o=id();let E=s[1][e]-Date.now();if(E<=0){A.delete(s[0]),o.resolve();return}return t=s[0],i=setTimeout(()=>{A.delete(s[0]),o&&o.resolve()},E),typeof i.unref=="function"&&i.unref(),o.promise};try{for(let s of A)await I(s)}catch{}t=void 0},a=()=>{t=void 0,i!==void 0&&(clearTimeout(i),i=void 0),o!==void 0&&(o.reject(void 0),o=void 0)},n=A.set.bind(A);return A.set=(I,s)=>{A.has(I)&&A.delete(I);let E=n(I,s);return t&&t===I&&a(),r(),E},r(),A}Ka.exports=od});var Li=$A((tD,va)=>{"use strict";var rd=Pa(),Yi=class{constructor(e,t){if(this.maxAge=e,this[Symbol.toStringTag]="Map",this.data=new Map,rd(this.data),t)for(let[i,o]of t)this.set(i,o)}get size(){return this.data.size}clear(){this.data.clear()}delete(e){return this.data.delete(e)}has(e){return this.data.has(e)}get(e){let t=this.data.get(e);if(t)return t.data}set(e,t){return this.data.set(e,{maxAge:Date.now()+this.maxAge,data:t}),this}values(){return this.createIterator(e=>e[1].data)}keys(){return this.data.keys()}entries(){return this.createIterator(e=>[e[0],e[1].data])}forEach(e,t){for(let[i,o]of this.entries())e.apply(t,[o,i,this])}[Symbol.iterator](){return this.entries()}*createIterator(e){for(let t of this.data.entries())yield e(t)}};va.exports=Yi});var PI=typeof global=="object"&&global&&global.Object===Object&&global,At=PI;var vI=typeof self=="object"&&self&&self.Object===Object&&self,_I=At||vI||Function("return this")(),X=_I;var OI=X.Symbol,HA=OI;var fo=Object.prototype,YI=fo.hasOwnProperty,LI=fo.toString,Ge=HA?HA.toStringTag:void 0;function zI(A){var e=YI.call(A,Ge),t=A[Ge];try{A[Ge]=void 0;var i=!0}catch{}var o=LI.call(A);return i&&(e?A[Ge]=t:delete A[Ge]),o}var uo=zI;var VI=Object.prototype,XI=VI.toString;function WI(A){return XI.call(A)}var mo=WI;var ZI="[object Null]",jI="[object Undefined]",ho=HA?HA.toStringTag:void 0;function $I(A){return A==null?A===void 0?jI:ZI:ho&&ho in Object(A)?uo(A):mo(A)}var pA=$I;function Ag(A){return A!=null&&typeof A=="object"}var aA=Ag;var eg="[object Symbol]";function tg(A){return typeof A=="symbol"||aA(A)&&pA(A)==eg}var yo=tg;var ig=Array.isArray,hA=ig;var og=/\s/;function rg(A){for(var e=A.length;e--&&og.test(A.charAt(e)););return e}var wo=rg;var ng=/^\s+/;function ag(A){return A&&A.slice(0,wo(A)+1).replace(ng,"")}var Fo=ag;function Ig(A){var e=typeof A;return A!=null&&(e=="object"||e=="function")}var W=Ig;var Do=NaN,gg=/^[-+]0x[0-9a-f]+$/i,sg=/^0b[01]+$/i,Bg=/^0o[0-7]+$/i,cg=parseInt;function Qg(A){if(typeof A=="number")return A;if(yo(A))return Do;if(W(A)){var e=typeof A.valueOf=="function"?A.valueOf():A;A=W(e)?e+"":e}if(typeof A!="string")return A===0?A:+A;A=Fo(A);var t=sg.test(A);return t||Bg.test(A)?cg(A.slice(2),t?2:8):gg.test(A)?Do:+A}var ri=Qg;function Cg(A){return A}var et=Cg;var dg="[object AsyncFunction]",lg="[object Function]",Eg="[object GeneratorFunction]",pg="[object Proxy]";function fg(A){if(!W(A))return!1;var e=pA(A);return e==lg||e==Eg||e==dg||e==pg}var oe=fg;var ug=X["__core-js_shared__"],tt=ug;var ko=function(){var A=/[^.]+$/.exec(tt&&tt.keys&&tt.keys.IE_PROTO||"");return A?"Symbol(src)_1."+A:""}();function mg(A){return!!ko&&ko in A}var So=mg;var hg=Function.prototype,yg=hg.toString;function wg(A){if(A!=null){try{return yg.call(A)}catch{}try{return A+""}catch{}}return""}var MA=wg;var Fg=/[\\^$.*+?()[\]{}|]/g,Dg=/^\[object .+?Constructor\]$/,kg=Function.prototype,Sg=Object.prototype,Gg=kg.toString,xg=Sg.hasOwnProperty,Ng=RegExp("^"+Gg.call(xg).replace(Fg,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ug(A){if(!W(A)||So(A))return!1;var e=oe(A)?Ng:Dg;return e.test(MA(A))}var Go=Ug;function Hg(A,e){return A?.[e]}var xo=Hg;function Mg(A,e){var t=xo(A,e);return Go(t)?t:void 0}var QA=Mg;var bg=QA(X,"WeakMap"),it=bg;var No=Object.create,qg=function(){function A(){}return function(e){if(!W(e))return{};if(No)return No(e);A.prototype=e;var t=new A;return A.prototype=void 0,t}}(),Uo=qg;function Rg(A,e,t){switch(t.length){case 0:return A.call(e);case 1:return A.call(e,t[0]);case 2:return A.call(e,t[0],t[1]);case 3:return A.call(e,t[0],t[1],t[2])}return A.apply(e,t)}var Ho=Rg;function Jg(){}var Ae=Jg;function Tg(A,e){var t=-1,i=A.length;for(e||(e=Array(i));++t<i;)e[t]=A[t];return e}var ot=Tg;var Kg=800,Pg=16,vg=Date.now;function _g(A){var e=0,t=0;return function(){var i=vg(),o=Pg-(i-t);if(t=i,o>0){if(++e>=Kg)return arguments[0]}else e=0;return A.apply(void 0,arguments)}}var Mo=_g;function Og(A){return function(){return A}}var bo=Og;var Yg=function(){try{var A=QA(Object,"defineProperty");return A({},"",{}),A}catch{}}(),re=Yg;var Lg=re?function(A,e){return re(A,"toString",{configurable:!0,enumerable:!1,value:bo(e),writable:!0})}:et,qo=Lg;var zg=Mo(qo),Ro=zg;function Vg(A,e){for(var t=-1,i=A==null?0:A.length;++t<i&&e(A[t],t,A)!==!1;);return A}var Jo=Vg;var Xg=9007199254740991,Wg=/^(?:0|[1-9]\d*)$/;function Zg(A,e){var t=typeof A;return e=e??Xg,!!e&&(t=="number"||t!="symbol"&&Wg.test(A))&&A>-1&&A%1==0&&A<e}var rt=Zg;function jg(A,e,t){e=="__proto__"&&re?re(A,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):A[e]=t}var ne=jg;function $g(A,e){return A===e||A!==A&&e!==e}var KA=$g;var As=Object.prototype,es=As.hasOwnProperty;function ts(A,e,t){var i=A[e];(!(es.call(A,e)&&KA(i,t))||t===void 0&&!(e in A))&&ne(A,e,t)}var nt=ts;function is(A,e,t,i){var o=!t;t||(t={});for(var r=-1,a=e.length;++r<a;){var n=e[r],I=i?i(t[n],A[n],n,t,A):void 0;I===void 0&&(I=A[n]),o?ne(t,n,I):nt(t,n,I)}return t}var kA=is;var To=Math.max;function os(A,e,t){return e=To(e===void 0?A.length-1:e,0),function(){for(var i=arguments,o=-1,r=To(i.length-e,0),a=Array(r);++o<r;)a[o]=i[e+o];o=-1;for(var n=Array(e+1);++o<e;)n[o]=i[o];return n[e]=t(a),Ho(A,this,n)}}var Ko=os;function rs(A,e){return Ro(Ko(A,e,et),A+"")}var Po=rs;var ns=9007199254740991;function as(A){return typeof A=="number"&&A>-1&&A%1==0&&A<=ns}var at=as;function Is(A){return A!=null&&at(A.length)&&!oe(A)}var SA=Is;function gs(A,e,t){if(!W(t))return!1;var i=typeof e;return(i=="number"?SA(t)&&rt(e,t.length):i=="string"&&e in t)?KA(t[e],A):!1}var vo=gs;function ss(A){return Po(function(e,t){var i=-1,o=t.length,r=o>1?t[o-1]:void 0,a=o>2?t[2]:void 0;for(r=A.length>3&&typeof r=="function"?(o--,r):void 0,a&&vo(t[0],t[1],a)&&(r=o<3?void 0:r,o=1),e=Object(e);++i<o;){var n=t[i];n&&A(e,n,i,r)}return e})}var _o=ss;var Bs=Object.prototype;function cs(A){var e=A&&A.constructor,t=typeof e=="function"&&e.prototype||Bs;return A===t}var PA=cs;function Qs(A,e){for(var t=-1,i=Array(A);++t<A;)i[t]=e(t);return i}var Oo=Qs;var Cs="[object Arguments]";function ds(A){return aA(A)&&pA(A)==Cs}var ni=ds;var Yo=Object.prototype,ls=Yo.hasOwnProperty,Es=Yo.propertyIsEnumerable,ps=ni(function(){return arguments}())?ni:function(A){return aA(A)&&ls.call(A,"callee")&&!Es.call(A,"callee")},ee=ps;function fs(){return!1}var Lo=fs;var Xo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,zo=Xo&&typeof module=="object"&&module&&!module.nodeType&&module,us=zo&&zo.exports===Xo,Vo=us?X.Buffer:void 0,ms=Vo?Vo.isBuffer:void 0,hs=ms||Lo,vA=hs;var ys="[object Arguments]",ws="[object Array]",Fs="[object Boolean]",Ds="[object Date]",ks="[object Error]",Ss="[object Function]",Gs="[object Map]",xs="[object Number]",Ns="[object Object]",Us="[object RegExp]",Hs="[object Set]",Ms="[object String]",bs="[object WeakMap]",qs="[object ArrayBuffer]",Rs="[object DataView]",Js="[object Float32Array]",Ts="[object Float64Array]",Ks="[object Int8Array]",Ps="[object Int16Array]",vs="[object Int32Array]",_s="[object Uint8Array]",Os="[object Uint8ClampedArray]",Ys="[object Uint16Array]",Ls="[object Uint32Array]",L={};L[Js]=L[Ts]=L[Ks]=L[Ps]=L[vs]=L[_s]=L[Os]=L[Ys]=L[Ls]=!0;L[ys]=L[ws]=L[qs]=L[Fs]=L[Rs]=L[Ds]=L[ks]=L[Ss]=L[Gs]=L[xs]=L[Ns]=L[Us]=L[Hs]=L[Ms]=L[bs]=!1;function zs(A){return aA(A)&&at(A.length)&&!!L[pA(A)]}var Wo=zs;function Vs(A){return function(e){return A(e)}}var ae=Vs;var Zo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xe=Zo&&typeof module=="object"&&module&&!module.nodeType&&module,Xs=xe&&xe.exports===Zo,ai=Xs&&At.process,Ws=function(){try{var A=xe&&xe.require&&xe.require("util").types;return A||ai&&ai.binding&&ai.binding("util")}catch{}}(),bA=Ws;var jo=bA&&bA.isTypedArray,Zs=jo?ae(jo):Wo,Ie=Zs;var js=Object.prototype,$s=js.hasOwnProperty;function AB(A,e){var t=hA(A),i=!t&&ee(A),o=!t&&!i&&vA(A),r=!t&&!i&&!o&&Ie(A),a=t||i||o||r,n=a?Oo(A.length,String):[],I=n.length;for(var s in A)(e||$s.call(A,s))&&!(a&&(s=="length"||o&&(s=="offset"||s=="parent")||r&&(s=="buffer"||s=="byteLength"||s=="byteOffset")||rt(s,I)))&&n.push(s);return n}var It=AB;function eB(A,e){return function(t){return A(e(t))}}var gt=eB;var tB=gt(Object.keys,Object),$o=tB;var iB=Object.prototype,oB=iB.hasOwnProperty;function rB(A){if(!PA(A))return $o(A);var e=[];for(var t in Object(A))oB.call(A,t)&&t!="constructor"&&e.push(t);return e}var st=rB;function nB(A){return SA(A)?It(A):st(A)}var ge=nB;function aB(A){var e=[];if(A!=null)for(var t in Object(A))e.push(t);return e}var Ar=aB;var IB=Object.prototype,gB=IB.hasOwnProperty;function sB(A){if(!W(A))return Ar(A);var e=PA(A),t=[];for(var i in A)i=="constructor"&&(e||!gB.call(A,i))||t.push(i);return t}var er=sB;function BB(A){return SA(A)?It(A,!0):er(A)}var GA=BB;var cB=QA(Object,"create"),qA=cB;function QB(){this.__data__=qA?qA(null):{},this.size=0}var tr=QB;function CB(A){var e=this.has(A)&&delete this.__data__[A];return this.size-=e?1:0,e}var ir=CB;var dB="__lodash_hash_undefined__",lB=Object.prototype,EB=lB.hasOwnProperty;function pB(A){var e=this.__data__;if(qA){var t=e[A];return t===dB?void 0:t}return EB.call(e,A)?e[A]:void 0}var or=pB;var fB=Object.prototype,uB=fB.hasOwnProperty;function mB(A){var e=this.__data__;return qA?e[A]!==void 0:uB.call(e,A)}var rr=mB;var hB="__lodash_hash_undefined__";function yB(A,e){var t=this.__data__;return this.size+=this.has(A)?0:1,t[A]=qA&&e===void 0?hB:e,this}var nr=yB;function se(A){var e=-1,t=A==null?0:A.length;for(this.clear();++e<t;){var i=A[e];this.set(i[0],i[1])}}se.prototype.clear=tr;se.prototype.delete=ir;se.prototype.get=or;se.prototype.has=rr;se.prototype.set=nr;var Ii=se;function wB(){this.__data__=[],this.size=0}var ar=wB;function FB(A,e){for(var t=A.length;t--;)if(KA(A[t][0],e))return t;return-1}var _A=FB;var DB=Array.prototype,kB=DB.splice;function SB(A){var e=this.__data__,t=_A(e,A);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():kB.call(e,t,1),--this.size,!0}var Ir=SB;function GB(A){var e=this.__data__,t=_A(e,A);return t<0?void 0:e[t][1]}var gr=GB;function xB(A){return _A(this.__data__,A)>-1}var sr=xB;function NB(A,e){var t=this.__data__,i=_A(t,A);return i<0?(++this.size,t.push([A,e])):t[i][1]=e,this}var Br=NB;function Be(A){var e=-1,t=A==null?0:A.length;for(this.clear();++e<t;){var i=A[e];this.set(i[0],i[1])}}Be.prototype.clear=ar;Be.prototype.delete=Ir;Be.prototype.get=gr;Be.prototype.has=sr;Be.prototype.set=Br;var OA=Be;var UB=QA(X,"Map"),YA=UB;function HB(){this.size=0,this.__data__={hash:new Ii,map:new(YA||OA),string:new Ii}}var cr=HB;function MB(A){var e=typeof A;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?A!=="__proto__":A===null}var Qr=MB;function bB(A,e){var t=A.__data__;return Qr(e)?t[typeof e=="string"?"string":"hash"]:t.map}var LA=bB;function qB(A){var e=LA(this,A).delete(A);return this.size-=e?1:0,e}var Cr=qB;function RB(A){return LA(this,A).get(A)}var dr=RB;function JB(A){return LA(this,A).has(A)}var lr=JB;function TB(A,e){var t=LA(this,A),i=t.size;return t.set(A,e),this.size+=t.size==i?0:1,this}var Er=TB;function ce(A){var e=-1,t=A==null?0:A.length;for(this.clear();++e<t;){var i=A[e];this.set(i[0],i[1])}}ce.prototype.clear=cr;ce.prototype.delete=Cr;ce.prototype.get=dr;ce.prototype.has=lr;ce.prototype.set=Er;var Ne=ce;var KB="Expected a function";function gi(A,e){if(typeof A!="function"||e!=null&&typeof e!="function")throw new TypeError(KB);var t=function(){var i=arguments,o=e?e.apply(this,i):i[0],r=t.cache;if(r.has(o))return r.get(o);var a=A.apply(this,i);return t.cache=r.set(o,a)||r,a};return t.cache=new(gi.Cache||Ne),t}gi.Cache=Ne;var si=gi;function PB(A,e){for(var t=-1,i=e.length,o=A.length;++t<i;)A[o+t]=e[t];return A}var Bt=PB;var vB=gt(Object.getPrototypeOf,Object),Qe=vB;var _B="[object Object]",OB=Function.prototype,YB=Object.prototype,pr=OB.toString,LB=YB.hasOwnProperty,zB=pr.call(Object);function VB(A){if(!aA(A)||pA(A)!=_B)return!1;var e=Qe(A);if(e===null)return!0;var t=LB.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&pr.call(t)==zB}var Ce=VB;function XB(){this.__data__=new OA,this.size=0}var fr=XB;function WB(A){var e=this.__data__,t=e.delete(A);return this.size=e.size,t}var ur=WB;function ZB(A){return this.__data__.get(A)}var mr=ZB;function jB(A){return this.__data__.has(A)}var hr=jB;var $B=200;function Ac(A,e){var t=this.__data__;if(t instanceof OA){var i=t.__data__;if(!YA||i.length<$B-1)return i.push([A,e]),this.size=++t.size,this;t=this.__data__=new Ne(i)}return t.set(A,e),this.size=t.size,this}var yr=Ac;function de(A){var e=this.__data__=new OA(A);this.size=e.size}de.prototype.clear=fr;de.prototype.delete=ur;de.prototype.get=mr;de.prototype.has=hr;de.prototype.set=yr;var ct=de;function ec(A,e){return A&&kA(e,ge(e),A)}var wr=ec;function tc(A,e){return A&&kA(e,GA(e),A)}var Fr=tc;var Gr=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Dr=Gr&&typeof module=="object"&&module&&!module.nodeType&&module,ic=Dr&&Dr.exports===Gr,kr=ic?X.Buffer:void 0,Sr=kr?kr.allocUnsafe:void 0;function oc(A,e){if(e)return A.slice();var t=A.length,i=Sr?Sr(t):new A.constructor(t);return A.copy(i),i}var Qt=oc;function rc(A,e){for(var t=-1,i=A==null?0:A.length,o=0,r=[];++t<i;){var a=A[t];e(a,t,A)&&(r[o++]=a)}return r}var xr=rc;function nc(){return[]}var Ct=nc;var ac=Object.prototype,Ic=ac.propertyIsEnumerable,Nr=Object.getOwnPropertySymbols,gc=Nr?function(A){return A==null?[]:(A=Object(A),xr(Nr(A),function(e){return Ic.call(A,e)}))}:Ct,le=gc;function sc(A,e){return kA(A,le(A),e)}var Ur=sc;var Bc=Object.getOwnPropertySymbols,cc=Bc?function(A){for(var e=[];A;)Bt(e,le(A)),A=Qe(A);return e}:Ct,dt=cc;function Qc(A,e){return kA(A,dt(A),e)}var Hr=Qc;function Cc(A,e,t){var i=e(A);return hA(A)?i:Bt(i,t(A))}var lt=Cc;function dc(A){return lt(A,ge,le)}var Mr=dc;function lc(A){return lt(A,GA,dt)}var br=lc;var Ec=QA(X,"DataView"),Et=Ec;var pc=QA(X,"Promise"),pt=pc;var fc=QA(X,"Set"),ft=fc;var qr="[object Map]",uc="[object Object]",Rr="[object Promise]",Jr="[object Set]",Tr="[object WeakMap]",Kr="[object DataView]",mc=MA(Et),hc=MA(YA),yc=MA(pt),wc=MA(ft),Fc=MA(it),te=pA;(Et&&te(new Et(new ArrayBuffer(1)))!=Kr||YA&&te(new YA)!=qr||pt&&te(pt.resolve())!=Rr||ft&&te(new ft)!=Jr||it&&te(new it)!=Tr)&&(te=function(A){var e=pA(A),t=e==uc?A.constructor:void 0,i=t?MA(t):"";if(i)switch(i){case mc:return Kr;case hc:return qr;case yc:return Rr;case wc:return Jr;case Fc:return Tr}return e});var zA=te;var Dc=Object.prototype,kc=Dc.hasOwnProperty;function Sc(A){var e=A.length,t=new A.constructor(e);return e&&typeof A[0]=="string"&&kc.call(A,"index")&&(t.index=A.index,t.input=A.input),t}var Pr=Sc;var Gc=X.Uint8Array,Bi=Gc;function xc(A){var e=new A.constructor(A.byteLength);return new Bi(e).set(new Bi(A)),e}var Ee=xc;function Nc(A,e){var t=e?Ee(A.buffer):A.buffer;return new A.constructor(t,A.byteOffset,A.byteLength)}var vr=Nc;var Uc=/\w*$/;function Hc(A){var e=new A.constructor(A.source,Uc.exec(A));return e.lastIndex=A.lastIndex,e}var _r=Hc;var Or=HA?HA.prototype:void 0,Yr=Or?Or.valueOf:void 0;function Mc(A){return Yr?Object(Yr.call(A)):{}}var Lr=Mc;function bc(A,e){var t=e?Ee(A.buffer):A.buffer;return new A.constructor(t,A.byteOffset,A.length)}var ut=bc;var qc="[object Boolean]",Rc="[object Date]",Jc="[object Map]",Tc="[object Number]",Kc="[object RegExp]",Pc="[object Set]",vc="[object String]",_c="[object Symbol]",Oc="[object ArrayBuffer]",Yc="[object DataView]",Lc="[object Float32Array]",zc="[object Float64Array]",Vc="[object Int8Array]",Xc="[object Int16Array]",Wc="[object Int32Array]",Zc="[object Uint8Array]",jc="[object Uint8ClampedArray]",$c="[object Uint16Array]",AQ="[object Uint32Array]";function eQ(A,e,t){var i=A.constructor;switch(e){case Oc:return Ee(A);case qc:case Rc:return new i(+A);case Yc:return vr(A,t);case Lc:case zc:case Vc:case Xc:case Wc:case Zc:case jc:case $c:case AQ:return ut(A,t);case Jc:return new i;case Tc:case vc:return new i(A);case Kc:return _r(A);case Pc:return new i;case _c:return Lr(A)}}var zr=eQ;function tQ(A){return typeof A.constructor=="function"&&!PA(A)?Uo(Qe(A)):{}}var mt=tQ;var iQ="[object Map]";function oQ(A){return aA(A)&&zA(A)==iQ}var Vr=oQ;var Xr=bA&&bA.isMap,rQ=Xr?ae(Xr):Vr,Wr=rQ;var nQ="[object Set]";function aQ(A){return aA(A)&&zA(A)==nQ}var Zr=aQ;var jr=bA&&bA.isSet,IQ=jr?ae(jr):Zr,$r=IQ;var gQ=1,sQ=2,BQ=4,An="[object Arguments]",cQ="[object Array]",QQ="[object Boolean]",CQ="[object Date]",dQ="[object Error]",en="[object Function]",lQ="[object GeneratorFunction]",EQ="[object Map]",pQ="[object Number]",tn="[object Object]",fQ="[object RegExp]",uQ="[object Set]",mQ="[object String]",hQ="[object Symbol]",yQ="[object WeakMap]",wQ="[object ArrayBuffer]",FQ="[object DataView]",DQ="[object Float32Array]",kQ="[object Float64Array]",SQ="[object Int8Array]",GQ="[object Int16Array]",xQ="[object Int32Array]",NQ="[object Uint8Array]",UQ="[object Uint8ClampedArray]",HQ="[object Uint16Array]",MQ="[object Uint32Array]",_={};_[An]=_[cQ]=_[wQ]=_[FQ]=_[QQ]=_[CQ]=_[DQ]=_[kQ]=_[SQ]=_[GQ]=_[xQ]=_[EQ]=_[pQ]=_[tn]=_[fQ]=_[uQ]=_[mQ]=_[hQ]=_[NQ]=_[UQ]=_[HQ]=_[MQ]=!0;_[dQ]=_[en]=_[yQ]=!1;function ht(A,e,t,i,o,r){var a,n=e&gQ,I=e&sQ,s=e&BQ;if(t&&(a=o?t(A,i,o,r):t(A)),a!==void 0)return a;if(!W(A))return A;var E=hA(A);if(E){if(a=Pr(A),!n)return ot(A,a)}else{var f=zA(A),y=f==en||f==lQ;if(vA(A))return Qt(A,n);if(f==tn||f==An||y&&!o){if(a=I||y?{}:mt(A),!n)return I?Hr(A,Fr(a,A)):Ur(A,wr(a,A))}else{if(!_[f])return o?A:{};a=zr(A,f,n)}}r||(r=new ct);var C=r.get(A);if(C)return C;r.set(A,a),$r(A)?A.forEach(function(p){a.add(ht(p,e,t,p,A,r))}):Wr(A)&&A.forEach(function(p,w){a.set(w,ht(p,e,t,w,A,r))});var k=s?I?br:Mr:I?GA:ge,S=E?void 0:k(A);return Jo(S||A,function(p,w){S&&(w=p,p=A[w]),nt(a,w,ht(p,e,t,w,A,r))}),a}var on=ht;var bQ=4;function qQ(A){return on(A,bQ)}var ci=qQ;function RQ(A){return function(e,t,i){for(var o=-1,r=Object(e),a=i(e),n=a.length;n--;){var I=a[A?n:++o];if(t(r[I],I,r)===!1)break}return e}}var rn=RQ;var JQ=rn(),nn=JQ;var TQ=function(){return X.Date.now()},yt=TQ;var KQ="Expected a function",PQ=Math.max,vQ=Math.min;function _Q(A,e,t){var i,o,r,a,n,I,s=0,E=!1,f=!1,y=!0;if(typeof A!="function")throw new TypeError(KQ);e=ri(e)||0,W(t)&&(E=!!t.leading,f="maxWait"in t,r=f?PQ(ri(t.maxWait)||0,e):r,y="trailing"in t?!!t.trailing:y);function C(g){var c=i,D=o;return i=o=void 0,s=g,a=A.apply(D,c),a}function k(g){return s=g,n=setTimeout(w,e),E?C(g):a}function S(g){var c=g-I,D=g-s,G=e-c;return f?vQ(G,r-D):G}function p(g){var c=g-I,D=g-s;return I===void 0||c>=e||c<0||f&&D>=r}function w(){var g=yt();if(p(g))return d(g);n=setTimeout(w,S(g))}function d(g){return n=void 0,y&&i?C(g):(i=o=void 0,a)}function m(){n!==void 0&&clearTimeout(n),s=0,i=I=o=n=void 0}function B(){return n===void 0?a:d(yt())}function l(){var g=yt(),c=p(g);if(i=arguments,o=this,I=g,c){if(n===void 0)return k(I);if(f)return clearTimeout(n),n=setTimeout(w,e),C(I)}return n===void 0&&(n=setTimeout(w,e)),a}return l.cancel=m,l.flush=B,l}var tA=_Q;function OQ(A,e,t){(t!==void 0&&!KA(A[e],t)||t===void 0&&!(e in A))&&ne(A,e,t)}var Ue=OQ;function YQ(A){return aA(A)&&SA(A)}var an=YQ;function LQ(A,e){if(!(e==="constructor"&&typeof A[e]=="function")&&e!="__proto__")return A[e]}var He=LQ;function zQ(A){return kA(A,GA(A))}var In=zQ;function VQ(A,e,t,i,o,r,a){var n=He(A,t),I=He(e,t),s=a.get(I);if(s){Ue(A,t,s);return}var E=r?r(n,I,t+"",A,e,a):void 0,f=E===void 0;if(f){var y=hA(I),C=!y&&vA(I),k=!y&&!C&&Ie(I);E=I,y||C||k?hA(n)?E=n:an(n)?E=ot(n):C?(f=!1,E=Qt(I,!0)):k?(f=!1,E=ut(I,!0)):E=[]:Ce(I)||ee(I)?(E=n,ee(n)?E=In(n):(!W(n)||oe(n))&&(E=mt(I))):f=!1}f&&(a.set(I,E),o(E,I,i,r,a),a.delete(I)),Ue(A,t,E)}var gn=VQ;function sn(A,e,t,i,o){A!==e&&nn(e,function(r,a){if(o||(o=new ct),W(r))gn(A,e,a,t,sn,i,o);else{var n=i?i(He(A,a),r,a+"",A,e,o):void 0;n===void 0&&(n=r),Ue(A,a,n)}},GA)}var Bn=sn;var XQ=_o(function(A,e,t,i){Bn(A,e,t,i)}),Me=XQ;var WQ="[object Map]",ZQ="[object Set]",jQ=Object.prototype,$Q=jQ.hasOwnProperty;function AC(A){if(A==null)return!0;if(SA(A)&&(hA(A)||typeof A=="string"||typeof A.splice=="function"||vA(A)||Ie(A)||ee(A)))return!A.length;var e=zA(A);if(e==WQ||e==ZQ)return!A.size;if(PA(A))return!st(A).length;for(var t in A)if($Q.call(A,t))return!1;return!0}var be=AC;var eC=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(A=>[A.name,A]),tC=new Map(eC),cn=tC;var iC=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],Qi=new WeakSet,oC=A=>{Qi.add(A);let e=A.toJSON();return Qi.delete(A),e},rC=A=>cn.get(A)??Error,Cn=({from:A,seen:e,to:t,forceEnumerable:i,maxDepth:o,depth:r,useToJSON:a,serialize:n})=>{if(!t)if(Array.isArray(A))t=[];else if(!n&&Qn(A)){let s=rC(A.name);t=new s}else t={};if(e.push(A),r>=o)return t;if(a&&typeof A.toJSON=="function"&&!Qi.has(A))return oC(A);let I=s=>Cn({from:s,seen:[...e],forceEnumerable:i,maxDepth:o,depth:r,useToJSON:a,serialize:n});for(let[s,E]of Object.entries(A)){if(E&&E instanceof Uint8Array&&E.constructor.name==="Buffer"){t[s]="[object Buffer]";continue}if(E!==null&&typeof E=="object"&&typeof E.pipe=="function"){t[s]="[object Stream]";continue}if(typeof E!="function"){if(!E||typeof E!="object"){try{t[s]=E}catch{}continue}if(!e.includes(A[s])){r++,t[s]=I(A[s]);continue}t[s]="[Circular]"}}for(let{property:s,enumerable:E}of iC)typeof A[s]<"u"&&A[s]!==null&&Object.defineProperty(t,s,{value:Qn(A[s])?I(A[s]):A[s],enumerable:i?!0:E,configurable:!0,writable:!0});return t};function qe(A,e={}){let{maxDepth:t=Number.POSITIVE_INFINITY,useToJSON:i=!0}=e;return typeof A=="object"&&A!==null?Cn({from:A,seen:[],forceEnumerable:!0,maxDepth:t,depth:0,useToJSON:i,serialize:!0}):typeof A=="function"?`[Function: ${A.name||"anonymous"}]`:A}function Qn(A){return!!A&&typeof A=="object"&&"name"in A&&"message"in A&&"stack"in A}var u=M(q());var wt,nC=new Uint8Array(16);function di(){if(!wt&&(wt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!wt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return wt(nC)}var nA=[];for(let A=0;A<256;++A)nA.push((A+256).toString(16).slice(1));function ln(A,e=0){return nA[A[e+0]]+nA[A[e+1]]+nA[A[e+2]]+nA[A[e+3]]+"-"+nA[A[e+4]]+nA[A[e+5]]+"-"+nA[A[e+6]]+nA[A[e+7]]+"-"+nA[A[e+8]]+nA[A[e+9]]+"-"+nA[A[e+10]]+nA[A[e+11]]+nA[A[e+12]]+nA[A[e+13]]+nA[A[e+14]]+nA[A[e+15]]}var aC=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),li={randomUUID:aC};function IC(A,e,t){if(li.randomUUID&&!e&&!A)return li.randomUUID();A=A||{};let i=A.random||(A.rng||di)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){t=t||0;for(let o=0;o<16;++o)e[t+o]=i[o];return e}return ln(i)}var gA=IC;var _e=M(q());var Sn=M(q());var J=M(q());var En=M(q());var gC="__webext_forward_tabs_message__",Ft=new Map,sC=mn(),BC=un(),pn=(A,e)=>{if(sC){let o=cC(A,e);if(o)return o}if(A.view==="sidebar"&&!BC)return;let t=A.type,i=Ft.get(t);if(i)return new Promise(async o=>{try{o({data:await i({sender:e,data:A.data,id:t,originalSender:A.sender})})}catch(r){o({error:qe(r)})}})};function cC(A,e){if(A.type===gC)return new Promise(async(t,i)=>{let{tabId:o,frameId:r,type:a,data:n,view:I}=A.data,s;try{s=o==="sender"?e.tab.id:o==="active"?await fn():o}catch(f){return i(f)}let E=r==="sender"?e.frameId:r;t(En.default.tabs.sendMessage(s,{type:a,data:n,sender:e,view:I},E===void 0?void 0:{frameId:E}))})}function Z(A,e,t={}){let i=t.signal;if(i?.aborted)return Ae;if(Ft.get(A))throw new Error(`Message ID "${A}" already has a listener.`);Ft.set(A,e);let r=()=>Ft.delete(A);return i&&i.addEventListener("abort",r,{once:!0}),()=>{r(),i&&i.removeEventListener("abort",r)}}var hn=M(q());async function j(A,e){let t=await hn.default.storage.local.get(A);return typeof A=="string"?Object.hasOwn(t,A)?t[A]:e:t}var QC=M(q()),Dt=new Map;function Ei(A,e){if(Dt.get(A))throw new Error(`Channel "${A}" already has a listener.`);return Dt.set(A,e),()=>Dt.delete(A)}function yn(A){let e=A.name,t=Dt.get(e);return t?(t(CC(A)),!0):!1}function CC(A){let e=new AbortController,t=!0;A.onDisconnect.addListener(()=>{e.abort(),t=!1});function i(r){return A.onDisconnect.addListener(r),()=>A.onDisconnect.removeListener(r)}function o(r){return A.onMessage.addListener(r),()=>A.onMessage.removeListener(r)}return{signal:e.signal,send:r=>t&&A.postMessage(r),close:()=>t&&A.disconnect(),onMessage:o,onClose:i,async*iter(...r){let a,n=o(s=>a(s)),I=i(()=>a=Ae);r.length&&A.postMessage(r[0]);try{for(;;)yield new Promise(s=>a=s)}finally{n(),I()}}}}function R(A){return J.default.storage.local.get(A)}async function x(A){return J.default.storage.local.set(A)}async function CA(A){return J.default.storage.local.remove(A)}function pi(A,e,t){return typeof A=="string"&&(A=[A]),dC(J.default.storage.local.onChanged,i=>{for(let o of A)if(o in i){e(A.reduce((r,a)=>(r[a]=i[a],r),{}));break}},{signal:t?.signal})}async function fi(A){if(J.default.cookies){let e=await J.default.cookies.get(A);return e?.value?decodeURIComponent(e.value):""}return J.default.runtime.sendMessage({type:"GET_COOKIE",data:A})}async function ui(A){return J.default?.cookies?await J.default.cookies.set(A):J.default.runtime.sendMessage({type:"SET_COOKIE",data:A})}function kt(A){return fi({name:A,url:V.origin})}function mi(A,e,t=360){let i=Math.round(Date.now()/1e3)+86400*t;try{return ui({name:A,value:e,url:V.origin,domain:"."+new URL(V.origin).hostname,expirationDate:i,secure:!0})}catch{}}function Re(A){return J.default.tabs?J.default.tabs.create(A):J.default.runtime.sendMessage({type:"OPEN_URL_IN_NEW_TAB",details:A})}async function wn(A,e){let t=await J.default.tabs.query(A);for(let i of t)i.id&&await J.default.tabs.update(i.id,e)}async function Fn(A){return J.default?.tabs?St(A):J.default.runtime.sendMessage({type:"SWITCH_TAB",queryInfo:A})}async function St(A,e=!1,t){let{url:i,...o}=A,r=new URL(i),a=`${r.origin}${r.pathname}*`,n=await J.default.tabs.query({url:a,...o});if(n.length)for(let I of n)I.id&&(await J.default.tabs.update(I.id,{active:!0}),e&&await J.default.tabs.reload(I.id,t));else{let{url:I,cookieStoreId:s,...E}=A,f={url:Array.isArray(I)?I[0]:I,...E};await J.default.tabs.create(f)}}function hi(A="general",e){let t="/options.html";A&&(t+=`?section=${A}`),e&&(e.startsWith("#")||(e="#"+e),t+=e),J.default.tabs.create({url:t})}function Dn(A){return J.default.runtime.getURL(A)}async function ie(){return(await J.default.tabs.query({active:!0,currentWindow:!0}))[0]}function dC(A,e,t={}){let i=t.signal;if(i?.aborted)return Ae;A.addListener(e);let o=()=>A.removeListener(e);return i&&i.addEventListener("abort",o,{once:!0}),()=>{o(),i&&i.removeEventListener("abort",o)}}async function fn(){let[A]=await J.default.tabs.query({active:!0,currentWindow:!0});if(!A)throw new Error("No active tab");let e=A.id;if(e===void 0)throw new Error("No active tab");return e}function un(){try{let e=J.default.runtime.getManifest().side_panel.default_path,t=new URL(J.default.runtime.getURL(e)),i=new URL(window.location.href);return i.pathname===t.pathname&&i.origin===t.origin}catch{return!1}}function mn(){if(!("serviceWorker"in navigator)&&!J.default.extension.getViews)return!0;try{let A=new URL(window.location.href);return browser.runtime.getManifest().background.scripts.some(t=>{let i=new URL(J.default.runtime.getURL(t));return A.pathname===i.pathname&&A.origin===i.origin})}catch{return!1}}var Je="__TMP_GPT5_INFO__";async function yi(){return(await R({[Je]:null}))[Je]}var wi=Sn.default.runtime.getManifest(),sA=wi.version_name===wi.version+"-e";var Te=sA?"dhoenijjpgpeimemopealfcbiecgceod":"difoiogjjojoaoomphldepapgpbgkhkb",Gt=`ChitChat_${sA?"Edge":"Chrome"}_Ext`,dA=wi.version,Gn=["gpmljinohlbfgmeoaeceoajachkabijo","nlipoenfbbikpbjkfpfillcgkoblgpmj"],xn=["translate"];var Fi="gpt-3.5-turbo";var lC={dev:"https://dev.wisehood.ai",test:"https://dev.wisehood.ai",preview:"https://preview.sider.ai",prod:"https://sider.ai"},EC={dev:"wisehood.ai",test:"wisehood.ai",preview:"sider.ai",prod:"sider.ai"},kn=lC.prod,V={origin:kn,api:`${kn}/api`,domain:EC.prod},Nn="https://www.google-analytics.com/mp/collect",Un="G-0PRFKME4HP";var Hn="6FX_tIISST2SsnSx29yQRg";var pe=(Q=>(Q.English="en",Q["Chinese(Simplified)"]="zh_CN",Q["Chinese(Traditional)"]="zh_TW",Q.Spanish="es",Q.French="fr",Q.Japanese="ja",Q.German="de",Q.Portuguese="pt",Q.Arabic="ar",Q.Russian="ru",Q.Italian="it",Q.Korean="ko",Q.Hindi="hi",Q.Dutch="nl",Q.Polish="pl",Q.Amharic="am",Q.Bulgarian="bg",Q.Bengali="bn",Q.Catalan="ca",Q.Czech="cs",Q.Danish="da",Q.Greek="el",Q.Estonian="et",Q.Persian="fa",Q.Finnish="fi",Q.Filipino="fil",Q.Gujarati="gu",Q.Hebrew="he",Q.Croatian="hr",Q.Hungarian="hu",Q.Indonesian="id",Q.Kannada="kn",Q.Lithuanian="lt",Q.Latvian="lv",Q.Malayalam="ml",Q.Marathi="mr",Q.Malay="ms",Q.Norwegian="no",Q.Romanian="ro",Q.Slovak="sk",Q.Slovenian="sl",Q.Serbian="sr",Q.Swedish="sv",Q.Swahili="sw",Q.Tamil="ta",Q.Telugu="te",Q.Thai="th",Q.Turkish="tr",Q.Ukrainian="uk",Q.Urdu="ur",Q.Vietnamese="vi",Q))(pe||{}),Mn=(Q=>(Q.English="en",Q["English (Australia)"]="en_AU",Q["English (Canada)"]="en_CA",Q["English (India)"]="en_IN",Q["English (UK)"]="en_UK",Q["English (US)"]="en_US",Q["Chinese (Simplified)"]="zh_CN",Q["Chinese (Traditional)"]="zh_TW",Q.Spanish="es",Q["Spanish (Argentina)"]="es_AR",Q["Spanish (Colombia)"]="es_CO",Q["Spanish (Spain)"]="es_ES",Q["Spanish (Mexico)"]="es_MX",Q.French="fr",Q.Japanese="ja",Q.German="de",Q.Portuguese="pt",Q.Arabic="ar",Q["Arabic (Egypt)"]="ar_EG",Q["Arabic (Saudi)"]="ar_SA",Q.Russian="ru",Q.Italian="it",Q.Korean="ko",Q.Hindi="hi",Q.Dutch="nl",Q.Polish="pl",Q["Portuguese (Brazil)"]="pt_BR",Q["Portuguese (Portugal)"]="pt_PT",Q.Amharic="am",Q.Bengali="bn",Q.Bulgarian="bg",Q.Catalan="ca",Q.Croatian="hr",Q.Czech="cs",Q.Danish="da",Q.Estonian="et",Q.Filipino="fil",Q.Finnish="fi",Q.Greek="el",Q.Gujarati="gu",Q.Hebrew="he",Q.Hungarian="hu",Q.Indonesian="id",Q.Kannada="kn",Q.Latvian="lv",Q.Lithuanian="lt",Q.Malay="ms",Q.Malayalam="ml",Q.Marathi="mr",Q.Norwegian="no",Q.Persian="fa",Q.Romanian="ro",Q.Serbian="sr",Q.Slovak="sk",Q.Slovenian="sl",Q.Swahili="sw",Q.Swedish="sv",Q.Tamil="ta",Q.Telugu="te",Q.Thai="th",Q.Turkish="tr",Q.Ukrainian="uk",Q.Urdu="ur",Q.Vietnamese="vi",Q))(Mn||{}),bn={en:"English",zh_CN:"\u4E2D\u6587(\u7B80\u4F53)",zh_TW:"\u4E2D\u6587(\u7E41\u9AD4)",es:"Espa\xF1ol",fr:"Fran\xE7ais",ja:"\u65E5\u672C\u8A9E",de:"Deutsch",pt:"Portugu\xEAs",ar:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",ru:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",it:"Italiano",ko:"\uD55C\uAD6D\uC5B4",hi:"\u0939\u093F\u0928\u094D\u0926\u0940",nl:"Nederlands",pl:"Polski",am:"\u12A0\u121B\u122D\u129B",bg:"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438",bn:"\u09AC\u09BE\u0982\u09B2\u09BE",ca:"Catal\xE0",cs:"\u010Ce\u0161tina",da:"Dansk",el:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",et:"Eesti",fa:"\u0641\u0627\u0631\u0633\u06CC",fi:"Suomi",fil:"Filipino",gu:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0",he:"\u05E2\u05D1\u05E8\u05D9\u05EA",hr:"Hrvatski",hu:"Magyar",id:"Indonesia",kn:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1",lt:"Lietuvi\u0173",lv:"Latvie\u0161u",ml:"\u0D2E\u0D32\u0D2F\u0D3E\u0D33\u0D02",mr:"\u092E\u0930\u093E\u0920\u0940",ms:"Melayu",no:"Norsk",ro:"Rom\xE2n\u0103",sk:"Sloven\u010Dina",sl:"Sloven\u0161\u010Dina",sr:"\u0421\u0440\u043F\u0441\u043A\u0438",sv:"Svenska",sw:"Kiswahili",ta:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD",te:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41",th:"\u0E44\u0E17\u0E22",tr:"T\xFCrk\xE7e",uk:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",ur:"\u0627\u0631\u062F\u0648",vi:"Ti\u1EBFng Vi\u1EC7t"},pC={en:"English",en_AU:"English (Australia)",en_CA:"English (Canada)",en_IN:"English (India)",en_UK:"English (UK)",en_US:"English (US)",zh_CN:"\u4E2D\u6587(\u7B80\u4F53)",zh_TW:"\u4E2D\u6587(\u7E41\u9AD4)",es:"Espa\xF1ol",es_AR:"Espa\xF1ol (Argentina)",es_CO:"Espa\xF1ol (Colombia)",es_ES:"Espa\xF1ol (Spain)",es_MX:"Espa\xF1ol (Mexico)",fr:"Fran\xE7ais",ja:"\u65E5\u672C\u8A9E",de:"Deutsch",pt:"Portugu\xEAs",ar:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",ar_EG:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629 (Egypt)",ar_SA:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629 (Saudi)",ru:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",it:"Italiano",ko:"\uD55C\uAD6D\uC5B4",hi:"\u0939\u093F\u0928\u094D\u0926\u0940",nl:"Nederlands",pl:"Polski",pt_BR:"Portugu\xEAs (Brazil)",pt_PT:"Portugu\xEAs (Portugal)",am:"\u12A0\u121B\u122D\u129B",bn:"\u09AC\u09BE\u0982\u09B2\u09BE",bg:"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438",ca:"Catal\xE0",hr:"Hrvatski",cs:"\u010Ce\u0161tina",da:"Dansk",et:"Eesti",fil:"Filipino",fi:"Suomi",el:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",gu:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0",he:"\u05E2\u05D1\u05E8\u05D9\u05EA",hu:"Magyar",id:"Indonesia",kn:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1",lv:"Latvie\u0161u",lt:"Lietuvi\u0173",ms:"Melayu",ml:"\u0D2E\u0D32\u0D2F\u0D3E\u0D33\u0D02",mr:"\u092E\u0930\u093E\u0920\u0940",no:"Norsk",fa:"\u0641\u0627\u0631\u0633\u06CC",ro:"Rom\xE2n\u0103",sr:"\u0421\u0440\u043F\u0441\u043A\u0438",sk:"Sloven\u010Dina",sl:"Sloven\u0161\u010Dina",sw:"Kiswahili",sv:"Svenska",ta:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD",te:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41",th:"\u0E44\u0E17\u0E22",tr:"T\xFCrk\xE7e",uk:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",ur:"\u0627\u0631\u062F\u0648",vi:"Ti\u1EBFng Vi\u1EC7t"},Di=Object.entries(pe).reduce((A,[e,t])=>(A[t]=e,A),{}),jy=Object.entries(pe).map(([A,e])=>({label:A,value:e,name:bn[e]})),$y=Object.entries(Mn).map(([A,e])=>({label:A,value:e,name:pC[e]})),Aw=Object.entries(bn).map(([A,e])=>({label:e,value:A}));var fe=[{id:"default",title:"Ask ChatGPT",template:"Can you tell me something about $[keywords]? If possible, can you give me some links about it?   If $[keywords] is a code related question, please just write the code",canEdit:!1},{id:"list",title:"Keywords to Questions",template:'List 1 most popular question about "$[keywords]". Then, Answer this question. At last,  list another 4 questions.',canEdit:!1},{id:"suggest",title:"Get related keywords",template:"$[keywords] are my search keywords in Google. Please give me 5 sets of related keywords.",canEdit:!1}];var Ke="provider:siderApi",ew=`${Ke}:SelectedModels`;async function qn(){let A="provider:gpt3",[e="siderApi",t]=await Promise.all([j("provider"),j(A)]);return{provider:e,configs:{gpt3:t}}}var xt=[{key:"summarize",title:"Summarize",template:"Summarize this for a second-grade student: ",visible:!0},{key:"similar-pages",title:"Similar pages",template:"Find 10 similar pages to the following content with link: "},{key:"grammar",title:"Grammar",template:"Correct this to standard English: "},{key:"explain",title:"Explain",template:"Explain the following content: "},{key:"explain-codes",title:"Explain Codes",template:"Explain the following codes: "},{key:"rewrite",title:"Rewrite",template:"Rewrite the following content: "},{key:"translate",title:"Translate",template:"Translate the following content to $[lang] language: "},{key:"qa",title:"Q&A",template:"Answer this question: "}];var yA={login:`${V.origin}/login`,openaiChat:"https://chatgpt.com",openaiLogin:"https://platform.openai.com/login",openaiSignup:"https://platform.openai.com/signup",openaiApiKey:"https://platform.openai.com/account/api-keys",openaiApiSession:"https://chatgpt.com/api/auth/session",edgeStore:"https://microsoftedge.microsoft.com/addons/detail/sider-ai-sidebar/dhoenijjpgpeimemopealfcbiecgceod",chromeStore:"https://chromewebstore.google.com/detail/sider-chatgpt-sidebar-+-v/difoiogjjojoaoomphldepapgpbgkhkb",chromeStoreReview:"https://chromewebstore.google.com/detail/sider-chatgpt-sidebar-+-v/difoiogjjojoaoomphldepapgpbgkhkb/reviews",weChatQrCode:"https://sider.ai/resource/weixin/qrcode.jpeg",producthuntPromoteApi:"https://sider.ai/resource/promotion/extension-promote.json",promoteConfigApi:"https://sider.ai/resource/promotion/promote-config.json"};var fC={key:"j",keyCode:74,metaKey:!0,ctrlKey:!0,altKey:!1,shiftKey:!1};var Nt={"provider:gpt3":{apiKey:"",customURL:"",enableCustomURL:!0,model:"gpt-3.5-turbo"},language:"zh_CN",theme:"light",isShowSearch:!1,triggerMode:"questionMark",selectedSearchTemplate:{id:"suggest",title:""},submitShortcut:"Enter",sidebarShortcut:{altKey:!1,ctrlKey:!0,key:"O",keyCode:79,metaKey:!1,shiftKey:!0},sidebarLocation:"right",sidebarDisplayOption:"overlay",sidebarFab:!0,sidebarFabDisabledHost:{},selectionSidebarFab:!0,sidebarOnStartup:"new",showSelectedTextInSidebarEnable:!0,chatVisiblePromptKeys:[],readVisiblePromptKeys:[],writeVisiblePromptKeys:[],quickActionDispalyModifier:"",quickActionSelectionEnable:!0,quickActionInputSelectionEnable:!0,translatorShortcut:fC,quickActionTriggerKeyword:"//",translatorPinnedTemplates:[],quickActionPinnedReading:[],quickActionPinnedWriting:[],quickActionInputIconEnable:!0,quickActionInputIconDisabledHost:{},translatorHostConfig:{"fab-config.example.com":{favicon:"",enable:!0}},enableWebAssistantVideo:!0,enableWebAssistantArticle:!0,enableWebAssistantQA:!0,enableWebAssistantEmail:!0,enableWebAssistantCode:!0,enableWebAssistantImage:!0,webAssistantImageDisabledHost:{},pageTranslationAutoEn:!0,pageTranslationDisplayStyle:"none",pageTranslationNeverHost:[]};var tw=1024*1024*10,iw=1024*1024*100;var Rn="chatgpt:img:",Jn=["g-BlafpMvzd","g-nleealfRT"],Tn={"g-BlafpMvzd":{flair:{kind:"sidebar_keep"},resource:{files:[],gizmo:{appeal_info:null,author:{display_name:"sider.ai",is_verified:!0,link_to:"https://sider.ai",selected_display:"website",user_id:"user-inve40FQN9r2Tg4j1mlXSMQb",will_receive_support_emails:null},created_at:"2024-01-10T07:08:34.362699+00:00",display:{categories:["productivity"],description:"Top browser expert! Provide 3X accurate responses. Read any links: PDFs, videos, etc. Create 10+ types of files, like mind maps & spreadsheets, from search-derived contents.",name:"Browser Pro",profile_picture_url:"https://files.oaiusercontent.com/file-HKO0TEnSmvIb1M9G1HUyuAZJ?se=2123-12-27T11%3A10%3A22Z&sp=r&sv=2021-08-06&sr=b&rscc=max-age%3D1209600%2C%20immutable&rscd=attachment%3B%20filename%3DFrame%2520616.png&sig=fJSm%2BvONY8TkDO8IopKdwun%2BWeW2Wo9hti5JG%2Bb5Bj4%3D",prompt_starters:["Search for latest AI research outcomes.","Read this link and summarize the key points.","Create a mind map on ChatGPT prompt skills.","Type E to show all extensions."],welcome_message:"Hi, I'm Browser+! How can I assist you today?"},id:"g-BlafpMvzd",instructions:null,last_interacted_at:"2024-01-20T07:48:12.598861+00:00",live_version:null,model:null,organization_id:"org-i9SD3zX6OqRLnBDt97AtVHHk",settings:null,share_recipient:"marketplace",sharing_targets:null,short_url:"g-BlafpMvzd-browser-pro",tags:["public","reportable","uses_function_calls","pinned"],training_disabled:null,updated_at:"2024-01-20T11:10:24.859178+00:00",vanity_metrics:{created_ago_str:"last week",num_conversations:1066,num_conversations_str:"1066",num_pins:0,num_users_interacted_with:0},version:null,voice:{id:"ember"},workspace_approval_date:null,workspace_approved:null,workspace_id:null},product_features:{attachments:{accepted_mime_types:["application/json","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/javascript","text/plain","text/x-c++","text/x-script.python","text/x-typescript","text/markdown","application/pdf","text/x-sh","text/x-csharp","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/x-latext","text/x-tex","text/html","text/x-php","text/x-java","text/x-c","text/x-ruby","application/msword"],can_accept_all_mime_types:!0,image_mime_types:["image/webp","image/gif","image/png","image/jpeg"],type:"retrieval"}},tools:[{id:"gzm_cnf_jSWQ9Aj5eNZu3L3mS3bzGxGI~gzm_tool_l6SR7MvRO40YmUGDO8JfhnU8",metadata:{action_id:"g-d08200cb39473e72a1058ed24f66ff9838cf07c1",auth:{type:"none"},domain:"actions.sider.ai",json_schema:null,privacy_policy_url:"https://sider.ai/policies/privacy",raw_spec:""},settings:null,type:"plugins_prototype"},{id:"gzm_cnf_p4GmqNKla5EIJWaJ78Qjnq0B~gzm_tool_wtkmQ099hG3LZNbfZ6jXBMfN",metadata:null,settings:null,type:"dalle"}]}},"g-nleealfRT":{flair:{kind:"sidebar_keep"},resource:{files:[],gizmo:{appeal_info:null,author:{display_name:"awesomegpts.ai",is_verified:!0,link_to:"https://awesomegpts.ai",selected_display:"website",user_id:"user-MV1EPMI80LBUBFXL3yqj7TxP",will_receive_support_emails:null},created_at:"2023-11-15T09:08:04.569234+00:00",display:{categories:["lifestyle"],description:"Shop Smarter, Save Bigger! Quickly find top-rated gems and the best deals in the shopping sea!",name:"Shopping GPT",profile_picture_url:"https://files.oaiusercontent.com/file-epOlIRgMgGrqAHUd0l3Oq2HP?se=2123-12-22T06%3A43%3A25Z&sp=r&sv=2021-08-06&sr=b&rscc=max-age%3D1209600%2C%20immutable&rscd=attachment%3B%20filename%3DFrame%2520613.png&sig=ryqJXchYBS%2BMGC2aa4EPU6zGnOR93RgQoBXoV12b5KY%3D",prompt_starters:["Compare MacBook series products in a table","Locate nearby headphone retailers","Find sofas with top reviews","Find the cheapest Apple Watch Series 9"],welcome_message:""},id:"g-nleealfRT",instructions:null,last_interacted_at:"2024-01-20T06:16:29.030796+00:00",live_version:null,model:null,organization_id:"org-1uI21Op8M017HxHB8qTGnaym",settings:null,share_recipient:"marketplace",sharing_targets:null,short_url:"g-nleealfRT-shopping-gpt",tags:["public","reportable","uses_function_calls","pinned"],training_disabled:null,updated_at:"2024-01-20T02:52:49.252542+00:00",vanity_metrics:{created_ago_str:"2 months ago",num_conversations:341,num_conversations_str:"341",num_pins:0,num_users_interacted_with:0},version:null,voice:{id:"ember"},workspace_approval_date:null,workspace_approved:null,workspace_id:null},product_features:{attachments:{accepted_mime_types:["text/x-csharp","text/javascript","application/json","text/x-php","application/pdf","text/x-c","application/x-latext","text/html","text/x-sh","text/markdown","text/x-script.python","application/msword","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-typescript","text/x-c++","text/x-ruby","text/plain","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/x-tex","text/x-java"],can_accept_all_mime_types:!0,image_mime_types:["image/gif","image/png","image/jpeg","image/webp"],type:"retrieval"}},tools:[{id:"gzm_cnf_mEdggaHyWwxFTAlH5vuabKsd~gzm_tool_sJQMJJ1tT9JqB6NizdOV6ChU",metadata:{action_id:"g-6a3d44cc7cf012a5f2222be5dadb5cc8140a15e3",auth:{type:"none"},domain:"actions.sider.ai",json_schema:null,privacy_policy_url:"https://sider.ai/policies/privacy",raw_spec:""},settings:null,type:"plugins_prototype"},{id:"gzm_cnf_gWRjhVNf1a0XZfN7oDjbgOEC~gzm_tool_YJucv3shUVUdtXn36lZJWVfs",metadata:null,settings:null,type:"browser"}]}}},Ut=["search","text_to_image","data_analysis"];var T="https://sider-pub.s3.amazonaws.com/videos/set-up/",ow=[{name:"chat",list:[{name:"ai-bot",url:T+"1-chat/1-ai-bots-all-in-one.mp4"},{name:"web-access",url:T+"1-chat/2-web-access.mp4"},{name:"data-analysis",url:T+"1-chat/3-data-analysis.mp4"},{name:"painter",url:T+"1-chat/4-painter-in-chat.mp4"},{name:"prompts",url:T+"1-chat/5-prompts-in-chat.mp4"}]},{name:"translation",list:[{name:"widget",url:T+"2-translation/1-translation-widget.mp4"},{name:"selected",url:T+"2-translation/2-selected-words-translation.mp4"},{name:"input",url:T+"2-translation/3-input-box-translation.mp4"},{name:"page",url:T+"2-translation/4-page-translation.mp4"},{name:"in-chat",url:T+"2-translation/5-translation-in-chat.mp4"},{name:"in-chat2",url:T+"2-translation/6-translation-in-chat2.mp4"}]},{name:"summary",list:[{name:"youtube",url:T+"3-summary/1-youtube-summary.mp4"},{name:"doc",url:T+"3-summary/2-doc-summary.mp4"},{name:"page",url:T+"3-summary/3-page-summary.mp4"},{name:"page2",url:T+"3-summary/4-page-summary2.mp4"}]},{name:"chatpdf",list:[{name:"chatpdf",url:T+"4-chatpdf/1-chatpdf.mp4"}]},{name:"write",list:[{name:"widget",url:T+"5-write/1-write-widget.mp4"},{name:"context",url:T+"5-write/2-context-menu-write.mp4"},{name:"input",url:T+"5-write/3-input-box-write.mp4"}]},{name:"painter",list:[{name:"image",url:T+"6-ai-painter/1-ai-image.mp4"},{name:"bg-remove",url:T+"6-ai-painter/2-background-remover.mp4"},{name:"bg-replace",url:T+"6-ai-painter/3-background-replacer.mp4"},{name:"upscale",url:T+"6-ai-painter/4-image-upscale.mp4"},{name:"eraser",url:T+"6-ai-painter/5-item-eraser.mp4"},{name:"text-remove",url:T+"6-ai-painter/6-text-remover.mp4"}]},{name:"ocr",list:[{name:"ocr",url:T+"7-ocr/1-ocr.mp4"}]},{name:"grammar",list:[{name:"widget",url:T+"8-grammar/1-grammar-widget.mp4"},{name:"context",url:T+"8-grammar/2-context-menu-grammar.mp4"}]},{name:"email",list:[{name:"reply",url:T+"9-email-reply/1-email-reply.mp4"}]}];var uC=M(Kn());var wA=M(q());function ki(A){return[...new Set(A)]}var VA=(...A)=>A.join("/").replace(/([^:])\/{2,}/g,"$1/");function ue(A=1e3){return new Promise(e=>setTimeout(e,A))}async function RA(A,e=1e3,t=2){let i=0;for(;;){try{return await A()}catch(o){if(t>=0&&i++>=t)throw o}await ue(e)}}function xA(A,e=0){let t=!1,i;return function(...o){return t||(t=!0,i=new Promise((r,a)=>{A(...o).then(r).catch(a).finally(async()=>{e&&await ue(e),t=!1})})),i}}function me(A,e,t){return async()=>{let i=Date.now(),o=await R({[A]:0});if(i-o[A]>t){let r=await e();return await x({[A]:i}),r}return null}}function Mt(A){return new Promise((e,t)=>{let i=new FileReader;i.readAsDataURL(A),i.onload=()=>{e(i.result)},i.onerror=t})}async function Pn(){return(await wA.default.cookies.getAll({domain:".chat.openai.com"})).some(t=>t.name=="__Secure-next-auth.session-token")}function vn(A,e,t){let i=wA.default.runtime.getURL("chat/index.html");return wA.default.tabs.query({url:i+"*",currentWindow:!0}).then(async o=>{if(o.length){let r=await wA.default.tabs.update(o[0].id,{active:!0});return e&&e(),r}else return t&&await t(),wA.default.tabs.create({url:i+(A?"?reason="+A:"")})})}async function Si(){let A=wA.default.runtime.getURL("standalone.html"),[e]=await wA.default.tabs.query({currentWindow:!0,url:`${A}*`});return e&&e.id?wA.default.tabs.reload(e.id).then(()=>wA.default.tabs.update(e.id,{active:!0})):wA.default.tabs.create({url:A})}function Gi(A){let e=A.lastIndexOf(".");return A.substring(0,e)}function bt(A,e="https://"){let t=A.trim();return/https?:\/\//.test(t)?t:e+t}var Ew=si(A=>{let e=0;for(let t=0;t<A.length;t++)e=Math.imul(31,e)+A.charCodeAt(t)|0;return""+e});var wC=M(q());var _n=M(q());async function Pe(){let{generatedRandomId:A}=await R({generatedRandomId:""});if(!A){let e=await mC();return e||(e=gA(),hC(e)),_n.default.storage.local.set({generatedRandomId:e}),e}return A}var On=V.origin.replace(/\/\/\w+?\./,"//Y2hhdGdwdC1zaWRlYmFy."),Yn="zgv2awnlswq";async function mC(){try{return await fi({url:On,name:Yn})}catch{return""}}async function hC(A){let e=Math.round(Date.now()/1e3)+31104e3;try{return await ui({url:On,name:Yn,value:A,expirationDate:e,secure:!0})}catch{}}async function fA(){let A=await qt("userinfo-type"),e=await qt("token");if(A===null)return null;let t=!!(e&&A&&A!=="device");return x({logged:t}),t}async function xi(){let{vipInfo:A}=await R({vipInfo:{isVIP:!1,userTypeDetail:"login",resetTimeSec:0,"gpt-3.5":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},"gpt-4":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},"image-creator":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},summary:{total:0,remain:0,cost:3,period:"total"},ocr:{cost:1},reader:{total:0,remain:0,used:0,limitSize:104857600,period:"total"}}});return A}async function BA(A){let e=await xi();return Me(e,A,(t,i)=>{if(Array.isArray(t))return i}),x({vipInfo:e})}async function XA(){let A=await he();return A?{...A,anonymous:!1}:{token:"",refreshToken:"",anonymous:!1}}async function he(){if(await fA()){let A=await qt("token"),e=await qt("refresh_token");return A?{token:A,refreshToken:e}:null}return null}async function qt(A){try{let e=await kt(A);if(!e)throw new Error("");return x({[A]:e}),e}catch{return(await R({[A]:""}))[A]}}function ye(A){let e,t,i,o,r,a,n;return I(),{feed:s,reset:I};function I(){e=!0,t="",i=0,o=-1,r=void 0,a=void 0,n=""}function s(f){t=t?t+f:f,e&&FC(t)&&(t=t.slice(Ln.length)),e=!1;let y=t.length,C=0,k=!1;for(;C<y;){k&&(t[C]===`
`&&++C,k=!1);let S=-1,p=o,w;for(let d=i;S<0&&d<y;++d)w=t[d],w===":"&&p<0?p=d-C:w==="\r"?(k=!0,S=d-C):w===`
`&&(S=d-C);if(S<0){i=y-C,o=p;break}else i=0,o=-1;E(t,C,p,S),C+=S+1}C===y?t="":C>0&&(t=t.slice(C))}function E(f,y,C,k){if(k===0){n.length>0&&(A({type:"event",id:r,event:a||void 0,data:n.slice(0,-1)}),n="",r=void 0),a=void 0;return}let S=C<0,p=f.slice(y,y+(S?k:C)),w=0;S?w=k:f[y+C+1]===" "?w=C+2:w=C+1;let d=y+w,m=k-w,B=f.slice(d,d+m).toString();if(p==="data")n+=B?"".concat(B,`
`):`
`;else if(p==="event")a=B;else if(p==="id"&&!B.includes("\0"))r=B;else if(p==="retry"){let l=parseInt(B,10);Number.isNaN(l)||A({type:"reconnect-interval",value:l})}}}var Ln=[239,187,191];function FC(A){return Ln.every((e,t)=>A.charCodeAt(t)===e)}async function*we(A){let e=A.getReader();try{for(;;){let{done:t,value:i}=await e.read();if(t)return;yield i}}finally{e.releaseLock()}}var Ni={609:"error_sider_premium_required",610:"error_sider_high_traffic",1003:"error_sider_need_login",1006:"error_sider_device_bind_account",1101:"error_sider_processing",1102:"error_sider_api_limit",1107:"error_sider_api_limit2",1109:"error_sider_gpt4_highload",1110:"error_sider_gpt_highload",1112:"error_sider_gpt4_limit",1113:"error_sider_gpt4_limit",1118:"error_sider_image_limit",1127:"error_sider_ocr_limit",1128:"error_sider_summary_video_limit",1501:"error_sider_openai_fault",1515:"error_sider_gemini_pro_busy",1129:"error_sider_basic_text_limit",1130:"error_sider_advanced_text_limit",1132:"error_sider_openai_filter",2003:"error_sider_embedding_limit_by_count"};function ve(A,e){switch(A){case 1102:case 1107:case 1112:case 1113:case 1118:case 1127:case 1128:U.getVipInfoCached();break;default:break}throw new Error(Ui(A,e))}function Ui(A,e){if(A===1129||A===1130){let t=e.match(/restriction of (.*) messages/),i=e.match(/messages every (.*) minute[s]?\. Alternatively/);return Ni[A]+"-"+t[1]+"-"+i[1]}return A in Ni?Ni[A]:typeof e=="string"&&e.startsWith("504")?"error_sider_timeout":e}async function DC(A,e,t){return new Promise((i,o)=>{let r=new XMLHttpRequest;r.open(e.method||"GET",A),e.headers instanceof Headers&&e.headers.forEach((a,n)=>{r.setRequestHeader(n,a)}),r.onload=function(){i(new Response(r.responseText,{status:r.status,statusText:r.statusText}))},r.upload.onprogress=function(a){a.lengthComputable&&t&&t?.(a.loaded/a.total*100)},r.onerror=function(){o(new TypeError("Network request failed"))},r.ontimeout=function(){o(new TypeError("Network request timed out"))},r.send(e.body),e.signal&&(e.signal.onabort=function(){r.abort(),o(new DOMException("Aborted","AbortError"))})})}async function Rt(A,e=null,t={}){A.startsWith("http")||(A=VA(V.api,A));let{onStreamData:i,getAbortMethod:o,noAuth:r,timeout:a,onProgress:n,...I}=t;I.method&&(I.method=I.method.toUpperCase());let s=new AbortController;if(I.signal=s.signal,o?.(()=>{s.abort()}),I.headers=new Headers(I.headers||{}),!r&&!I.headers.has("Authorization")){let C=(await XA()).token;C&&(I.headers.set("Authorization",C),CA("ERR_MUST_LOGIN"))}if(e)try{e instanceof FormData||e instanceof Blob||e instanceof URLSearchParams||e instanceof ReadableStream||e instanceof ArrayBuffer||e instanceof DataView?I.body=e:(I.body=JSON.stringify(e),I.headers.set("Content-Type","application/json"))}catch{I.body=e}let E;a&&(E=setTimeout(()=>s.abort(),a));let f=n?await DC(A,I,n):await fetch(A,I);a&&clearTimeout(E);let y=null;if(i||(y=await f.json().catch(()=>({}))),!f.ok||f.status!==204&&y&&y.code!==0){if(y||(y=await f.json().catch(()=>({}))),y.errMsg=y.msg||y.message,be(y))y.errMsg=`${f.status} ${f.statusText}`;else{(y.code===1003||y.code===1006)&&x({ERR_MUST_LOGIN:!0});try{ve(y.code,y.msg||y.message)}catch(C){y.errMsg=C.message}}throw i&&i({data:null,done:!0}),y}if(i&&f.body){let C=ye(k=>{if(k.type==="event"){let S={code:0,data:null,msg:"",errMsg:"",done:k.data==="[DONE]"},p=null;try{p=JSON.parse(k.data)}catch{}if(p&&(S={...S,...p}),S.code!==0){try{ve(S.code,S.msg)}catch(w){S.errMsg=w.message}throw i({data:null,done:!0}),S}i({data:S.data,done:S.done})}});for await(let k of we(f.body)){let S=new TextDecoder().decode(k);C.feed(S)}}return y?.data}function iA(A,e=null,t={}){return Rt(A,e,{method:"GET",...t})}function v(A,e=null,t={}){return Rt(A,e,{method:"POST",...t})}function Hi(A,e=null,t={}){return Rt(A,e,{method:"POST",...t})}function zn(A,e=null,t={}){return Rt(A,e,{method:"DELETE",...t})}var b=Gt,$=dA,rA=Intl.DateTimeFormat().resolvedOptions().timeZone,Mi="ChitChat_Ext",bi="ChitChat_Ext_UserStatus",U={async refreshToken(A){let e=await v("/v1/user/token/refresh",{refresh_token:A},{headers:{Authorization:""}});return{token:e.token.token,refreshToken:e.token.refresh_token}},getSiderAnonymousToken:xA(async()=>{let A=await Pe();return v("/v1/user/login/device_id",{device_id:A,uuid:A,app_name:b,app_version:$},{headers:{Authorization:""}})}),getUserInfo:async()=>{let A=await iA(`/v1/user/info?app_name=${b}&app_version=${$}`);return await x({userInfo:A}),A},getVipInfo:Vn,getVipInfoCached:xA(Vn,5e3),async getPricingPlan(){let A=await iA("/v1/app/ipinfo",null,{headers:{Authorization:""}}),e=A.region==="CN"||rA==="Asia/Shanghai"&&await j("language","en")==="zh_CN",t=await iA(`/v1/payment/pricing?from=web&location=${e?"CN":A.region}`,null,{headers:{Authorization:""}});x({isCNUser:e,pricingPlan:t.plan.map(i=>({name:i.name,displayName:i.display_name,currency:i.currency,interval:i.interval,originPrice:i.origin_price/100,price:i.price/100}))})},getTMPGPT5Info:me("__GET_TMP_GPT5_INFO_AT__",async()=>{let e=(await iA(`/v1/app/config?app_name=${b}&app_version=${$}&tz_name=${rA}`))?.["tmp-gpt5-info"];e&&e.active?(e.mentionName=e.name.replace(/\s+/g,"-"),x({[Je]:e})):CA(Je)},1*60*60*1e3),getClientConfig:async A=>{let e=await iA(`/v1/app/config?app_name=${b}&app_version=${$}&tz_name=${rA}`);return A?e?.[A]:e},getUserSettings:xA(async()=>await fA()?(await iA(`/v1/user/settings?app_name=${b}&keys=${Mi}`)).keys?.[Mi]:{},2e3),setUserSettings(A){if(!(!A||Object.keys(A).length===0))return RA(()=>v("/v1/user/settings",{app_name:b,key:Mi,key_setting:A}))},getUserStatus:xA(async()=>{let e=(await iA(`/v1/user/settings?app_name=${b}&keys=${bi}`)).keys?.[bi];return e&&Object.keys(e).length&&await x({userStatus:e}),e},2e3),async setUserStatus(A){if(!A||Object.keys(A).length===0)return;await RA(()=>v("/v1/user/settings",{app_name:b,key:bi,key_setting:A}));let{userStatus:e}=await j({userStatus:{}});x({userStatus:{...e||{},...A}})},getUserPromptList(A){return iA(`/v1/prompt/list?type=${A}&page_size=999`)},getAllPromptList:tA(async()=>{let A=await j({language:"",chatVisiblePromptKeys:null,readVisiblePromptKeys:null,writeVisiblePromptKeys:null,sidebarPromptTemplate:null}),e=A.language;if(!e)return;let t={};try{t=await U.getUserSettings()}catch{}let[i,o]=await Promise.all([iA(`/v1/prompt/list_all?app_name=${b}&page_size=999&language=${e}`,null,{headers:{Authorization:(await he())?.token||""}}),iA(`/v1/prompt/list?type=special&app_name=${b}&page_size=999&language=${e}`,null,{headers:{Authorization:(await he())?.token||""}})]),r=i.List;r.sort((p,w)=>(p.sort!==0||p.key==="improve_writing")&&(w.sort!==0||w.key==="improve_writing")?w.sort-p.sort:w.sort===0?1:p.sort===0?-1:0);let a=r.reduce((p,w)=>(p[w.key||w.id]=w,p),{});function n(p){return{id:String(p.id),key:String(p.key||p.id),isCustom:!p.key||p.key.startsWith("custom"),name:p.display_name||p.name,shortName:p.short_name,content:p.content,icon:p.icon,placeholder:p.placeholder,usedIn:p.use||void 0,children:p.has_child?[]:void 0,parentKey:p.parent_key}}let I=[],s={};for(let p of r){let{key:w,has_child:d,parent_key:m}=p;if(d){if(!(w in s)){let l=n(p);s[w]=l,I.push(l)}continue}if(m){let l=a[m];if(!l)continue;if(!(m in s)){let g=n(l);s[m]=g,I.push(g)}s[m]?.children?.push(n(p));continue}let B=n(p);I.push(B)}if(A.sidebarPromptTemplate)for(let p of A.sidebarPromptTemplate)!p.uid&&p.key?.startsWith("custom")&&I.unshift({id:"",key:p.key,isCustom:!0,name:p.title,content:p.template});function E(p,w=!1){let d=[];for(let m of I){let{usedIn:B}=m;(!B||B.includes(p))&&(!w||m.isCustom)&&d.push(m.key)}return d}let f=new Set(I.map(({key:p})=>p)),y=i.Sort,C={chat:["chatVisiblePromptKeys","ChatAsk"],read:["readVisiblePromptKeys","ReadingAssistant"],write:["writeVisiblePromptKeys","WritingAssistant"]},k={};for(let[p,[w,d]]of Object.entries(C)){let m=A[w];m?k[w]=ki([...m.filter(l=>f.has(l)),...E(p)]):k[w]=ki([...E(p,!0),...y[d].split(",").map(l=>l.trim()),...E(p)]);let B=t?.[w];if(B?.length){let l=B.reduce((g,c,D)=>(g[c]=D,g),{});k[w].sort((g,c)=>{let D=l[g],G=l[c],O=typeof D>"u",N=typeof G>"u";return O&&N?0:O?1:N?-1:D-G})}}let S=o.List.map(p=>n(p));await x({...k,allPromptList:I,specialPromptList:S,__DONT_SYNC__:`visiblePromptKeys${Date.now()}`})},1e3),createPrompt(A){return RA(()=>v("/v1/prompt/create",{is_template:!1,type:"sidebar",...A}))},createUserPrompt(A){return RA(()=>v("/v1/prompt/create",{is_template:!1,...A}))},editUserPrompt(A){return RA(()=>v("/v1/prompt/edit",A))},delUserPrompt(A){return RA(()=>v("/v1/prompt/update",{id:A,status:"Deleted"}))},async uploadHistoryMsg(A){return(await v("/v1/conversation/upload",{app_name:b,app_version:$,messages:A})).cid},uploadConversion(A){return v("/v1/conversation/upload",{share:!0,app_name:b,app_version:$,messages:A})},saveConversion(A){return v("/v1/conversation/upload",{save_by_user:!0,app_name:b,app_version:$,messages:A})},async shareConversion(A){return(await iA(`/v1/conversation/share/${A}`)).share_key},saveSiderConversion(A){return iA(`/v1/conversation/save-by-user/${A}`)},unSaveSiderConversion(A){return iA(`/v1/conversation/unsave-by-user/${A}`)},delConversion(A){return zn(`/v1/conversation/delete/${A}`)},checkGrammarError(A){return v("/v1/completion/grammar_check",{content:A,tz_name:rA,app_name:b,app_version:$})},async improveWriting(A){function e(i){if(i?.total){let o={[A.model]:{total:i.total,remain:i.remain,extraTotal:i.extra_total,extraRemain:i.extra_quota,period:i.remain_period}};BA(o)}}let t=tA(e,1e3,{leading:!0});return v("/v1/completion/improve_writing",{content:A.content,model:A.model==="gpt-4"?A.model:"gpt3.5",tz_name:rA,app_name:b,app_version:$},{onStreamData({data:i,done:o}){!o&&i&&t(i),A.onStreamData({text:i?.text||"",done:o})},getAbortMethod(i){}})},async sendFeedback({title:A,detail:e,email:t}){let i=await he();return v("/v1/app/feedback",{title:A,email:t,data:{detail:e},app_name:b,app_version:$},{headers:{Authorization:i?.token||""}})},async sendFiveStarFeedback(A,e){let t=await he(),i=await j("language","en"),o=`[FiveStarRate][${dA}][${i}] Feedback by FiveStarRate`;return v("/v1/app/feedback",{title:o,data:{from:e,detail:A},app_name:b,app_version:$},{headers:{Authorization:t?.token||""}})},async getInviteRewardConfig(){let A=await iA("/v1/invite/config",null,{headers:{Authorization:""}});return x({inviteRewardConfig:{"gpt3.5":A.GPT3Dot5Count,gpt4:A.GPT4Count}}),A},createInviteLink(){return v("/v1/invite/create",{type:"link"})},async getInviteRewardCount(A){let e=await iA(`/v1/invite/reward?app_name=${b}&app_version=${$}&last_req_time=${A}`);return{addedQuery:e.recent_reward_gpt3dot5_count+e.recent_reward_gpt4_count,addedUser:e.recent_invited_count}},inviteFinish:async()=>{let A=await Pe();return v("/v1/invite/finish",{device_id:A})},async summaryVideo(A){function e(C){if(C?.total)if(A.vip){let k={"gpt-3.5":{total:C.total,remain:C.remain,extraTotal:C.extra_total,extraRemain:C.extra_quota,period:C.remain_period}};BA(k)}else{let k={summary:{remain:C.remain}};BA(k)}}let t=tA(e,1e3,{leading:!0}),i={app_name:b,app_version:$,tz_name:rA,content:A.text,title:A.title,language:A.lang,source:A.source,source_type:A.sourceType,request_id:gA(),cid:""},o=[];A.getAbortMethod(()=>{for(let C of o)C()});let{content:r,cid:a,...n}=i,I=null;try{I=await v("/v1/completion/summarize_init",n,{getAbortMethod(C){o.push(C)}})}catch{}I&&(i.cid=I.cid||"");let s=v("/v1/completion/summarize_all",i,{onStreamData({data:C,done:k}){!k&&C&&t(C),A.onStreamData({text:C?.text||"",done:k})},getAbortMethod(C){o.push(C)}}),E=v("/v1/completion/summarize",i,{getAbortMethod(C){o.push(C)}}),[f,y]=await Promise.all([s,E]);return e(y),{text:y.text,subtitle:y.subtitle}},async summaryVideoByEid(A){function e(r){if(r?.total)if(A.vip){let a={[r.chat_model]:{total:r.total,remain:r.remain,extraTotal:r.extra_total,extraRemain:r.extra_quota,period:r.remain_period}};BA(a)}else{let a={summary:{remain:r.remain}};BA(a)}}let t=tA(e,1e3,{leading:!0}),i={app_name:b,app_version:$,tz_name:rA,eid:A.eid,language:A.language},o=await v("/v1/completion/video_summarize",i,{onStreamData({data:r,done:a}){!a&&r?(t(r),r.type==="text"?A.onStreamTextData({text:r.text,done:a}):r.type==="text_done"?A.onStreamTextData({text:r.text,done:!0}):A.onKey_momentsData(r.key_moments)):A.onStreamTextData({text:"",done:a})},getAbortMethod:r=>{A.getAbortMethod&&A.getAbortMethod(()=>{r()})}})},async getSummaryCache(A){let{is_creator:e,eid:t,summary:i,key_moments:o,language:r}=await v("/v1/completion/video_info",{source:A.source,source_type:A.source_type,title:A.title,app_name:b,app_version:$,tz_name:rA,language:A.language});return{is_creator:e,eid:t,summary:i,key_moments:o,language:r}},statUserStop(A,e){return v("/v1/completion/mark-user-stop",{app_name:b,app_version:$,cid:A,mid:e})},async OCR(A,e){let t=new FormData;t.append("file",A),t.append("app_name",b),t.append("app_version",$),t.append("tz_name",rA);let i=await v("/v1/ocr/math",t,{getAbortMethod:e});if(i?.limit){let r={"image-creator":{total:i.limit.total,remain:i.limit.remain,extraTotal:i.limit.extra_total,extraRemain:i.limit.extra_quota,period:i.limit.remain_period}};BA(r)}return i?.result?.text||""},adStat(A){return v("/v1/lp/action",{...A,meta:{browser:sA?"Edge":"Chrome",ext_version:dA}},{headers:{}})},async googleAnalytics(A,e){return _e.default.tabs?v(`${Nn}?measurement_id=${Un}&api_secret=${Hn}`,{client_id:await Pe(),events:[{name:A.replace(/-/gi,"_"),params:{...e}}]},{headers:{Authorization:""}}):_e.default.runtime.sendMessage({type:"GA_API",args:[A,e]})},uploadImage(A){let e=new FormData;return e.append("file",A),Hi("/v1/imagechat/upload",e,{onProgress:t=>{}})},signImageCookie(){return v("/v1/image/sign-cookie")},uploadFile(A,e,t,i,o){let r=new FormData;return r.append("file",A),r.append("app_name",b),r.append("app_version",$),r.append("tz_name",rA),t&&r.append("webpage_url",t),i&&r.append("file_for",i),Hi("/v1/embedding/upload-file",r,{onProgress:e,getAbortMethod:a=>{o&&o(()=>{a()})}}).then(a=>{let n=a.limit;return BA({reader:{total:n.count,remain:n.remain,limitSize:n.size,period:n.period,used:n.used}}),a})},getFileStauts(A){return iA(`/v1/embedding/status?id=${A}`)},async getPromotionCountdown(){let A=await iA(`/v1/user/promotion/promotion_info?app_name=${b}&app_version=${$}&tz_name=${rA}`);return{countdownStartAt:A.countdown_start*1e3,countdownStopAt:A.countdown_stop*1e3,countdownRemain:A.countdown_remain*1e3}}};async function Vn(){let A=await iA(`/v1/completion/limit?app_name=${b}&app_version=${$}&tz_name=${rA}`);if(!A.chat.count)throw x({ERR_MUST_LOGIN:!0}),new Error("wrong_data");let e=A.user_type,t=["device","login","premium"],i=A.chat_period_info,o=A.gpt_4_chat_period_info,r={isVIP:A.user_type==="premium",userTypeDetail:A.user_type_detail,resetTimeSec:A.chat.reset_time,showNewPlan:!!A.show_new_plan,"gpt-3.5":{total:A.chat.count,remain:A.chat.remain,extraTotal:A.chat.extra_total,extraRemain:A.chat.extra_quota,used:A.chat.used,period:A.chat.period,maxToken:i[e]?.prompt_max_token,award:t.reduce((a,n)=>(a[n]={count:i[n].count},a),{})},"gpt-4":{total:A.gpt_4_chat.count,remain:A.gpt_4_chat.remain,extraTotal:A.gpt_4_chat.extra_total,extraRemain:A.gpt_4_chat.extra_quota,used:A.gpt_4_chat.used,period:A.gpt_4_chat.period,maxToken:o[e]?.prompt_max_token,award:t.reduce((a,n)=>(a[n]={count:o[n].count},a),{})},summary:{total:A.summarize.count,remain:A.summarize.remain,cost:A.summarize.deduct_count,period:A.summarize.period},ocr:{cost:A.ocr_period_info.deduct_count},"image-creator":{total:A.image.count,remain:A.image.remain,used:A.image.used,extraTotal:A.image.extra_total,extraRemain:A.image.extra_quota,period:A.image.period},reader:{total:A.embedding.count,remain:A.embedding.remain,used:A.embedding.used,period:A.embedding.period,limitSize:A.embedding.size}};if(BA(r),r.isVIP){let{autoTools:a,isDoneAutoToolsAction:n}=await _e.default.storage.local.get(["autoTools","isDoneAutoToolsAction"]);typeof a>"u"&&!n&&x({autoTools:Ut,isDoneAutoToolsAction:!0})}else{let{autoTools:a}=await _e.default.storage.local.get("autoTools");typeof a<"u"&&x({autoTools:[]})}return r}async function oA(A,e,t={},i={}){let o=t.signal;if(o?.aborted)throw new DOMException("Aborted","AbortError");let r=new AbortController,a=GC(A)??new URL(`${V.api}${A}`),n=SC(t.body??e),I=new Headers(t.headers),s=(t.method??"GET").toUpperCase(),E=s==="GET"||s==="HEAD";I.has("Content-Type")||I.set("Content-Type","application/json");let{noAuth:f=!1,timeout:y,noAppInfo:C=!1}=i;if(!f&&!I.has("Authorization")){let m;try{m=(await XA()).token}catch(B){throw B instanceof Error?B:kC(B)&&B.msg?new Error(B.msg,{cause:B}):new Error("Failed to get token")}m&&I.set("Authorization",m)}let k;if(o&&o.addEventListener("abort",k=m=>{let B=m.target.reason;B instanceof DOMException?r.abort(B):r.abort()},{once:!0}),n instanceof FormData&&I.delete("Content-Type"),!C)if(E){let m=a.searchParams;m.has("app_name")||m.append("app_name",b),m.has("tz_name")||m.append("tz_name",rA),m.has("app_version")||m.append("app_version",dA)}else n instanceof FormData?(n.has("app_name")||n.append("app_name",b),n.has("tz_name")||n.append("tz_name",rA),n.has("app_version")||n.append("app_version",dA)):Ce(n)&&(Object.hasOwn(n,"app_name")||(n.app_name=b),Object.hasOwn(n,"tz_name")||(n.tz_name=rA),Object.hasOwn(n,"app_version")||(n.app_version=dA));let S=Object.assign({},t,{signal:r.signal,headers:I,method:s,body:E?void 0:I.get("Content-Type")==="application/json"?JSON.stringify(n):n}),p;y&&(p=setTimeout(()=>r.abort(new DOMException("signal time out","TimeoutError")),y));let w=await fetch(a,S).finally(()=>{clearTimeout(p),o&&o.removeEventListener("abort",k)});if(i.onStream&&w.body&&w.ok){let m=i.onStream,B=ye(l=>{if(l.type!=="event")return;let g=l.data==="[DONE]";if(g){m({done:g});return}let c=JSON.parse(l.data);if(c.code!==0)throw new Error(c.msg,{cause:c});m({data:c.data})});for await(let l of we(w.body)){let g=new TextDecoder().decode(l);B.feed(g)}return{}}let d=await w.json().catch(()=>{});if(!w.ok)throw new Error(`${w.status}: ${d?.msg||w.statusText}`,{cause:d});if(!d)throw new Error("Response body is not json");if(d.code!==0)throw(d.code===1003||d.code===1006)&&x({ERR_MUST_LOGIN:!0}),new Error(d.msg,{cause:d});return CA("ERR_MUST_LOGIN"),d.data}function kC(A){return Ce(A)&&Object.hasOwn(A,"code")&&Object.hasOwn(A,"data")&&Object.hasOwn(A,"msg")&&typeof A.code=="number"}function SC(A){if(A instanceof FormData){let e=new FormData;for(let[t,i]of A.entries())e.append(t,i);return e}else return ci(A)}function GC(A,e){try{return new URL(A,e)}catch{return null}}async function qi(A,e){return BA({[A]:{total:e.total,remain:e.remain,extraRemain:e.extra_quota,period:e.remain_period,extraTotal:e.extra_total}})}async function Xn(A,e){let t=await oA("/v1/completion/email_summary",A,{method:"POST",signal:e});return qi("gpt-3.5",t),t}function Wn(A,e){return oA("/v1/completion/email_reply",A,{method:"POST",signal:e.signal},{onStream:t=>{t.done||qi("gpt-3.5",t.data),e.onStream(t)}})}var Zn=[{version:"4.10.0",title:"OpenAI's GPT-4o is now here!",features:[{features:["Increased Speed: Get 2x faster responses than GPT-4"]},{features:["Enhanced Vision: Greatly improved image understanding"]},{features:["Expanded Languages: More languages, better quality, and faster performance"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_10_0",notifyType:"modal"},{version:"4.9.0",title:"Llama 3 Now! The next generation of Meta's state-of-the-art open source LLM.",features:[{features:["<b>New Model:</b> Support Llama 3 now"]}],videoUrl:"",notifyType:"modal"},{version:"4.8.0",title:"In-Chat Video Summary, Subtitle Extraction, Claude 3 Haiku! \u{1F680}",features:[{features:["In-Chat Summary: Get key points of YouTube videos with 'Read this page' in the chat window."]},{features:["Easy Subtitle Extraction: Get subtitles with a single click on YouTube for deeper insights."]}],videoUrl:"",notifyType:"modal"},{version:"4.7.0",title:"In-Chat Video Summary, Subtitle Extraction, Claude 3 Haiku! \u{1F680}",features:[{features:["In-Chat Summary: Get key points of YouTube videos with 'Read this page' in the chat window."]},{features:["Easy Subtitle Extraction: Get subtitles with a single click on YouTube for deeper insights."]},{features:["Claude 3 Haiku: Now available to enrich your chat experience."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_7",notifyType:"modal"},{version:"4.6.0",features:[{features:['Claude 3 Opus: Claims to have "near-human" abilities and can beat GPT-4.']},{features:["Claude 3 Sonnet: Balances intelligence and speed, ideal for retrieving info or automating sales."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_6",notifyType:"modal"},{version:"4.5.0",features:[{features:["Search Agent Widget: Experience the future of search with AI automation"]},{features:["Translate webpage: More reader-friendly translation display styles"]},{features:["Supports automatically restoring the last chat on startup"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_5",notifyType:"modal"},{version:"4.4.0",title:"Easy Artistry with Painter Tool & GPT-4 context menu",features:[{features:["New Painter Tool: Create images instantly in chat."]},{features:["Enhanced Context Menu: Use GPT-4 in context menu."]},{features:["Enhanced Context Menu: Use GPT-4 in context menu."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_4",notifyType:"modal"},{version:"4.3.0",title:"Maximize Your Experience with Full-Screen Mode!",features:[{features:["Dive into an immersive, full-screen view"]},{features:["Enjoy all sidebar features, now in Full-Screen"]},{features:["Seamlessly toggle between modes for the best of both worlds"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_3",notifyType:"modal"},{version:"4.2.0",title:"More Efficient UI & Sidebar GPTs Access (Here is the video tutorial)",features:[{features:["Refreshed Interface: Cleaner and easier to navigate"]},{features:["Collapsible Navigation Bar: Ensures a focused chat experiencewhile keeping essential features within easy reach"]},{features:["Sidebar GPTs Access: For ChatGPT Plus users, direct access toGPTs is now available in the sidebar in web app mode"]}],notifyType:"modal"},{version:"4.1.0",features:[{title:"GPT-4V(ision) Preview! & AI reply for Gmail",features:["Sider Vision is powered by GPT-4V","Better understanding of images","Quickly grasp email intentions","Select from diverse tones and personas","Effortlessly pick reply suggestions"]}],notifyType:"modal"},{version:"4.0.0",features:[{title:"GPT-4 Turbo and Chat web page!",features:["Support GPT-4 Turbo and GPT-3.5 Turbo","Translate whole web page","Chat web page in the Sidebar","Chat PDF in the Sidebar"]}],notifyType:"modal"},{version:"3.6.0",features:[{title:"Translation widget",features:["Customize your translation in a dedicated Translation widget","Improve ChatGPT anwers in Google, Bing, Baidu etc"]}],notifyType:"modal"},{version:"3.5.0",features:[{title:"Sider Vision Became Smarter",features:["GPT-4/Claude 2 + Vision","1-click to answer the same question with different bots"]}],notifyType:"modal"},{version:"3.4.0",features:[{title:"Sider Grammar Widget",features:["Check grammar errors","Fix grammar errors","Improve the writing beyond grammar"]}],notifyType:"modal"},{version:"3.3.0",features:[{title:"Sider Vision \u2014 ChatGPT sidebar with Vision",features:["Extract text from an image","Ask any question about the image","3 ways to send image to Sider Vision<div><ol><li>Take a  screenshot</li><li>Drag & Drop an image to Chat window</li><li>Upload an image</li></ol></div>"]}],notifyType:"modal"},{version:"3.2.0",features:[{title:"New pricing plan with 5x more  GPT-4 queries",features:["Great news! Our updated pricing now gives you even more access to GPT-4 and Claude 2 queries.","If you're already a premium user, you'll be upgraded automatically. Plus, we've got a new 'Unlimited' plan for all you power users!"]}],notifyType:"modal"},{version:"3.1.0",features:[{title:"More bot!",features:["Support Bard now!"]},{title:"OCR: Extract text from any image and send it to ChatGPT",features:["Recognize 10+ major languages of printed materials","Recognize handwritten in English","Recognize math equation in the text"]},{title:"Improve Painter",features:["Replace the whole background","Remove selected area"]}],notifyType:"modal"},{version:"3.0.0",features:[{features:["More Chatbots: Now Supporting Claude-instant, Claude 2, and Bard!"]},{features:["Group Chat: Compare Answers Across Chatbots!"]},{features:["Mention: Tag Chatbots with '@'!"]},{features:["Quick Prompt: Just Type '/' and Go!"]},{features:["Simple Design: Streamlined for Speed!"]}],notifyType:"modal"},{version:"2.9.0",features:[{title:"Enhanced prompt manager for",features:["Reading context menu","Writing context menu"]},{title:"AI image editor",features:["Remove background from any images","Remove text from any images"]}],notifyType:"modal"},{version:"2.8.0",features:["Reading Assistant: Use AI for fast understanding while reading web pages","Writing Assistant: Quickly generate content with AI in the web input box"],notifyType:"modal"},{version:"2.7.0",features:["Draw picture from text","Draw picture from a reference picture"],notifyType:"modal"},{version:"2.6.0",features:["Sider Supports Fixed Sidebar - You can chat between all tabs without overlapping any content (available in Chrome 114 or later)"],notifyType:"modal"},{version:"2.5.0",features:["Youtube Summary! Watch 1 hour of YouTube video in 1 minute","Compare the answers provided by humans and AI on Q&A sites such as Quora, StackOverflow, and Zhihu"],notifyType:"modal"},{version:"2.4.0",features:["Smart web access: Based on your query, the Al will decide if it needs to access the web.","Stability improvement"],notifyType:"modal"},{version:"2.3.0",features:["Support Browsing and Plugins for Plus users!","ChatGPT with internet access for everyone!"],notifyType:"modal"},{version:"2.2.0",features:["Compose any message","Reply email, tweet, comment etc"],notifyType:"modal"},{version:"2.1.0",features:["Shortcut for Quick Lookup","Resize the Quick Lookup window","Bug fixes and other UX improvements"],notifyType:"modal"},{version:"2.0.0",features:["Support GPT-4 for all users!","Invite friends and gain GPT-4 queries for both of you!","Bug fixes and other UX improvements"],notifyType:"modal"},{version:"1.1.0",features:["Full Chat in the new tab!","ChatGPT, Bing, Bard together!","Bug fixes"],notifyType:"modal"},{version:"1.0.13",features:["Continue the chat after asking questions","Switch between GPT-4 and GPT-3.5 for Plus users","Easily access and search chat history"],notifyType:"modal"},{version:"1.0.12",features:["Sync extension settings across computers","Access your prompts from different laptops","Save chats for future use","Share chats via link"],notifyType:"modal"},{version:"1.0.11",features:["Quickly access actions through a pop-up window without opening the sidebar.","Add support for additional languages.","Retain the user's language preference when using the translation feature.","Resolve shortcut conflicts on platforms like GitHub and others."],notifyType:"modal"},{version:"1.0.10",features:["Support 50+ languages now!"],notifyType:"modal"},{version:"1.0.8",features:["Support GPT-4 for Plus users! Check settings page!"],notifyType:"modal"},{version:"1.0.7",features:["Remember prompt used last time","Optimize the position of the chatGPT panel on search pages","Add an option to put the sidebar in-page icon on the left side","Optimize package size","Add dark mode","Support your API url proxy"],notifyType:"modal"},{version:"1.0.6",features:["Improve summarize feature in Youtube page"],notifyType:"modal"},{version:"1.0.5",features:["Remember the location of sidebar in\u2013age icon","Improve shortcuts","Save prompt templates from the sidebar directly"]},{version:"1.0.4",features:["Re-order prompt items in the dropdown list","Archive prompt items you will not use","Support response in 50+ languages"]},{version:"1.0.3",features:["CMD/Ctrl + Enter to do quick \u201CSubmit\u201D","Option to hide panel in the search results page","Support ESC to hide sidebar","Support summarize long article"]},{version:"1.0.2",features:["Add stop button to stop generating response","Change the place of collapse button"]},{version:"1.0.1",features:["Improve summarize feature in Youtube page","Fix some bugs related to copy/paste and print"]}];var jn=M(q());var JA={installSuccess(){return U.googleAnalytics(`${sA?"edge_":""}sider_install_success`,{id:"install"})},report(A,e){let i=(sA?"edge_":"chrome_")+A.replace(/-/gi,"_");U.googleAnalytics(i,{...e})}};var NC=864e5;var wF=NC*30;var UC=6e3;async function HC(A=!1,e){if(U.setUserStatus({fiveStarRated:!0}),A)JA.report("rate_feedback_total"),JA.report(`rate_feedback_${e}`);else{let{__five_star_rate_from__:t}=await R({__five_star_rate_from__:""});JA.report("rate_total"),JA.report(`rate_${t}`)}CA(["__five_star_rate_checking__","__five_star_rate_checking_timer__","__five_star_rate_show_at__","__five_star_rate_show_count__","__five_star_rate_less_show__","__five_star_rate_from__"])}async function $n(A){let{__five_star_rate_checking__:e,__five_star_rate_checking_timer__:t,userStatus:i}=await R({__five_star_rate_checking__:!1,__five_star_rate_checking_timer__:0,userStatus:{fiveStarRated:!1}});if(i?.fiveStarRated||!e)return;let o=await jn.default.tabs.get(A),r=o.pendingUrl||o.url;if(r)if(MC(r)){t&&clearTimeout(t);let a=setTimeout(()=>{HC()},UC);x({__five_star_rate_checking_timer__:a})}else t&&clearTimeout(t)}function MC(A){return new RegExp(`^https://.+?/detail/.+?/${Te}${sA?"":"/reviews"}`,"g").test(A)}var Jt=class A{constructor(e,t,i,o){this.db=null;this.dbName="";this.storeName="";this.dbMapKey="";this.idbMapKey="";if(this.dbMapKey=`${e}_${o||1}`,this.idbMapKey=`${e}_${t}`,A.IDB_MAP[this.idbMapKey])return A.IDB_MAP[this.idbMapKey];A.IDB_MAP[this.idbMapKey]=this,this.dbName=e,this.storeName=t,this.onUpgrade=i.onUpgrade,this.onError=i.onError,this.version=o}static{this.DB_MAP={}}static{this.IDB_MAP={}}async openDB(){let{dbName:e,version:t,onUpgrade:i,onError:o}=this;return A.DB_MAP[this.dbMapKey]?A.DB_MAP[this.dbMapKey]:new Promise((r,a)=>{let n=indexedDB.open(e,t);n.onerror=I=>{a(I)},n.onblocked=I=>{a(I)},n.onupgradeneeded=I=>{i(n.result,I)},n.onsuccess=()=>{let I=n.result;this.db=A.DB_MAP[this.dbMapKey]=I,I.onerror=s=>{o?.(s)},I.onversionchange=()=>{I.close(),this.db=null,delete A.DB_MAP[this.dbMapKey]},r(I)}})}async removeDB(){let e=indexedDB.deleteDatabase(this.dbName);return new Promise((t,i)=>{e.onerror=o=>{i(o)},e.onblocked=o=>{i(o)},e.onsuccess=()=>{t(!0)}})}async transactionAction(e,t){this.db||(this.db=await this.openDB());let i=this.db.transaction(this.storeName,t).objectStore(this.storeName);return new Promise((o,r)=>{let a=e(i);a.onerror=r,a.onsuccess=()=>o(a.result)})}getData(e){return this.transactionAction(t=>t.get(e))}addData(e,t){return this.transactionAction(i=>i.add(e,t),"readwrite")}setData(e,t){return this.transactionAction(i=>i.put(e,t),"readwrite")}deleteData(e){return this.transactionAction(t=>t.delete(e),"readwrite")}clearData(){return this.transactionAction(e=>e.clear(),"readwrite")}};function bC(A){return new Jt("CACHE",A,{onUpgrade(e){try{e.createObjectStore("TRANSLATION_CACHE",{keyPath:"key"})}catch{}}},1)}function Aa(){return bC("TRANSLATION_CACHE")}var qC=M(q());var ea=M(q());var FA=18e4;async function ta({prompt:A,width:e,height:t,cid:i,samples:o,style:r,engine:a,negativePrompt:n,cfgScale:I,clipGuidance:s,sampler:E,seed:f,steps:y}){return uA(oA("/v1/image/text-to-image",{prompt:A,cid:i,engine:a,height:t,width:e,style:r,samples:o,negative_prompt:n,cfg_scale:I===void 0?void 0:I.toString(),clip_guidance:s,sampler:E,seed:f,steps:y},{method:"POST"},{timeout:FA}))}async function ia({prompt:A,cid:e,samples:t,style:i,engine:o,imageUrl:r,imageStrength:a,cfgScale:n,clipGuidance:I,negativePrompt:s,sampler:E,seed:f,steps:y}){let C=new FormData;return C.append("prompt",A),C.append("init_image",await fetch(r).then(k=>k.blob())),t!==void 0&&C.append("samples",String(t)),e&&C.append("cid",e),o&&C.append("engine",o),i&&C.append("style",i),a!==void 0&&C.append("image_strength",String(a)),n!==void 0&&C.append("cfg_scale",String(n)),I&&C.append("clip_guidance",I),s&&C.append("negative_prompt",s),E&&C.append("sampler",E),f!==void 0&&C.append("seed",String(f)),y!==void 0&&C.append("steps",String(y)),uA(oA("/v1/image/image-to-image",C,{method:"POST"},{timeout:FA}))}async function oa({cfgScale:A,cid:e,height:t,prompt:i,seed:o,steps:r,imageUrl:a,width:n}){let I=new FormData;if(n!==void 0)I.append("width",String(n));else{if(t===void 0)throw new Error("width or height must be set");I.append("height",String(t))}return I.append("init_image",await fetch(a).then(s=>s.blob())),A!==void 0&&I.append("cfg_scale",String(A)),e&&I.append("cid",e),i&&I.append("prompt",i),o!==void 0&&I.append("seed",String(o)),r!==void 0&&I.append("steps",String(r)),uA(oA("/v1/image/image-to-image/upscale",I,{method:"POST"},{timeout:FA}))}async function ra({maskSource:A,maskImageUrl:e,initImageUrl:t,prompt:i}){let o=new FormData;return uA(oA("/v1/image/image-to-image/masking"))}async function na({initImageUrl:A,maskImageUrl:e}){let t=new FormData;return t.append("init_image",await fetch(A).then(i=>i.blob())),t.append("mask_image",await fetch(e).then(i=>i.blob())),uA(oA("/v1/image/inpainting",t,{method:"POST"},{timeout:FA}))}async function aa({initImageUrl:A}){let e=new FormData;return e.append("init_image",await fetch(A).then(t=>t.blob())),uA(oA("/v1/image/remove-text",e,{method:"POST"},{timeout:FA}))}async function Ia({initImageUrl:A}){let e=new FormData;return e.append("init_image",await fetch(A).then(t=>t.blob())),uA(oA("/v1/image/remove-background",e,{method:"POST"},{timeout:FA}))}async function ga({initImageUrl:A,upscale:e}){let t=new FormData;return t.append("init_image",await fetch(A).then(i=>i.blob())),t.append("upscale",String(e)),uA(oA("/v1/image/super-solution",t,{method:"POST"},{timeout:FA}))}async function sa({initImageUrl:A,prompt:e}){let t=new FormData;return t.append("init_image",await fetch(A).then(i=>i.blob())),t.append("prompt",e),uA(oA("/v1/image/replace-background",t,{method:"POST"},{timeout:FA}))}async function Ba({initImageUrl:A}){let e=new FormData;return e.append("init_image",await fetch(A).then(t=>t.blob())),uA(oA("/v1/image/portrait-depth-estimation",e,{method:"POST"},{timeout:FA}))}async function ca({initImageUrl:A}){let e=new FormData;return e.append("init_image",await fetch(A).then(t=>t.blob())),uA(oA("/v1/image/portrait-surface-normals",e,{method:"POST"},{timeout:FA}))}async function Qa({initImageUrl:A,samples:e,engine:t}){let i=new FormData;return i.append("init_image",await fetch(A).then(o=>o.blob())),i.append("samples",String(e)),t&&i.append("engine",t),uA(oA("/v1/image/image-to-image/variation",i,{method:"POST"},{timeout:FA}))}async function Ca(){let A=await oA("/v1/image/sign-cookie",void 0,{method:"POST"},{noAppInfo:!0});return await da(A),A}async function da(A){let{domain:e,cookies:t}=A;return Promise.all(t.map(({Name:i,Value:o})=>ea.default.cookies.set({url:`https://${e}`,name:i,value:o,expirationDate:Date.now()/1e3+5184e3})))}async function uA(A){if(A=await A,A.remain_period&&BA({"image-creator":{total:A.total,remain:A.remain,extraTotal:A.extra_total,extraRemain:A.extra_quota,period:A.remain_period}}),A.signed_cookie)try{return await da(A.signed_cookie),A}catch(e){throw e instanceof Error?new Error(`Failed to set cookie: ${e.message}`,{cause:{data:A}}):new Error("Failed to set cookie: unknown error",{cause:{data:A}})}return A}async function la(){return oA("/v1/image/load-engines")}async function Ea(){return oA("/v1/image/load-tools")}function pa(A){return VA(V.origin,A)}async function fa(){Re({url:pa("/login")})}async function ua(){Re({url:pa("/invite")})}var Oi=M(vi()),WA=M(q());var Ha=M(vi()),jC=M(q());async function $C(A="en"){let e=await fA(),t=navigator.userAgentData?.platform||"Unknown";t=t.replace(" ",""),t=t.slice(0,1).toUpperCase()+t.slice(1);let i=VA(V.api,`/v1/app/promotion/promote_config?app_name=${Gt}&app_version=${dA}&language=${A}&device_name=${t}`),o={data:[],resources:{}};try{let r=await XA(),a=await fetch(i,{headers:{Authorization:r.token}}).then(n=>n.json());!("resources"in a)&&"resources"in a.data&&(a=a.data),o.data=a.data.map(n=>({...n})),o.resources=a.resources}catch{}return o}function _i(A,e){return A&&A.replace(/{{\s*(\w+)\s*}}/g,(t,i)=>e[i]||i)}function Ma(A,e){return A&&Object.fromEntries(Object.entries(A).map(([t,i])=>[t,_i(i,e)]))}function Ad(A,e){return e?e.every(t=>A.includes(t)):!0}function ed(A){return(WA.default.storage.session||WA.default.storage.local).get(A)}async function td(){let A=WA.default.storage.session||WA.default.storage.local,e=await ed({__promote_config__:{config:{data:[],resources:{}},timeStamp:0,maxAge:3e3},__promote_variants__:{}}),t=Date.now(),{__promote_variants__:i,language:o,vipInfo:r,provider:a}=await R({language:"en",__promote_variants__:{},provider:"siderApi",vipInfo:{userTypeDetail:"login"}}),n=e.__promote_config__,I=n?.maxAge||3e3,s=n.config;if(!s||t-n?.timeStamp>I){s=await $C(o);let m=1e3*60*30;try{A.set({__promote_config__:{config:s,timeStamp:t,maxAge:m}})}catch{}}let E=navigator.userAgentData?.platform,f=r?.userTypeDetail||"login",y={lang:o,browser:sA?"edge":"chrome"},C=[E,sA?"edge_ext":"chrome_ext",f,["device","login"].includes(f)?"free":"paid",f=="device"?"unregistered":"registered",o,a],{__promote_off__:k}=await R({__promote_off__:{}}),S={};for(let m of s.data){let B=m.activityId||m.slot;if(k&&m.key in k)continue;let l=typeof m.startAt=="number"?m.startAt:Date.parse(m.startAt),g=typeof m.stopAt=="number"?m.stopAt:Date.parse(m.stopAt);l>t||g<t||Ad(C,m.condition)&&(S[B]||(S[B]=[]),S[B].push(m))}let p=Ma({...s.resources._,...s.resources.en,...s.resources[o]},y),w={};for(let m of Object.values(S)){if(m.length==0)continue;let B=m[0].key,l=m[0].persistent,g=i[B]||e.__promote_variants__[B];if(!isFinite(g)&&(g=Math.floor(Math.random()*100),l)){let D=l=="session"&&WA.default.storage.session?"session":"local";WA.default.storage[D].set({__promote_variants__:{...D=="session"?e.__promote_variants__:i,[B]:g}})}let c=m.find(D=>g<=D.allocation);m.length==1&&m[0]?.allocation==null&&(c=m[0]),c&&(c.content=_i(c.content,p),c.style=c.style?_i(c.style,p):"",c.payload=Ma(c.payload,p),w[c.slot]=c)}let d=Object.fromEntries(Object.entries(w).map(([m,B])=>[m,{key:B.key,startAt:B.startAt,stopAt:B.stopAt}]));return await WA.default.storage.local.set({__promote_schedule__:d}),w}var vt;async function ba(){return vt||(vt=td().finally(()=>{vt=null}))}function qa(A,e){let t=A.key;t&&R({[t]:null}).then(i=>{let o=i[t]||{},r=A.host,a=A.favicon;try{r=r||new URL(e.url||"").host,a=a||e.tab?.favIconUrl||e.url+"/favicon.ico"}catch{}if(!r||r==="undefined")return;let n=A.enable;return n?delete o[r]:o={...o,[r]:{favicon:a,enable:n}},Object.entries(o).forEach(([I,s])=>{(I==="undefined"||s.enable)&&delete o[I]}),x({[t]:o})})}var NA=M(q());async function Ra({prompt:A,windowId:e}){let i=(await NA.default.tabs.query({url:"https://chat.openai.com/chat*",windowId:e}))[0];i||(i=await NA.default.tabs.create({active:!0,url:"https://chat.openai.com",windowId:e}),await new Promise(o=>{let r=(a,n,I)=>{a==i.id&&n.status=="complete"&&(o(),NA.default.tabs.onUpdated.removeListener(r))};NA.default.tabs.onUpdated.addListener(r)})),NA.default.tabs.update(i.id,{active:!0}),NA.default.tabs.sendMessage(i.id,{type:"automate-send-prompt",prompt:A}),await new Promise(o=>{let r=0,a=(n,I)=>{if(I.tab?.id===i.id)switch(n.type){case"loaded":r+=1,r<2&&NA.default.tabs.sendMessage(i.id,{type:"automate-send-prompt",prompt:A});return;case"automate-send-prompt-done":NA.default.runtime.onMessage.removeListener(a),o();return}};NA.default.runtime.onMessage.addListener(a),setTimeout(o,1e3*60)})}var dI=M(Li()),AA=M(q());var oI=M(Li());function Ve(A,e,t,i){function o(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function n(E){try{s(i.next(E))}catch(f){a(f)}}function I(E){try{s(i.throw(E))}catch(f){a(f)}}function s(E){E.done?r(E.value):o(E.value).then(n,I)}s((i=i.apply(A,e||[])).next())})}var z=class{constructor(){this.mutex=Promise.resolve()}lock(){let e=()=>{};return this.mutex=this.mutex.then(()=>new Promise(e)),new Promise(t=>{e=t})}dispatch(e){return Ve(this,void 0,void 0,function*(){let t=yield this.lock();try{return yield Promise.resolve(e())}finally{t()}})}},zi;function nd(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global}var Wi=nd(),Vi=(zi=Wi.Buffer)!==null&&zi!==void 0?zi:null,ad=Wi.TextEncoder?new Wi.TextEncoder:null;function Xa(A,e){return(A&15)+(A>>6|A>>3&8)<<4|(e&15)+(e>>6|e>>3&8)}function Id(A,e){let t=e.length>>1;for(let i=0;i<t;i++){let o=i<<1;A[i]=Xa(e.charCodeAt(o),e.charCodeAt(o+1))}}function gd(A,e){if(A.length!==e.length*2)return!1;for(let t=0;t<e.length;t++){let i=t<<1;if(e[t]!==Xa(A.charCodeAt(i),A.charCodeAt(i+1)))return!1}return!0}var _a=87,Oa=48;function Ya(A,e,t){let i=0;for(let o=0;o<t;o++){let r=e[o]>>>4;A[i++]=r>9?r+_a:r+Oa,r=e[o]&15,A[i++]=r>9?r+_a:r+Oa}return String.fromCharCode.apply(null,A)}var La=Vi!==null?A=>{if(typeof A=="string"){let e=Vi.from(A,"utf8");return new Uint8Array(e.buffer,e.byteOffset,e.length)}if(Vi.isBuffer(A))return new Uint8Array(A.buffer,A.byteOffset,A.length);if(ArrayBuffer.isView(A))return new Uint8Array(A.buffer,A.byteOffset,A.byteLength);throw new Error("Invalid data type!")}:A=>{if(typeof A=="string")return ad.encode(A);if(ArrayBuffer.isView(A))return new Uint8Array(A.buffer,A.byteOffset,A.byteLength);throw new Error("Invalid data type!")},za="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ze=new Uint8Array(256);for(let A=0;A<za.length;A++)ze[za.charCodeAt(A)]=A;function sd(A){let e=Math.floor(A.length*.75),t=A.length;return A[t-1]==="="&&(e-=1,A[t-2]==="="&&(e-=1)),e}function Bd(A){let e=sd(A),t=A.length,i=new Uint8Array(e),o=0;for(let r=0;r<t;r+=4){let a=ze[A.charCodeAt(r)],n=ze[A.charCodeAt(r+1)],I=ze[A.charCodeAt(r+2)],s=ze[A.charCodeAt(r+3)];i[o]=a<<2|n>>4,o+=1,i[o]=(n&15)<<4|I>>2,o+=1,i[o]=(I&3)<<6|s&63,o+=1}return i}var _t=16*1024,Ye=4,cd=new z,Xi=new Map;function Qd(A,e){return Ve(this,void 0,void 0,function*(){let t=null,i=null,o=!1;if(typeof WebAssembly>"u")throw new Error("WebAssembly is not supported in this environment!");let r=(g,c=0)=>{i.set(g,c)},a=()=>i,n=()=>t.exports,I=g=>{t.exports.Hash_SetMemorySize(g);let c=t.exports.Hash_GetBuffer(),D=t.exports.memory.buffer;i=new Uint8Array(D,c,g)},s=()=>new DataView(t.exports.memory.buffer).getUint32(t.exports.STATE_SIZE,!0),E=cd.dispatch(()=>Ve(this,void 0,void 0,function*(){if(!Xi.has(A.name)){let c=Bd(A.data),D=WebAssembly.compile(c);Xi.set(A.name,D)}let g=yield Xi.get(A.name);t=yield WebAssembly.instantiate(g,{})})),f=()=>Ve(this,void 0,void 0,function*(){t||(yield E);let g=t.exports.Hash_GetBuffer(),c=t.exports.memory.buffer;i=new Uint8Array(c,g,_t)}),y=(g=null)=>{o=!0,t.exports.Hash_Init(g)},C=g=>{let c=0;for(;c<g.length;){let D=g.subarray(c,c+_t);c+=D.length,i.set(D),t.exports.Hash_Update(D.length)}},k=g=>{if(!o)throw new Error("update() called before init()");let c=La(g);C(c)},S=new Uint8Array(e*2),p=(g,c=null)=>{if(!o)throw new Error("digest() called before init()");return o=!1,t.exports.Hash_Final(c),g==="binary"?i.slice(0,e):Ya(S,i,e)},w=()=>{if(!o)throw new Error("save() can only be called after init() and before digest()");let g=t.exports.Hash_GetState(),c=s(),D=t.exports.memory.buffer,G=new Uint8Array(D,g,c),O=new Uint8Array(Ye+c);return Id(O,A.hash),O.set(G,Ye),O},d=g=>{if(!(g instanceof Uint8Array))throw new Error("load() expects an Uint8Array generated by save()");let c=t.exports.Hash_GetState(),D=s(),G=Ye+D,O=t.exports.memory.buffer;if(g.length!==G)throw new Error(`Bad state length (expected ${G} bytes, got ${g.length})`);if(!gd(A.hash,g.subarray(0,Ye)))throw new Error("This state was written by an incompatible hash implementation");let N=g.subarray(Ye);new Uint8Array(O,c,D).set(N),o=!0},m=g=>typeof g=="string"?g.length<_t/4:g.byteLength<_t,B=m;switch(A.name){case"argon2":case"scrypt":B=()=>!0;break;case"blake2b":case"blake2s":B=(g,c)=>c<=512&&m(g);break;case"blake3":B=(g,c)=>c===0&&m(g);break;case"xxhash64":case"xxhash3":case"xxhash128":B=()=>!1;break}let l=(g,c=null,D=null)=>{if(!B(g,c))return y(c),k(g),p("hex",D);let G=La(g);return i.set(G),t.exports.Hash_Calculate(G.length,c,D),Ya(S,i,e)};return yield f(),{getMemory:a,writeMemory:r,getExports:n,setMemorySize:I,init:y,update:k,digest:p,save:w,load:d,calculate:l,hashLength:e}})}function Cd(A,e,t){return Ve(this,void 0,void 0,function*(){let i=yield A.lock(),o=yield Qd(e,t);return i(),o})}var iD=new z;var oD=new z;var rD=new DataView(new ArrayBuffer(4));var nD=new z;var aD=new z;var ID=new z;var gD=new z;var sD=new z;var BD=new z;var cD=new z;var dd="sha3",ld="AGFzbQEAAAABFARgAAF/YAF/AGACf38AYAN/f38AAwgHAAEBAgEAAwUEAQECAgYOAn8BQZCNBQt/AEGACAsHcAgGbWVtb3J5AgAOSGFzaF9HZXRCdWZmZXIAAAlIYXNoX0luaXQAAQtIYXNoX1VwZGF0ZQACCkhhc2hfRmluYWwABA1IYXNoX0dldFN0YXRlAAUOSGFzaF9DYWxjdWxhdGUABgpTVEFURV9TSVpFAwEKqBwHBQBBgAoL1wMAQQBCADcDgI0BQQBCADcD+IwBQQBCADcD8IwBQQBCADcD6IwBQQBCADcD4IwBQQBCADcD2IwBQQBCADcD0IwBQQBCADcDyIwBQQBCADcDwIwBQQBCADcDuIwBQQBCADcDsIwBQQBCADcDqIwBQQBCADcDoIwBQQBCADcDmIwBQQBCADcDkIwBQQBCADcDiIwBQQBCADcDgIwBQQBCADcD+IsBQQBCADcD8IsBQQBCADcD6IsBQQBCADcD4IsBQQBCADcD2IsBQQBCADcD0IsBQQBCADcDyIsBQQBCADcDwIsBQQBCADcDuIsBQQBCADcDsIsBQQBCADcDqIsBQQBCADcDoIsBQQBCADcDmIsBQQBCADcDkIsBQQBCADcDiIsBQQBCADcDgIsBQQBCADcD+IoBQQBCADcD8IoBQQBCADcD6IoBQQBCADcD4IoBQQBCADcD2IoBQQBCADcD0IoBQQBCADcDyIoBQQBCADcDwIoBQQBCADcDuIoBQQBCADcDsIoBQQBCADcDqIoBQQBCADcDoIoBQQBCADcDmIoBQQBCADcDkIoBQQBCADcDiIoBQQBCADcDgIoBQQBBwAwgAEEBdGtBA3Y2AoyNAUEAQQA2AoiNAQuMAwEIfwJAQQAoAoiNASIBQQBIDQBBACABIABqQQAoAoyNASICcDYCiI0BAkACQCABDQBBgAohAwwBCwJAIAIgAWsiBCAAIAQgAEkbIgNFDQAgA0EDcSEFQQAhBgJAIANBBEkNACABQYCKAWohByADQXxxIQhBACEGA0AgByAGaiIDQcgBaiAGQYAKai0AADoAACADQckBaiAGQYEKai0AADoAACADQcoBaiAGQYIKai0AADoAACADQcsBaiAGQYMKai0AADoAACAIIAZBBGoiBkcNAAsLIAVFDQAgAUHIiwFqIQMDQCADIAZqIAZBgApqLQAAOgAAIAZBAWohBiAFQX9qIgUNAAsLIAQgAEsNAUHIiwEgAhADIAAgBGshACAEQYAKaiEDCwJAIAAgAkkNAANAIAMgAhADIAMgAmohAyAAIAJrIgAgAk8NAAsLIABFDQBBACECQcgBIQYDQCAGQYCKAWogAyAGakG4fmotAAA6AAAgBkEBaiEGIAAgAkEBaiICQf8BcUsNAAsLC+QLAS1+IAApA0AhAkEAKQPAigEhAyAAKQM4IQRBACkDuIoBIQUgACkDMCEGQQApA7CKASEHIAApAyghCEEAKQOoigEhCSAAKQMgIQpBACkDoIoBIQsgACkDGCEMQQApA5iKASENIAApAxAhDkEAKQOQigEhDyAAKQMIIRBBACkDiIoBIREgACkDACESQQApA4CKASETQQApA8iKASEUAkACQCABQcgASw0AQQApA9CKASEVQQApA+CKASEWQQApA9iKASEXDAELQQApA+CKASAAKQNghSEWQQApA9iKASAAKQNYhSEXQQApA9CKASAAKQNQhSEVIBQgACkDSIUhFCABQekASQ0AQQBBACkD6IoBIAApA2iFNwPoigFBAEEAKQPwigEgACkDcIU3A/CKAUEAQQApA/iKASAAKQN4hTcD+IoBQQBBACkDgIsBIAApA4ABhTcDgIsBIAFBiQFJDQBBAEEAKQOIiwEgACkDiAGFNwOIiwELIAMgAoUhGCAFIASFIRkgByAGhSEHIAkgCIUhCCALIAqFIRogDSAMhSEJIA8gDoUhCiARIBCFIQsgEyAShSEMQQApA7iLASESQQApA5CLASETQQApA+iKASEbQQApA6CLASEcQQApA/iKASENQQApA7CLASEdQQApA4iLASEOQQApA8CLASEPQQApA5iLASEeQQApA/CKASEQQQApA6iLASERQQApA4CLASEfQcB+IQADQCAaIAcgC4UgF4UgH4UgEYVCAYmFIBSFIBCFIB6FIA+FIQIgDCAZIAqFIBaFIA6FIB2FQgGJhSAIhSAVhSANhSAchSIDIAeFISAgCSAIIAyFIBWFIA2FIByFQgGJhSAYhSAbhSAThSAShSIEIA+FISEgGCAKIBQgGoUgEIUgHoUgD4VCAYmFIBmFIBaFIA6FIB2FIgWFQjeJIiIgCyAYIAmFIBuFIBOFIBKFQgGJhSAHhSAXhSAfhSARhSIGIAqFQj6JIiNCf4WDIAMgEYVCAokiJIUhDyANIAKFQimJIiUgBCAQhUIniSImQn+FgyAihSERIBIgBYVCOIkiEiAGIA6FQg+JIidCf4WDIAMgF4VCCokiKIUhDiAEIBqFQhuJIikgKCAIIAKFQiSJIipCf4WDhSENIAYgGYVCBokiKyADIAuFQgGJIixCf4WDIBwgAoVCEokiLYUhECArIAQgHoVCCIkiLiAbIAWFQhmJIhtCf4WDhSEXIAYgHYVCPYkiGSAEIBSFQhSJIgQgCSAFhUIciSIIQn+Fg4UhFCAIIBlCf4WDIAMgH4VCLYkiA4UhGCAZIANCf4WDIBUgAoVCA4kiCYUhGSAEIAMgCUJ/hYOFIQcgCSAEQn+FgyAIhSEIIAwgAoUiAiAhQg6JIgNCf4WDIBMgBYVCFYkiBIUhCSAGIBaFQiuJIgUgAyAEQn+Fg4UhCiAEIAVCf4WDICBCLIkiBIUhCyAAQdAJaikDACAFIARCf4WDhSAChSEMICcgKEJ/hYMgKoUiBSEfIAMgBCACQn+Fg4UiAiEaICogKUJ/hYMgEoUiAyEeIC0gLkJ/hYMgG4UiBCEWICYgJCAlQn+Fg4UiBiEdIBsgK0J/hYMgLIUiKCEVICMgJiAiQn+Fg4UiIiEcIC4gLCAtQn+Fg4UiJiEbICcgKSASQn+Fg4UiJyETICMgJEJ/hYMgJYUiIyESIABBCGoiAA0AC0EAIBE3A6iLAUEAIAU3A4CLAUEAIBc3A9iKAUEAIAc3A7CKAUEAIAs3A4iKAUEAIA83A8CLAUEAIAM3A5iLAUEAIBA3A/CKAUEAIBQ3A8iKAUEAIAI3A6CKAUEAIAY3A7CLAUEAIA43A4iLAUEAIAQ3A+CKAUEAIBk3A7iKAUEAIAo3A5CKAUEAICI3A6CLAUEAIA03A/iKAUEAICg3A9CKAUEAIAg3A6iKAUEAIAw3A4CKAUEAICM3A7iLAUEAICc3A5CLAUEAICY3A+iKAUEAIBg3A8CKAUEAIAk3A5iKAQv4AgEFf0HkAEEAKAKMjQEiAUEBdmshAgJAQQAoAoiNASIDQQBIDQAgASEEAkAgASADRg0AIANByIsBaiEFQQAhAwNAIAUgA2pBADoAACADQQFqIgMgAUEAKAKIjQEiBGtJDQALCyAEQciLAWoiAyADLQAAIAByOgAAIAFBx4sBaiIDIAMtAABBgAFyOgAAQciLASABEANBAEGAgICAeDYCiI0BCwJAIAJBBEkNACACQQJ2IgNBA3EhBUEAIQQCQCADQX9qQQNJDQAgA0H8////A3EhAUEAIQNBACEEA0AgA0GACmogA0GAigFqKAIANgIAIANBhApqIANBhIoBaigCADYCACADQYgKaiADQYiKAWooAgA2AgAgA0GMCmogA0GMigFqKAIANgIAIANBEGohAyABIARBBGoiBEcNAAsLIAVFDQAgBUECdCEBIARBAnQhAwNAIANBgApqIANBgIoBaigCADYCACADQQRqIQMgAUF8aiIBDQALCwsGAEGAigEL0QYBA39BAEIANwOAjQFBAEIANwP4jAFBAEIANwPwjAFBAEIANwPojAFBAEIANwPgjAFBAEIANwPYjAFBAEIANwPQjAFBAEIANwPIjAFBAEIANwPAjAFBAEIANwO4jAFBAEIANwOwjAFBAEIANwOojAFBAEIANwOgjAFBAEIANwOYjAFBAEIANwOQjAFBAEIANwOIjAFBAEIANwOAjAFBAEIANwP4iwFBAEIANwPwiwFBAEIANwPoiwFBAEIANwPgiwFBAEIANwPYiwFBAEIANwPQiwFBAEIANwPIiwFBAEIANwPAiwFBAEIANwO4iwFBAEIANwOwiwFBAEIANwOoiwFBAEIANwOgiwFBAEIANwOYiwFBAEIANwOQiwFBAEIANwOIiwFBAEIANwOAiwFBAEIANwP4igFBAEIANwPwigFBAEIANwPoigFBAEIANwPgigFBAEIANwPYigFBAEIANwPQigFBAEIANwPIigFBAEIANwPAigFBAEIANwO4igFBAEIANwOwigFBAEIANwOoigFBAEIANwOgigFBAEIANwOYigFBAEIANwOQigFBAEIANwOIigFBAEIANwOAigFBAEHADCABQQF0a0EDdjYCjI0BQQBBADYCiI0BIAAQAkHkAEEAKAKMjQEiAEEBdmshAwJAQQAoAoiNASIBQQBIDQAgACEEAkAgACABRg0AIAFByIsBaiEFQQAhAQNAIAUgAWpBADoAACABQQFqIgEgAEEAKAKIjQEiBGtJDQALCyAEQciLAWoiASABLQAAIAJyOgAAIABBx4sBaiIBIAEtAABBgAFyOgAAQciLASAAEANBAEGAgICAeDYCiI0BCwJAIANBBEkNACADQQJ2IgFBA3EhBUEAIQQCQCABQX9qQQNJDQAgAUH8////A3EhAEEAIQFBACEEA0AgAUGACmogAUGAigFqKAIANgIAIAFBhApqIAFBhIoBaigCADYCACABQYgKaiABQYiKAWooAgA2AgAgAUGMCmogAUGMigFqKAIANgIAIAFBEGohASAAIARBBGoiBEcNAAsLIAVFDQAgBUECdCEAIARBAnQhAQNAIAFBgApqIAFBgIoBaigCADYCACABQQRqIQEgAEF8aiIADQALCwsL2AEBAEGACAvQAZABAAAAAAAAAAAAAAAAAAABAAAAAAAAAIKAAAAAAAAAioAAAAAAAIAAgACAAAAAgIuAAAAAAAAAAQAAgAAAAACBgACAAAAAgAmAAAAAAACAigAAAAAAAACIAAAAAAAAAAmAAIAAAAAACgAAgAAAAACLgACAAAAAAIsAAAAAAACAiYAAAAAAAIADgAAAAAAAgAKAAAAAAACAgAAAAAAAAIAKgAAAAAAAAAoAAIAAAACAgYAAgAAAAICAgAAAAAAAgAEAAIAAAAAACIAAgAAAAIA=",Ed="f2f6f5b2",pd={name:dd,data:ld,hash:Ed},fd=new z,Le=null;function Va(A){return[224,256,384,512].includes(A)?null:new Error("Invalid variant! Valid values: 224, 256, 384, 512")}function Wa(A,e=512){if(Va(e))return Promise.reject(Va(e));let t=e/8;if(Le===null||Le.hashLength!==t)return Cd(fd,pd,t).then(i=>(Le=i,Le.calculate(A,e,6)));try{let i=Le.calculate(A,e,6);return Promise.resolve(i)}catch(i){return Promise.reject(i)}}var QD=new z;var CD=new z;var dD=new z;var lD=new z;var ED=new z;var pD=new z;var fD=new z;var uD=new ArrayBuffer(8);var mD=new z;var hD=new ArrayBuffer(8);var yD=new z;var wD=new ArrayBuffer(8);var FD=new z;var DD=new z;var kD=new z;var ZA=M(q());var Za=["text/x-java","text/javascript","text/html","text/x-c++","application/msword","text/x-csharp","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/pdf","text/x-script.python","text/x-c","text/x-tex","application/json","text/markdown","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-ruby","text/x-sh","text/x-php","application/x-latext","text/x-typescript","text/plain"];var Ot=class{constructor(){this.results=[];this.isBrowsing=!1}parseMessage(e){let t=e.message,i=this.results.findIndex(o=>o.id===t?.id);return t&&(t.author.role==="assistant"?this.handleAssistantMessage(t,i):t.author.role==="tool"&&(t.author.name==="browser"||t.author.name==="myfiles_browser"?this.handleBrowserMessage(t):this.handlePluginResponseMessage(t))),this.results}handleAssistantMessage(e,t){if(e.recipient!=="all")if(e.recipient!=="browser"&&e.recipient!=="myfiles_browser")if(t===-1){let i=this.results[this.results.length-1];if(i&&i.type==="browsing"){let o=i;o.isLoading=!1,o.actions.push({messageId:"1",command:"finishBrowsing"}),this.isBrowsing=!1}this.results.push({id:e?.id,type:"plugin",pluginName:e?.recipient,isLoading:!0,info:[{type:"request",text:e?.content?.parts?.[0]||e?.content?.text}]})}else{let i=this.results[t];i.info[0].text=e?.content?.parts?.[0]||e?.content?.text}else this.isBrowsing||(this.results.push({id:e?.id,type:"browsing",subType:e?.recipient==="myfiles_browser"?"myfiles":"web",isLoading:!0,actions:[{messageId:"0",command:"startBrowsing",model_slug:e.metadata?.model_slug||""}]}),this.isBrowsing=!0);else if(t===-1)this.handleNewTextMessage(e);else{let i=this.results[t],o=this.getTextWithCitations(e);i.text=o.text,i.searchSnippets=o.searchSnippets}}handleBrowserMessage(e){if(this.isBrowsing){let t=this.results[this.results.length-1];if(t.type==="browsing"){let i=t,o=e.metadata;(i.actions.length===0||o.command!==i.actions[i.actions.length-1].command||i.actions[i.actions.length-1].messageId!==e?.id)&&(o.command!=="quote_lines"||i.actions[i.actions.length-1].command!=="quote_lines")?(o.command==="search"||o.command==="click"||o.command==="quote_lines"&&i.subType==="web")&&i.actions.push({messageId:e?.id,command:o.command,model_slug:o.model_slug,status:o.status,args:o.args,_cite_metadata:o.command==="click"?this.getClickMetadata(o._cite_metadata):{}}):(i.actions[i.actions.length-1].status=o.status,(o.command==="click"||o.command==="quote_lines")&&(i.actions[i.actions.length-1]._cite_metadata=this.getClickMetadata(o._cite_metadata)))}}}handlePluginResponseMessage(e){let t=this.results[this.results.length-1];t&&(t.isLoading=!1);let i=null;if(e?.author?.name==="python"?i=JSON.stringify(e.content):e?.author?.name==="dalle.text2im"?typeof e?.content?.parts?.[0]!="string"&&(i=e?.content?.text):i=e?.content?.parts?.[0],i&&t&&t.info.push({type:"response",text:i}),e?.author?.name==="dalle.text2im"){let o=e?.content?.parts?.[0];typeof o=="object"&&o.asset_pointer&&this.results.push({id:o.asset_pointer.replace("file-service://",""),type:"image",gen_id:o?.metadata?.dalle?.gen_id,prompt:o?.metadata?.dalle?.prompt})}else e?.metadata?.jit_plugin_data?.from_server.type==="confirm_action"&&this.results.push({id:e?.id,type:"pluginConfirm",metadata:e?.metadata?.jit_plugin_data?.from_server.body})}handleNewTextMessage(e){if(this.results.length>0){let t=this.results[this.results.length-1];if(t.type==="browsing"){let i=t;i.isLoading=!1,i.actions.push({messageId:"1",command:"finishBrowsing"}),this.isBrowsing=!1}}e?.content?.parts?.[0]&&this.results.push({id:e?.id,type:"text",text:e?.content?.parts?.[0]})}getClickMetadata(e){return{metadata_list:[{url:e?.metadata_list?.[0]?.url,title:e?.metadata_list?.[0]?.title}]}}getTextWithCitations(e){let t=e?.content?.parts?.[0],i=e?.metadata?.citations,o={};if(i&&i.length>0){let r=t,a=i.length;return i.sort((n,I)=>I.end_ix-n.end_ix).forEach((n,I)=>{let s=n.start_ix,E=n.end_ix,f=n.metadata?.url;f?(r=r.slice(0,s)+`[^${a-I}](${f})`+r.slice(E),o[a-I]={link:f,title:n.metadata.title,snippet:n.metadata.text}):r=r.slice(0,s)+r.slice(E)}),{text:r,searchSnippets:o}}else return{text:t}}};async function De(A,e,t=!1,i=!1){let{onMessage:o,...r}=e,n=await(t?ke:fetch)(A,r);if(!n.ok){let s=await n.json().catch(()=>({}));throw new Error(be(s)?`${n.status} ${n.statusText}`:JSON.stringify({...s,responseStatus:n.status}))}let I=ye(s=>{s.type==="event"&&o(s.data)});for await(let s of we(n.body)){let E=new TextDecoder().decode(s);if(i)try{if(JSON.parse(E).wss_url){o(E);return}}catch{}I.feed(E)}}var ja=M(q());async function ud(A,e){return ja.default.runtime.sendMessage({type:"getArkoseToken",target:"offscreen",userType:A,dx:e})}async function $a(A,e){return ud(A,e)}var DA="ChatGPT Webapp",$i=`${DA}: error_chatgpt_auth`,zt="https://chatgpt.com",Zi="accessToken",ji=new oI.default(10*1e3);async function lA(A,e,t,i){let o={"Content-Type":"application/json"};A&&(o.Authorization=`Bearer ${A}`),o={...o,...await QI()};let r={method:e,headers:o};return i&&(r.body=JSON.stringify(i)),ke(`${zt}/backend-api${t}`,r)}async function rI(A,e){await lA(A,"POST","/conversation/message_feedback",e)}async function AI(A,e,t){return!0}async function nI(A){let e=await IA({isForce:!0});return lA(e,"GET","/models",null).then(t=>t.json())}async function aI(A){let e=await IA({isForce:!0});return lA(e,"GET","/gizmos/bootstrap?limit=2",null).then(t=>t.json()).catch(t=>({gizmos:[]}))}async function eI(A,e){let t=await IA({isForce:!0});return lA(t,"POST","/conversation/gen_title/"+A,{message_id:e}).then(i=>i.json())}async function II(A,e){let t=await IA({isForce:!0});return lA(t,"POST","/files",{file_name:A.name,file_size:A.size,use_case:e?"my_files":"multimodal"}).then(i=>i.json())}async function gI(A){let e=await IA({});return lA(e,"POST","/files/"+A+"/uploaded",{}).then(t=>t.json())}async function Ao(A){let e=await IA({isForce:!0});return lA(e,"GET","/files/"+A+"/download",null).then(t=>t.json())}async function md(){let A=await IA({});return lA(A,"GET","/accounts/check/v4-2023-04-27",null).then(e=>e.json())}async function hd(){let A=await IA({});return lA(A,"POST","/sentinel/chat-requirements",{conversation_mode_kind:"primary_assistant"}).then(e=>e.json())}async function tI(){let A=await IA({});return lA(A,"POST","/register-websocket",null).then(e=>e.json()).then(e=>e.wss_url)}async function sI({conversationId:A,messageId:e,sandboxPath:t}){let i=await IA({isForce:!0});return lA(i,"GET","/conversation/"+A+"/interpreter/download?message_id="+e+"&sandbox_path="+t.replace("sandbox:",""),null).then(o=>o.json())}async function BI(A){A||(A=await IA());let e=`${zt}/backend-api/aip/p?offset=0&limit=250&is_installed=true`;return await(await ke(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`}})).json()}async function eo(){if(ji.get(Zi))return ji.get(Zi);let A=null;try{A=await fetch(yA.openaiApiSession)}catch(i){throw new Error(`${DA}: ${i.message}`)}let e=$i;if(A?.status===403)throw new Error(e);let t=await A?.json().catch(()=>({}));if(!t.accessToken)throw new Error(e);return ji.set(Zi,t.accessToken),t.accessToken}async function cI(A){let e=await IA();return lA(e,"POST",`/gizmos/${A}/sidebar`,{action:"keep"})}async function QI(){let A="Oai-",e={};return e[A+"Device-Id"]=await yd(),e[A+"Language"]="en-US",e}async function yd(){return(await chrome.cookies.get({url:zt,name:"oai-did"}))?.value||gA()}async function wd(A){try{return(await ZA.default.storage.local.get({selectWebAppModel:"gpt-4"})).selectWebAppModel}catch{return null}}async function CI(A){let e="";return e||(e=await IA()),new Promise((t,i)=>{let o=setInterval(async()=>{let a=await(await lA(e,"GET","/files/"+A,null)).json();a.retrieval_index_status==="success"&&(clearInterval(o),t(a))},1e3)})}function iI(A){return A.map(e=>{let t={name:e.name,size:e.size,mimeType:e.type,id:e.id};return e.type.startsWith("image")?(t.width=e.width,t.height=e.height):Za.includes(e.type)&&(t.fileTokenSize=e.fileTokenSize),t})}var TA={};function Fd(A){let e=to(A);if(TA[e])return TA[e];{let t=new WebSocket(A);return TA[e]=t,t}}function Dd(A){let e=to(A);if(TA[e]&&TA[e].readyState===WebSocket.OPEN)return{ws:TA[e],isNew:!1};{let t=new WebSocket(A);return TA[e]=t,{ws:t,isNew:!0}}}function to(A){return A.split("?")[0]}function Yt(A){let e=to(A);TA[e]&&delete TA[e]}async function kd(A){let e=await ZA.default.storage.local.get("chatRequirements");return hd().then(t=>(ZA.default.storage.local.set({chatRequirements:{data:t,expireTime:Date.now()+9*60*1e3,token:A}}),t))}var Lt=class{constructor(e){this.token=e;this.token=e}async generateAnswer(e){let t,i,o,r=Promise.resolve(),a=!1,n=await kd(this.token);async function I(){if(C.filter(h=>h.type==="image").length>0){let h=C.filter(F=>F.type==="image").map(async F=>{let K=await Ao(F.id);if(K.download_url)return fetch(K.download_url).then(P=>P.blob()).then(async P=>{let EA=await Mt(P);return x({[Rn+F.id]:EA})})});await Promise.all(h)}}let s=async()=>{try{await r}catch(h){throw t&&(await I(),await AI(this.token,t,{is_visible:!1}),i&&t&&await eI(t,i),t="",i=""),new Error(`${DA}: ${h}`)}o&&(o.onmessage=()=>{},o.onerror=()=>{},o.onclose=()=>{}),t&&(await I(),await AI(this.token,t,{is_visible:!1}),i&&t&&await eI(t,i),t="",i="")};e.getCleanupMethod?.(s);function E(h,F){let K=F&&F.some(P=>P.type.startsWith("image"));return{content_type:K?"multimodal_text":"text",parts:K?F?.filter(P=>P.type.startsWith("image")).map(P=>({asset_pointer:"file-service://"+P.id,size_bytes:P.size,width:P.width,height:P.height})).concat([h]):[h]}}let f=Array.isArray(e.prompt)?e.prompt.map((h,F)=>({id:gA(),recipient:e.actionData?"all":void 0,author:e.actionData?e.actionData.author:{role:h.role},content:F===e.prompt.length-1?E(h.content,e.chatgptFiles):{content_type:"text",parts:[h.content]},metadata:e.actionData?e.actionData.metaData:F===e.prompt.length-1&&e.chatgptFiles&&e.chatgptFiles.length>0?{attachments:iI(e.chatgptFiles)}:void 0})):[{id:gA(),recipient:e.actionData?"all":void 0,author:e.actionData?e.actionData.author:{role:"user"},content:E(e.prompt,e.chatgptFiles),metadata:e.actionData?e.actionData.metaData:e.chatgptFiles?{attachments:iI(e.chatgptFiles)}:void 0}],y=()=>{y=null,e.onEvent({type:"done"}),s()},C=[],k=new Ot,S=e.model||await wd(this.token)||"text-davinci-002-render-sha",{needArkoseToken:p}=await ZA.default.storage.local.get("needArkoseToken");function w(h){if(h.error&&ZA.default.storage.local.set({needArkoseToken:!0}),!h.message?.content?.parts?.[0]&&!h.message?.content?.text&&h.message?.author.role!=="assistant"&&!h.message?.metadata?.command&&!h.message?.metadata?.jit_plugin_data||h.message?.author.role==="system"||h.message?.author.role==="user"||h.message?.content?.content_type==="text"&&h.message?.author.name===null&&h.message?.status==="finished_successfully"&&!h.message?.end_turn&&!h.message_id)return;C=k.parseMessage(h);let F=h.message?.content?.parts?.[0];(F||C.length>0)&&(t=h.conversation_id,e.onEvent({type:"answer",data:{message:h.message,contents:C,text:F,messageId:h.message.id,conversationId:h.conversation_id}}),e.parentMsgId||(i=h.message.id))}function d(h){try{let F=JSON.parse(h);return F.wss_url?F.wss_url:!1}catch{return!1}}async function m(h){return h||(h=await tI()),B(h)}function B(h){return new Promise((F,K)=>{let P=Dd(h);o=P.ws,o.onopen=()=>{P.isNew&&setTimeout(()=>{F(!0)},500)},o.onclose=()=>{throw Yt(h),e.onEvent({type:"error",data:{error:`${DA}: Websoket error: close`}}),new Error("Websoket error: close")},o.onerror=EA=>{throw Yt(h),e.onEvent({type:"error",data:{error:`${DA}: Websoket error: ${EA}`}}),new Error("Websoket error: "+EA)},o.onmessage=EA=>{let UA=JSON.parse(EA.data),oi=atob(UA.body).trim();if(!oi.startsWith("data: "))return;let lo=oi.replace("data: ",""),Eo;if(lo==="[DONE]"){y?.();return}try{Eo=JSON.parse(lo)}catch{return}w(Eo)},P.isNew||F(!0)})}function l(h){o=Fd(h),o.onopen=()=>{},o.onclose=()=>{throw Yt(h),e.onEvent({type:"error",data:{error:`${DA}: Websoket error: close`}}),new Error("Websoket error: close")},o.onerror=F=>{throw Yt(h),e.onEvent({type:"error",data:{error:`${DA}: Websoket error: ${F}`}}),new Error("Websoket error: "+F)},o.onmessage=F=>{let K=JSON.parse(F.data),P=atob(K.body).trim();if(!P.startsWith("data: "))return;let EA=P.replace("data: ",""),UA;if(EA==="[DONE]"){y?.();return}try{UA=JSON.parse(EA)}catch{return}w(UA)}}try{e.parentMsgId||(S==="gpt-4-gizmo:g-BlafpMvzd"?JA.report("browser_pro_new_chat"):S==="gpt-4-gizmo:g-nleealfRT"&&JA.report("shoppingGPT_new_chat"))}catch{}let c=(await ZA.default.storage.local.get("webAppNetwork")).webAppNetwork,D="";if(!c){let h=await md(),F=h.accounts[h.account_ordering[0]].features.includes("shared_websocket")?"websocket":"http";F==="websocket"&&(D=await tI()),c={method:F,wss_url:D},ZA.default.storage.local.set({webAppNetwork:c})}c.method==="websocket"&&await m(c.wss_url);let G=null;if(chrome.offscreen&&n.arkose.required)try{G=await $a(n.persona,n.arkose?.dx)}catch(h){throw new Error(h)}let O=()=>{let h={};return this.token&&(h.Authorization=`Bearer ${this.token}`),h};async function N(){let h="OpenAI-Sentinel-",F={};if(n.token&&(F[`${h}Chat-Requirements-Token`]=n.token),G&&(F[`${h}Arkose-Token`]=G),n.proofofwork?.required){let{seed:K,difficulty:P}=n.proofofwork;F[`${h}Proof-Token`]=await Y(K,P)}return F}function eA(){return[navigator.hardwareConcurrency+1920+1080,new Date().toString(),4294705152,0,navigator.userAgent]}async function Y(h,F){let K=eA();for(let P=0;P<1e5;P++){K[3]=P;let EA=JSON.stringify(K),UA=btoa(String.fromCharCode(...new TextEncoder().encode(EA)));if((await Wa(h+UA,512)).slice(0,F.length)<=F)return"gAAAAAB"+UA}return"gAAAAABwQ8Lk5FbGpA2NcR9dShT6gYjU7VxZ4D"+btoa(h)}let mA={"Content-Type":"application/json",...O(),...await N(),...await QI()};r=De(zt+"/backend-api/conversation",{method:"POST",signal:e.signal,headers:mA,body:JSON.stringify({action:"next",conversation_mode:S.startsWith("gpt-4-gizmo:")?{gizmo_id:S.replace("gpt-4-gizmo:",""),kind:"gizmo_interaction"}:{kind:"primary_assistant"},force_paragen:!1,force_nulligen:this.token?void 0:!1,force_rate_limit:!1,force_paragen_model_slug:"",history_and_training_disabled:!1,messages:f,model:S.startsWith("gpt-4-gizmo:")?"gpt-4-gizmo":S,parent_message_id:e.parentMsgId||gA(),plugin_ids:e.pluginIds,timezone_offset_min:new Date().getTimezoneOffset(),arkose_token:G||void 0,conversation_id:e.cid?e.cid:void 0,suggestions:[],websocket_request_id:crypto.randomUUID()}),onMessage(h){try{}catch{}if(h==="[DONE]"){y?.();return}else if(d(h))a=!0,l(d(h));else if(h.startsWith("event: typing"))return;let F;try{F=JSON.parse(h)}catch{return}w(F)}},!0,!0).catch(h=>{let F=h.message;try{let K=JSON.parse(F);F=K.message||K.msg||K.error?.message||K.detail?.message||K.detail||F}catch{}throw e.onEvent({type:"error",data:{error:`${DA}: ${F}`}}),new Error(`${DA}: ${F}`)}).finally(()=>{a||y?.()})}};var jA=0,Vt=!1,Se=new dI.default(1e3*30),io="accessToken",lI="noCacheToken",Sd="alwaysProxyFetch";AA.default.storage.local.get({guardChatgptTabId:0}).then(({guardChatgptTabId:A})=>{jA==0&&(jA=A),Vt=A!=0});async function EI(){let A=null;try{A=await AA.default.tabs.get(jA),await AA.default.tabs.update(A.id,{active:!0})}catch{}A||(A=await AA.default.tabs.create({url:yA.openaiChat,pinned:!0,active:!0}));let e=A.id;await AA.default.storage.local.set({guardChatgptTabId:e}),jA=e,Vt=!0,await new Promise(t=>{let i=(o,r)=>{switch(o.type){case"loaded":r.tab?.id==e&&AA.default.tabs.sendMessage(e,{type:"guard-session-activate"});break;case"guard-session-activated":AA.default.runtime.onMessage.removeListener(i),t();break}};AA.default.runtime.onMessage.addListener(i),setTimeout(()=>t(),1e3*40)})}async function Gd(){let A=await AA.default.tabs.create({url:yA.openaiChat,pinned:!0,active:!1});return await AA.default.storage.local.set({guardChatgptTabId:A.id}),jA=A.id,Vt=!0,A}async function xd(){let e=await AA.default.tabs.query({pinned:!0,url:"https://chatgpt.com/*"});if(e.length>0){let t=e[0];return jA=t.id,await AA.default.tabs.reload(t.id),t}return null}async function Nd(){let A=null;try{A=await AA.default.tabs.get(jA),/chat\.openai\.com/.test(A.url||"")?await AA.default.tabs.reload(A.id):A=await AA.default.tabs.update(A.id,{url:yA.openaiChat})}catch{}A||(A=await xd()),A||(A=await Gd());let e=A?.id||0;await new Promise(t=>{let i=(o,r)=>{switch(o.type){case"loaded":r.tab?.id==e&&AA.default.tabs.sendMessage(e,{type:"guard-session-activate"});break;case"guard-session-activated":AA.default.runtime.onMessage.removeListener(i),t();break;case"guard-session-logout":throw Error("")}};AA.default.runtime.onMessage.addListener(i),setTimeout(()=>t(),1e3*40)})}async function IA({onRefresh:A,throwGuideError:e,isForce:t}={}){if(!t&&Se.get(lI)!==!0&&Se.get(io))return Se.get(io);let o=await(await ke(yA.openaiApiSession,{},{onRefresh:A,throwGuideError:e})).json().catch(()=>({}));return Se.set(io,o.accessToken),o.accessToken}async function Ud(A,e,t){let i=AA.default.tabs.connect(A,{name:"guard-proxy"}),o=null,r=null,a=new Promise((C,k)=>{o=C,r=k}),n;i.onDisconnect.addListener(()=>{r(new Error("proxy fetch aborted")),n?.close()}),t?.signal?.addEventListener("abort",()=>{n?.close(),i.disconnect()});let I={type:"guard-proxy-request",key:Date.now()+"",url:e,options:t};i.postMessage(I);let s=new ReadableStream({start(C){n=C},cancel(){i.disconnect()}}),E=setTimeout(()=>r(new Error("connect timeout")),1e3*1),f=C=>{switch(C.type){case"guard-proxy-request-received":clearTimeout(E);break;case"guard-proxy-response":o(new Response(s,C.options));break;case"guard-proxy-response-chunk":n.enqueue(new TextEncoder().encode(C.value)),C.done&&(n.close(),i.onMessage.removeListener(f),i.disconnect());break;case"guard-proxy-response-error":i.onMessage.removeListener(f),i.disconnect(),r(new Error(C.error)),n.close();break}};return i.onMessage.addListener(f),await a}async function ke(A,e,t){let i=null;try{i=await fetch(A,e)}catch{}if(!i)throw new Error($i);if(i.status===401)throw new Error("");if(i.status==403){if(Se.set(lI,!0),Se.set(Sd,!0),!Vt&&t?.throwGuideError)throw Error(`${DA}: error_chatgpt_session_timeout`);t?.onRefresh?.(),await Nd(),i=await Ud(jA,A,e)}return i}var Xe=M(q());function pI(){Hd("NEW","#F00","#FFF")}function Hd(A,e,t){Xe.default.action.setBadgeBackgroundColor({color:e}),Xe.default.action.setBadgeText({text:A}),t&&Xe.default.action.setBadgeTextColor({color:t})}function oo(){return Xe.default.action.setBadgeText({text:""})}var Xt=M(q());var ro="do_ocr";async function no(A){Xt.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(t=>{t?Xt.default.runtime.sendMessage({type:ro,data:{img:A,isForSidepanel:!0}}):e()}).catch(e);async function e(){Fn({url:Dn("standalone.html")}),await ue(500),Xt.default.runtime.sendMessage({type:ro,data:{img:A,isForSidepanel:!1}})}}var We=M(q());function ao(A){We.default.tabs.sendMessage(A,{type:"check"}).catch(e=>{We.default.scripting?.executeScript&&(We.default.scripting.executeScript({target:{tabId:A},files:["content-all.js"]}).catch(t=>{}),We.default.scripting.executeScript({target:{tabId:A,allFrames:!0},files:["all-frames.js"]}).catch(t=>{}))})}var fI=M(q());function uI(){fI.default.storage.local.onChanged.addListener(A=>{if(A.__DONT_SYNC__?.newValue)return;let e=Object.keys(A).filter(t=>t in Nt);e.length&&Md(e)})}var mI=async A=>{if(!await fA())return;await hI();let t=await R(A);t["provider:gpt3"]&&(t["provider:gpt3"].apiKey=""),Wt(t,"translatorHostConfig"),Wt(t,"quickActionInputIconDisabledHost"),Wt(t,"sidebarFabDisabledHost"),Wt(t,"webAssistantImageDisabledHost"),U.setUserSettings(t)},Io=new Map,Md=A=>{let e=A.sort().toString();Io.has(e)||Io.set(e,tA(mI,2e3)),Io.get(e)?.(A)},hI=async()=>{let{promptTemplates:A,allPromptList:e,sidebarPromptTemplate:t}=await j(["promptTemplates","allPromptList","sidebarPromptTemplate"]),i=!1;A&&(await Promise.all(A.map(async o=>{if(o.canEdit&&!o.uid){i=!0;let r=await U.createUserPrompt({type:"search",name:o.title,content:o.template});o.uid=r.id}})),i&&await x({__DONT_SYNC__:`unsavedSearchTpl${Date.now()}`,promptTemplates:A})),i=!1,e&&(await Promise.all(e.map(async o=>{if(!o.id){i=!0;let r=await U.createPrompt({key:o.key,name:o.name,content:o.content,use:o.usedIn});if(o.id=String(r.id),t){let a=t.find(({key:n})=>n===o.key);a&&(a.uid=r.id)}}})),i&&await x({__DONT_SYNC__:`unsavedSidebarTpl${Date.now()}`,allPromptList:e,sidebarPromptTemplate:t}))},jt=tA(async()=>{await fA()&&(await hI(),await bd(),await qd())},1e3);async function bd(){let A=Object.keys(Nt),e={...await U.getUserSettings()||{}};if(!e||!Object.keys(e).length){await mI(A);return}for(let o of Object.keys(e))(!(o in Nt)||e[o]===null)&&delete e[o];let t=await R(A),i;t["provider:gpt3"]&&(i=t["provider:gpt3"].apiKey),Zt(e,"translatorHostConfig"),Zt(e,"quickActionInputIconDisabledHost"),Zt(e,"sidebarFabDisabledHost"),Zt(e,"webAssistantImageDisabledHost"),["chatVisiblePromptKeys","readVisiblePromptKeys","writeVisiblePromptKeys"].forEach(o=>{delete e[o]}),Me(t,e,{"provider:gpt3":{apiKey:i}},(o,r)=>{if(Array.isArray(o))return r}),await x({__DONT_SYNC__:`pullFromCloud${Date.now()}`,...t})}async function qd(){let A=await j("promptTemplates")||[],e=[],t=await U.getUserPromptList("search");if(t?.List?.length){for(let o of t.List)if(o.name){let r={id:o.id,uid:o.id,title:o.name,template:o.content,canEdit:!0};e.push(r)}}let i=A.filter(o=>!o.canEdit);i?.length||(i=[...fe]),await x({__DONT_SYNC__:`pullSearchTpl${Date.now()}`,promptTemplates:[...e,...i]})}function Wt(A,e){let t=[];if(A[e]&&typeof A[e]=="object"){for(let[i,o]of Object.entries(A[e]))i!=="undefined"&&t.push({__key__:i,...o||{}});A[e]=t}}function Zt(A,e){let t={};if(Array.isArray(A[e])){for(let i of A[e])i.__key__&&i.__key__!=="undefined"&&(t[i.__key__]=i,delete i.__key__);A[e]=t}}function yI(){pi("logged",A=>{go(A.logged?.newValue)}),pi(["logged","language"],A=>{U.getAllPromptList()})}var go=tA(A=>{A?Rd():Jd()},3e3,{leading:!0}),Rd=()=>{U.getUserInfo(),U.getVipInfo(),jt(),so(),U.getUserStatus()},Jd=()=>{CA("userInfo"),U.getVipInfo()},so=xA(async()=>{let{__invited_reward_finish__:A}=await R({__invited_reward_finish__:!1});if(A)return;if(await fA()){let t=await U.inviteFinish();t.is_invited&&t.is_rewarded&&(x({userIsInvited:!0,inviteRewardConfig:{"gpt3.5":t.reward.GPT3Dot5Count,gpt4:t.reward.GPT4Count}}),t.already_rewarded||x({__show_invited_reward__:!0})),x({__invited_reward_finish__:!0})}},1e4),wI=tA(xA(me("__REFRESH_DISPLAY_DATA_AT__",async()=>{await U.getVipInfo()},5*60*1e3),2e3),2e3,{leading:!0});async function Ze(){try{let A=await fA(),e=[go(!!A),U.getPricingPlan(),U.getAllPromptList()];await Promise.all(e),CA("__do_init_job_failed__")}catch{await x({__do_init_job_failed__:!0})}}var Bo=M(q());async function co(){let A=await j("language");if(A&&A!=="auto")return;let e=navigator.languages;for(let t of e){t=t.replace("-","_");let i=t.split("_");i[0]=i[0].toLowerCase(),i[1]&&(i[1]=i[1].toUpperCase()),t=i.join("_");let o="";if(t in Di?o=t:o=Object.keys(Di).find(r=>i[0]===r.split("_")[0])||"",o){await Bo.default.storage.local.set({__DONT_SYNC__:`language${Date.now()}`,language:o});return}}Bo.default.storage.local.set({__DONT_SYNC__:`language${Date.now()}`,language:"en"})}var FI=M(q());async function DI(){let A={},e=["p","p1","p2"],t=sA?`https://*.microsoft.com/*${Te}*`:`https://*.google.com/*${Te}*`,i=await FI.default.tabs.query({url:t,currentWindow:!0});if(i.length){i.reverse();for(let o of i){let r=o.url||V.origin,{searchParams:a}=new URL(r),n=!1;for(let[I,s]of a.entries())e.includes(I)&&s&&(n=!0,A[I]=s);if(n)break}}if(Object.keys(A).length>0)for(let[o,r]of Object.entries(A))await mi(o==="p"?"source":o,r,7);else for(let o of e){let r=await kt(o==="p"?"source":o);r&&(A[o]=r)}if(Object.keys(A).length){U.adStat({action:"install-sider-successfully",source:A.p||"",p1:A.p1||"",p2:A.p2||""});let o=Td(A.p1||""),r={installByAD:!0,onBoardFrom:o};(o==="grammar"||o==="translate"||o==="write"||o==="ocr")&&(r.lastTab=o==="write"?"compose":o),await x(r)}}function Td(A){return A.includes("ytb")?"ytb":A.includes("translate")?"translate":A.includes("ocr")?"ocr":A.includes("write")?"write":A.includes("bgremover")?"bgremover":A.includes("chatpdf")?"pdf":A.includes("summarizer")?"summary":A.includes("grammar")?"grammar":A.includes("image")?"painter":A.includes("email")?"email":""}var Qo=M(q());var kI="OpenAI";async function Kd(A,e){let t=await Qo.default.storage.local.get("provider:gpt3"),{apiKey:i,enableCustomURL:o,customURL:r}=t["provider:gpt3"];if(i){let a=o&&r?bt(r):Pd;return fetch(a+e,{method:A,headers:{"Content-Type":"application/json",Authorization:`Bearer ${t["provider:gpt3"].apiKey}`}}).then(n=>n.json())}else return!1}async function SI(){return Kd("GET","/v1/models")}var Pd="https://api.openai.com",$t=class{constructor(e,t,i){this.token=e;this.model=t;this.url=i;this.token=e,this.model=t,this.url=i}async generateAnswer(e){let t="",i=VA(this.url?this.url:"https://api.openai.com","/v1","/chat/completions"),o=await Qo.default.storage.local.get({enableCustomModelName:!1,customModelName:""}),r={model:o.enableCustomModelName&&o.customModelName?o.customModelName:e.model||this.model,stream:!0};Array.isArray(e.prompt)?r.messages=e.prompt:r.messages=[{role:"user",content:e.prompt}],await De(i,{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify(r),onMessage(a){if(a==="[DONE]"){e.onEvent({type:"done"});return}let n;try{n=JSON.parse(a);let I=n.choices[0].delta.content;if(n.choices[0].finish_reason==="stop"){e.onEvent({type:"done"});return}if(I==="<|im_end|>"||I==="<|im_sep|>"||!I)return;t+=I,e.onEvent({type:"answer",data:{text:t,messageId:n.id,conversationId:""}})}catch{return}}}).catch(a=>{let n=a.message;try{let I=JSON.parse(n);if(n=I.message||I.msg||I.error?.message||I.detail?.message||n,[502,503].includes(I.responseStatus))throw new Error(`${kI}: error_service_unavailable`)}catch{}throw new Error(`${kI}: ${n}`)})}};var ti=M(q());var _d=M(q());var Ai=class{constructor(){this.queue=[];this.isRunning=!1}async run(e){if(this.queue.push(e),!this.isRunning){for(this.isRunning=!0;this.queue.length;){let t=this.queue.shift();t&&await t()}this.isRunning=!1}}};var ei=class{constructor(){this.results=[]}parse(e){return e.type==="text"?this.handleTextMsg(e):e.type==="tool_call"?this.handleToolCallMsg(e):e.type==="image"?this.handleImageMsg(e):e.type==="data_analysis_image"?this.handleDataAnalysisImage(e):e.type==="key_moments"&&this.handleKeyMomentsMsg(e),this.results}getLastResult(){return this.results[this.results.length-1]}handleKeyMomentsMsg(e){e.key_moments&&this.results.push({type:"videoKeyMoments",keyMoments:e.key_moments,id:gA()})}handleTextMsg(e){if(e.text){let t=this.getLastResult();t&&t.type==="text"?t.text+=e.text:this.results.push({type:"text",text:e.text,id:gA()})}}handleToolCallMsg(e){let t=e.tool_call.id+(e.tool_call.data&&typeof e.tool_call.data.tool_call_id<"u"?e.tool_call.data.tool_call_id:"");if(e.tool_call.status==="start")this.results.push({type:"toolCall",id:t,status:e.tool_call.status,name:e.tool_call.name,data:e.tool_call.data});else if(e.tool_call.status==="processing"){let i=this.results.findIndex(r=>r.id===t),o=this.results[i];o&&(o.data={...o.data,...e.tool_call.data})}else if(e.tool_call.status==="finish"||e.tool_call.status==="fail"){let i=this.results.findIndex(r=>r.id===t),o=this.results[i];o&&(o.data={...o.data,...e.tool_call.data},o.status=e.tool_call.status)}}handleImageMsg(e){this.results.push({type:"siderImage",id:gA(),images:e.images.images})}handleDataAnalysisImage(e){this.results.push({type:"siderImage",id:gA(),images:[e.data_analysis_image]})}};async function GI(A,e){let{fileStatus:t}=await ti.default.storage.local.get({fileStatus:{}});return t[A]=e,ti.default.storage.local.set({fileStatus:t})}var ii=class{constructor(e){this.token="";this.refreshToken="";this.anonymous=!0;this.checkFileStatusTimer=null;this.cid=e}async getToken(){let e=await XA();this.token=e.token,this.refreshToken=e.refreshToken,this.anonymous=e.anonymous}async generateAnswer(e){let t=await yi(),i={},o=null,r={};try{await this.getToken()}catch(d){throw new Error(d.errMsg)}if(!this.cid&&e.historyMsg)try{this.cid=await U.uploadHistoryMsg(e.historyMsg)}catch(d){throw new Error(d.errMsg)}let{[Ke]:{model:a}}=await R({[Ke]:{model:"gpt-3.5"}}),n=e.model||a,I="",s="",E=!1;function f(){!E&&I&&s&&U.statUserStop(I,s),o&&clearInterval(o)}e.getCleanupMethod?.(f);async function y(d){let{handle_msg:m,is_embedding:B}=await U.getFileStauts(d),l=null;if(B)try{l=JSON.parse(m)}catch{if(m)throw new Error(m)}else l={accept_model:{"gpt-3.5":!0,"gpt-4":!0,"gpt-4o":!0,"gpt3.5-16k":!0,"claude-instant":!0,claude2:!0,"claude-3-haiku":!0,"claude-3-sonnet":!0,"claude-3-opus":!0,bard:!0,"gemini-pro":!0,"gemini-1.5-pro":!0,"gemini-1.5-flash":!0,gpts:!0,"llama-3":!0,...t?{[t.key]:!0}:{}}};return l}async function C(d,m){let{fileStatus:B}=await ti.default.storage.local.get({fileStatus:{}});if(B[d]&&B[d][m])return null;let l=await y(d);return l&&l.accept_model?.[m]?(GI(d,l.accept_model),null):new Promise((g,c)=>{o=setInterval(async()=>{try{l=await y(d),l&&l.accept_model?.[m]&&(GI(d,l.accept_model),l.accept_model[m]&&(o&&clearInterval(o),g(null)))}catch(D){o&&clearInterval(o),c(D)}},1e3)})}e.eid&&await C(e.eid,n).catch(d=>{throw new Error("Getting file status error: "+d.toString())});let k=async(d,m,B)=>{try{return await De(d,{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json",Authorization:this.token},body:JSON.stringify(m),onMessage(l){if(l=="[DONE]"){E=!0,e.onEvent({type:"done"});return}let g=JSON.parse(l);if(g.code!==0)throw new Error(JSON.stringify({code:g.code,msg:g.msg||g.message}));I=g.data.cid,s=g.data.message_id,B(g.data)}})}catch(l){let g=l.message,c=null;try{c=JSON.parse(g)}catch{}ve(c?.code,c?.msg||c?.message||g)}};function S(){let d={};return d.auto=e.autoTools,e.forceSearch&&(d.force="search"),e.sPromptTmpl&&(d.force="reader"),e.forceTool&&(d.force=e.forceTool),d}let p=new Ai,w=await ie();await k(`${V.api}/v2/completion/text`,{system:e.system,prompt:e.prompt,stream:!0,app_name:b,app_version:dA,tz_name:rA,cid:this.cid,model:n,search:e.forceSearch,auto_search:e.autoSearch,filter_search_history:e.filterSearchHistory,from:e.from,re_answer_by_mid:e.sReqId,group_id:e.from==="chat"?"default":void 0,prompt_key:e.promptKey,chat_models:e.chatModels,image_id:e.imageId,eid:e.eid,force_ocr:e.forceOcr,ocr_option:e.ocrOption,prompt_template:e.sPromptTmpl&&e.sPromptTmpl?.key.includes("video-summarize")?void 0:e.sPromptTmpl,deep_search:e.deepSearch,tools:S(),extra_info:{origin_url:w?.url,origin_title:w?.title},video_summarize:e.sPromptTmpl?.key.includes("video-summarize")?{enable:!0,language:e.sPromptTmpl?.attributes.lang}:void 0},d=>{if(!d)return;if(typeof d.total<"u"){let g=d.chat_model?d.chat_model:n;d.use_image_chat||d.quota_type==="image"?g="image-creator":g==="claude-instant"||g==="bard"||g==="gemini-pro"||g==="gemini-1.5-flash"||g==="llama-3"||g==="claude-3-haiku"||d.quota_type==="fast_text"?g="gpt-3.5":(g==="claude2"||g.startsWith("claude-3")||g.startsWith("gemini-1.5-pro")||t&&g.startsWith(t.key)||d.quota_type==="advanced_text")&&(g="gpt-4");let c={[g]:{total:d.total,remain:d.remain,extraTotal:d.extra_total,extraRemain:d.extra_quota,period:d.remain_period,used:d.used}};xi().then(D=>{let G=D[g];(G.remain!==c[g].remain||G.extraRemain!==c[g].extraRemain||G.period!==c[g].period||G.extraTotal!==c[g].extraTotal||G.total!==c[g].total||G.used!==c[g].used||G.period!==c[g].period)&&(G.remain+G.extraRemain>c[g].remain+c[g].extraRemain||G.used!==c[g].used||d.type==="quota")&&p.run(()=>BA(c))})}let m=d.text,B=d.chat_model||n;(m||d.type!=="pulse")&&(i[B]||(i[B]=""),r[B]||(r[B]={parser:null,contents:[]},r[B].parser=new ei),m&&(i[d.chat_model]+=m),r[B].contents=r[B].parser.parse(d),e.onEvent({type:"answer",data:{text:i[B],contents:r[B].contents,messageId:d.message_id,serverRequestId:d.req_message_id,conversationId:d.cid,chatModel:d.chat_model}})),d.code&&d.code!==0&&e.onEvent({type:"error",data:{error:Ui(d.code,d.msg),chatModel:d.chat_model||n}}),d.done&&e.onEvent({type:"done",data:{chatModel:d.chat_model||n,done:!0}}),d.type==="tool_call"&&d.tool_call.name==="search"&&e.onEvent({type:"searchKeywords",data:{searchKeywords:d.tool_call.data.keywords,searchSnippets:d.tool_call.data.snippets,chatModel:d.chat_model}}),d.type==="deep_search"&&e.onEvent({type:"deepSearch",data:{deep_search:d.deep_search,cid:d.cid,message_id:d.message_id}})})}};var Od=xA(me("__SCHEDULE_RUN_AT__",async()=>{let A=[jt(),U.getPricingPlan(),U.getAllPromptList()];await Promise.all(A)},6*60*60*1e3)),xI=tA(async()=>{let{__do_init_job_failed__:A}=await R({__do_init_job_failed__:!1});if(A){Ze();return}try{await Od()}catch{}},1e3,{leading:!0});var je=M(q());var NI=tA(async A=>{let e=await je.default.storage.local.get({promptTemplates:fe}),t=fe.reduce((i,{id:o},r)=>(i[o]=fe[r],i),{});for(let i of e.promptTemplates)i.id in t&&(i.title=A[i.id].title,i.template=A[i.id].template);je.default.storage.local.set({__DONT_SYNC__:`searchPromptTPL${Date.now()}`,...e})},200),dS=tA(async(A,e)=>{let t=await je.default.storage.local.get("sidebarPromptTemplate"),i=!1;if(t.sidebarPromptTemplate||(i=!0,t.sidebarPromptTemplate=xt),!A||!e)return;let o=xt.reduce((r,{key:a},n)=>(r[a]=xt[n],r),{});for(let r of t.sidebarPromptTemplate)r.key in o&&(r.title=A[r.key].title,i||r.changed===!1||r.template.trim()===e[r.key].template.trim()?(r.template=A[r.key].template,r.changed=!1):r.changed=!0);je.default.storage.local.set({__DONT_SYNC__:`sidebarPromptTPL${Date.now()}`,...t})},100);var Co=M(q());function UI(A){Co.default.storage.local.get({userClickedWidgets:[]}).then(e=>{let t=A.filter(i=>!e.userClickedWidgets.includes(i));Co.default.storage.local.set({needShowTipWidgets:t})})}yI();uI();u.default.runtime.onStartup.addListener(()=>{u.default.storage.local.remove("searchAgentSuggestionsCache"),Ze()});async function Yd(A,{system:e,question:t,type:i,cid:o,historyMsg:r,model:a,chatModels:n,pluginIds:I,forceSearch:s,autoSearch:E,filterSearchHistory:f,from:y,promptKey:C,imageId:k,eid:S,forceOcr:p,ocrOption:w,forceProvider:d,sPromptTmpl:m,parentMsgId:B,chatgptFiles:l,actionData:g,autoTools:c,forceTool:D,deepSearch:G,sReqId:O}){let N=await qn(),eA,Y=d||N.provider;if(Y==="chatgpt"){let F=await IA({onRefresh:()=>A.postMessage({event:"GUARD_TAB_REFRESHING"}),throwGuideError:!0});eA=new Lt(F)}else if(Y==="gpt3"){let{apiKey:F,enableCustomURL:K,customURL:P,model:EA}=N.configs.gpt3,UA=K&&P?bt(P):"";eA=new $t(F,EA||Fi,UA)}else if(Y==="siderApi")eA=new ii(o);else throw new Error(`Unknown provider ${Y}`);let mA=()=>{},h=new AbortController;A.onDisconnect.addListener(()=>{h.abort(),mA?.()}),await eA.generateAnswer({system:e,prompt:t,type:i,signal:h.signal,historyMsg:r,pluginIds:I,onEvent(F){if(F.type==="done"){F.data?.chatModel?A.postMessage(F.data):A.postMessage({event:"DONE"});return}A.postMessage(F.data)},getCleanupMethod(F){mA=F},forceSearch:s,autoSearch:E,filterSearchHistory:f,from:y,promptKey:C,model:a,chatModels:n,imageId:k,eid:S,forceOcr:p,ocrOption:w,sPromptTmpl:m,cid:o,parentMsgId:B,chatgptFiles:l,actionData:g,autoTools:c,forceTool:D,deepSearch:G,sReqId:O})}var Ld=async A=>{let e=await j("webAppModelsLastUpdateTime"),t=await j("webAppModels");if(A||!t||!e||e-Date.now()>1e3*60*60*24)return Promise.all([nI(),aI()]).then(([i,o])=>{let r=o.gizmos.reduce((n,I)=>(n[I.resource.gizmo.id]=I,n),{}),a=o.gizmos.map(n=>n.resource.gizmo.id);return u.default.storage.local.get(["webAppGPTs","selectWebAppModel"]).then(n=>{let s={...n.webAppGPTs||{},...r};Jn.forEach(f=>{s[f]||(s[f]=Tn[f])});let E={webAppGPTsList:a,webAppGPTs:s,webAppModels:i.models,webAppModelsLastUpdateTime:Date.now()};return n.selectWebAppModel||(i.models.some(f=>f.slug==="gpt-4")?E.selectWebAppModel="gpt-4":E.selectWebAppModel="text-davinci-002-render-sha"),u.default.storage.local.set(E)})})},zd=()=>SI().then(async A=>{if(A.data){let e=A.data.filter(o=>o.id.startsWith("gpt-3.5")||o.id.startsWith("gpt-4")).map(o=>({name:o.id})),t=await j("provider:gpt3"),i={apiModels:e};return t&&t.model&&(e.find(o=>o.name===t.model)||(i["provider:gpt3"]={...t,model:Fi})),u.default.storage.local.set(i)}else return A.error?.message||"error"});u.default.runtime.onConnect.addListener(A=>{if(A.name==="sidepanel"){A.onDisconnect.addListener(()=>{u.default.storage.local.set({sidebarLastCloseTime:Date.now(),webAppNetwork:null}),u.default.storage.local.remove("chatRequirements")}),A.onMessage.addListener(t=>{});return}yn(A)||A.onMessage.addListener(async t=>{try{await Yd(A,{system:t.system,question:t.question,type:t.type,cid:t.cid,historyMsg:t.historyMsg,chatModels:t.chatModels,model:t.model,pluginIds:t.pluginIds,autoSearch:t.autoSearch,forceSearch:t.forceSearch,filterSearchHistory:t.filterSearchHistory,from:t.from,promptKey:t.promptKey,imageId:t.imageId,eid:t.eid,forceOcr:t.forceOcr,ocrOption:t.ocrOption,forceProvider:t.forceProvider,sPromptTmpl:t.sPromptTmpl,parentMsgId:t.parentMsgId,chatgptFiles:t.chatgptFiles,actionData:t.actionData,autoTools:t.autoTools,forceTool:t.forceTool,deepSearch:t.deepSearch,sReqId:t.sReqId})}catch(i){A.postMessage({error:i.message})}})});Ei("email-enhance-reply",A=>{A.onMessage(e=>{Wn(e,{signal:A.signal,onStream(t){t.done?(A.send({done:!0}),A.close()):A.send({data:t.data})}}).catch(t=>{t.name!=="AbortError"&&(A.send({error:qe(t)}),A.close())})})});Ei("email-enhance-summary",A=>{A.onMessage(e=>{Xn(e,A.signal).then(t=>A.send({data:t})).catch(t=>{t.name!=="AbortError"&&A.send({error:qe(t)})}).finally(()=>A.close())})});u.default.runtime.onMessage.addListener(async(A,e)=>{let t=pn(A,e);if(t)return t;switch(A.type){case"FEEDBACK":{let i=await eo();await rI(i,A.data);break}case"OPEN_OPTIONS_PAGE":{hi(A.section,A.hash);break}case"GET_ACCESS_TOKEN":return eo();case"SEND_CHATGPT":return Ra({prompt:A.promt});case"IS_CHAT_LOGIN":return Pn().then(i=>{e.tab?.id&&u.default.tabs.sendMessage(e.tab.id,{type:"CHAT_LOGIN_STATE",value:i}),u.default.runtime.sendMessage({type:"CHAT_LOGIN_STATE",value:i})});case"POPUP_OPEN":return $e(A.isShow);case"OPEN_URL_IN_NEW_TAB":return u.default.tabs.create(A.details);case"OPEN_URL":{u.default.tabs.create({url:A.url});break}case"UPDATE_TAB":return wn(A.queryInfo,A.updateDetails);case"RELOAD_TAB":return St(A.queryInfo,!0);case"SWITCH_TAB":return St(A.queryInfo);case"GET_CHATGPT_MODELS":return Ld(A.isForce);case"GET_API_MODELS":return zd();case"GET_COOKIE":try{let i=await u.default.cookies.get(A.data);return i?.value?decodeURIComponent(i.value):""}catch(i){return Promise.reject(i)}case"SET_COOKIE":try{return await u.default.cookies.set(A.data)}catch(i){return Promise.reject(i)}case"SET_PROMPT_BY_I18N":{if(A.tplType==="search")return NI(A.translation);break}case"CHECK_SCHEDULE_JOB":{xI();break}case"REFRESH_DISPALY_DATA":{wI();break}case"REFRESH_VIP_INFO":{RA(async()=>{if((await U.getVipInfo()).isVIP){let{autoTools:o,isDoneAutoToolsAction:r}=await u.default.storage.local.get(["autoTools","isDoneAutoToolsAction"]);(typeof o>"u"||o&&o.length===0)&&!r&&x({autoTools:Ut,isDoneAutoToolsAction:!0})}else throw new Error("")},2e3);break}case"FORWARD_TO_CHAT":{u.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(i=>{if(i)return u.default.runtime.sendMessage({...A,type:"SEND_TO_CHAT",isForSidepanel:!0});u.default.tabs.sendMessage(e.tab?.id,{...A,type:"SEND_TO_CHAT"})}).catch(()=>{u.default.tabs.sendMessage(e.tab?.id,{...A,type:"SEND_TO_CHAT"})});return}case"CONTINUE_IN_CHAT":{u.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(i=>{if(i)return u.default.runtime.sendMessage({...A,type:"DO_CONTINUE_IN_CHAT",isForSidepanel:!0});u.default.tabs.sendMessage(e.tab?.id,{...A,type:"DO_CONTINUE_IN_CHAT"})}).catch(()=>{u.default.tabs.sendMessage(e.tab?.id,{...A,type:"DO_CONTINUE_IN_CHAT"})});return}case"SEND_MSG_IN_CHAT":{u.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(i=>{if(i)return u.default.runtime.sendMessage({...A,type:"DO_SEND_MSG_IN_CHAT",isForSidepanel:!0});u.default.tabs.sendMessage(e.tab?.id,{...A,type:"DO_SEND_MSG_IN_CHAT"})}).catch(()=>{u.default.tabs.sendMessage(e.tab?.id,{...A,type:"DO_SEND_MSG_IN_CHAT"})});return}case"CHECK_PINNED":return!!(await u.default.action.getUserSettings())?.isOnToolbar;case"OPEN_CHAT_PAGE":return vn("",()=>{u.default.runtime.sendMessage({type:"switchChat",data:{contact:A.contact||"chat",conversation:A.currentCid}})},()=>x({activeConversation:{contact:A.contact||"chat",conversation:A.currentCid}}));case"QUERY_SELECTION":return u.default.tabs.sendMessage(A.tabId||e.tab?.id,{type:"query-selection",selectionText:A.selectionText});case"TOGGLE_HOST_TRANSLATOR_FAB":return qa(A,e);case"TOGGLE_SIDEBAR":{$e(A.isShow);break}case"GUARD_CHATGPT_TAB":{EI();break}case"TOGGLE_TRANSLATOR":u.default.tabs.sendMessage(A.tabId||e.tab?.id,{type:"toggle-translator",show:A.show});break;case"GO_LOGIN":{fa();break}case"GO_INVITE":{ua();break}case"GET_INVITE_LINK":return U.createInviteLink();case"GET_CHATGPT_PLUGINS":return Vd();case"REMOVE_SELECTION":{let i=await ie();i?.id&&u.default.tabs.sendMessage(i.id,{type:"remove-selection"});break}case"SEND_TO_CURRENT_TAB":{let i=await ie();i?.id&&u.default.tabs.sendMessage(i.id,A.data);break}case"CAPTURE_VISIBLE_TAB":return u.default.tabs.captureVisibleTab(void 0,{format:"jpeg"});case"FORWARD_MSG":{let i=await ie();if(i?.id)return u.default.tabs.sendMessage(i.id,A);break}case"FORWARD_TO_CONTENT":{let i=await ie();if(i?.id){let o=A.subtype;return delete A.type,delete A.subtype,u.default.tabs.sendMessage(i.id,{type:o,...A})}break}case"GET_SRC_SUFFIX":{let i="",o=await HI();o.length||await U.signImageCookie(),o=await HI();let r=o.join("&");return i=r?"?"+r:"",i;break}case"CLEAR_BADGE":return oo();case"GA_API":return U.googleAnalytics(...Array.from(A.args));case"DETECT_PAGE_LANGUAGE":return(await u.default.tabs.detectLanguage()).replace("-","_");case"TRANSLATION_CACHE":{let i=Aa();if(A.action==="get")return await Promise.all(A.keys.map(o=>i.getData(o)));if(A.action==="set")return await Promise.all(A.values.map(o=>i.setData(o)));if(A.action==="clear")return await i.clearData();break}case"GET_PROMOTE_DATA":{ba().then(i=>{let o={type:"PROMOTE_DATA",data:i};return e.tab?.id?u.default.tabs.sendMessage(e.tab.id,o):u.default.runtime.sendMessage(o)});break}case"GET_IMAGE":return Ao(A.id).then(i=>i);case"GET_CHATGPT_UPLOAD_URL":return II(A.data,A.isMyFile);case"REPORT_CHATGPT_FILE_UPLOADED":return gI(A.fileId);case"GET_CHATGPT_FILE_STATUS":return CI(A.fileId);case"GET_INTERPRETER_DOWNLOAD_URL":return sI(A.data);case"GET_IS_SIDEPANEL_OPEN":return u.default.runtime.getContexts?u.default.runtime.getContexts({contextTypes:["SIDE_PANEL"]}).then(i=>i.length>0):!1;case"OPEN_SIDEPANEL":return MI(e.tab);case"CLOSE_SIDEPANEL":return!u.default.sidePanel||!u.default.sidePanel.setOptions?!1:u.default.sidePanel.setOptions({enabled:!1}).then(()=>u.default.sidePanel.setOptions({enabled:!0}));case"KEEP_GPT_IN_SIDEBAR":return cI(A.id);default:break}return new Promise(i=>{setTimeout(()=>{i()},32)})});async function HI(){return(await u.default.cookies.getAll({domain:V.domain})).filter(e=>e.name.startsWith("CloudFront-")&&e.domain==="."+V.domain).map(e=>e.name.split("CloudFront-")[1]+"="+e.value)}Z("sider-image-creator-get-signed-cookie",Ca);Z("sider-image-creator-get-engine-list",la);Z("sider-image-creator-get-tools-list",Ea);Z("sider-image-creator-text-to-image",({data:A})=>ta(A));Z("sider-image-creator-image-to-image",({data:A})=>ia(A));Z("sider-image-creator-image-to-image-upscale",({data:A})=>oa(A));Z("sider-image-creator-image-to-image-masking",({data:A})=>ra(A));Z("sider-image-creator-image-to-image-inpainting",({data:A})=>na(A));Z("sider-image-creator-image-to-image-remove-text",({data:A})=>aa(A));Z("sider-image-creator-image-to-image-remove-background",({data:A})=>Ia(A));Z("sider-image-creator-image-to-image-replace-background",({data:A})=>sa(A));Z("sider-image-creator-image-to-image-upscaling",({data:A})=>ga(A));Z("sider-image-creator-image-to-image-portrait-depth",({data:A})=>Ba(A));Z("sider-image-creator-image-to-image-portrait-normals",({data:A})=>ca(A));Z("sider-image-creator-image-to-image-variation",({data:A})=>Qa(A));Z("open-standalone-page",()=>Si());Z("detect-language",({data:A,sender:e})=>u.default.tabs.detectLanguage(A??e.tab?.id));Z("get-window-value",async({data:{tabId:A,keys:e},sender:t})=>{let i=A==="sender"?t.tab?.id:A;if(i===void 0)throw new Error("tabId is required");return u.default.scripting.executeScript({args:[e],target:{tabId:i},func:o=>{let r={};A:for(let[a,n]of Object.entries(o)){let I=window;for(let s of n){if(I==null){r[a]=void 0;continue A}I=I[s]}r[a]=I}return r},world:"MAIN"}).then(([o])=>{if(!o)throw new Error("executeScript failed");let{error:r,result:a}=o;if(r)throw r instanceof Error?r:new Error("executeScript failed: unknown error");return a})});Z("fetch-base64-from-bg",async({data:A})=>{let{url:e}=A,i=await(await fetch(e)).blob();return{base64:await Mt(i),size:i.size,type:i.type}});Z("get-sender",({sender:A})=>A);chrome&&chrome.sidePanel&&chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(A=>{});u.default.runtime.onInstalled.addListener(async A=>{if(A.reason==="install"&&(co(),u.default.storage.local.set({installedAt:Date.now(),installedFirstVersion:u.default.runtime.getManifest().version,__autoShowSwitchbar__:!0}),await DI(),setTimeout(async()=>{u.default.tabs.create({url:"setup.html"});let{installByAD:e}=await R({installByAD:!1});e&&Re({url:yA.login,active:!1})},200)),(A.reason==="install"||A.reason==="update")&&(Ze(),u.default.storage.local.get("provider:siderApi").then(e=>{e&&e["provider:siderApi"]?.model==="gpt-4"&&u.default.storage.local.set({"provider:siderApi":{model:"gpt-4o"}}),e&&e["provider:siderApi"]?.model==="gemini-pro"&&u.default.storage.local.set({"provider:siderApi":{model:"gemini-1.5-flash"}})}),u.default.storage.local.get("siderGrammarKey").then(e=>{e&&e.siderGrammarKey?.model==="gpt-4"&&u.default.storage.local.set({siderGrammarKey:{model:"gpt-4o"}})}),u.default.tabs.query({active:!0,currentWindow:!0}).then(e=>{let t=e[0].id;t!==void 0&&ao(t)})),A.reason==="update"){let e=Zn[0];u.default.storage.local.get({shownChangelogVersion:"",installedFirstVersion:"1.0.0"}).then(({shownChangelogVersion:t,installedFirstVersion:i})=>{t!==e.version&&e.notifyType==="modal"&&Gi(i)!==Gi(e.version)&&(pI(),UI(xn))}),u.default.storage.local.get("webAccessEnabled").then(t=>{t.webAccessEnabled&&(u.default.storage.local.set({autoTools:["search"]}),u.default.storage.local.remove("webAccessEnabled"))}),u.default.storage.local.remove(["webAppNetwork","chatRequirements"])}A.reason==="install"&&so(),u.default.alarms.create("refresh-image-cookie",{periodInMinutes:5*24*60})});u.default.alarms.onAlarm.addListener(A=>{A.name==="refresh-image-cookie"&&U.signImageCookie()});u.default.tabs.onActivated.addListener(A=>{let e=A.tabId;ao(e),$n(e)});u.default.contextMenus.create({contexts:["selection"],id:"query-selection",title:"Ask Sider"});u.default.contextMenus.onClicked.addListener((A,e)=>{switch(A.menuItemId){case"query-selection":return MI(e),u.default.storage.local.set({initialSelectionText:A.selectionText}).then(()=>{});break}});u.default.runtime.onMessageExternal.addListener((A,e,t)=>{if(Gn.includes(e.id||""))switch(A.type){case"SIDER_OCR":t(!0),A.data?.img&&no(A.data.img);break;default:t(!0),$e();break}});u.default.action.onClicked.addListener(A=>{A.status==="loading"?u.default.runtime.onMessage.addListener(function e(t,i){i.tab&&i.tab.id===A.id&&t.type==="sidebar-ready"&&(u.default.runtime.onMessage.removeListener(e),$e())}):$e(),oo()});async function $e(A){let e=await u.default.tabs.query({active:!0,currentWindow:!0});try{return await u.default.tabs.sendMessage(e[0].id,{type:"toggle-sidebar",isShow:A}),{action:"close"}}catch{return Si(),!1}}var Vd=tA(async function(){let t=(await BI()).items;if(Array.isArray(t)){let i=t.map(o=>({id:o.id,logo:o.manifest.logo_url,name:o.manifest.name_for_human,description:o.manifest.description_for_human}));return u.default.storage.local.set({chatgptPlugins:i})}},1e3);u.default.runtime.setUninstallURL("https://sider.ai/uninstall?app_version="+u.default.runtime.getManifest().version);function MI(A){return!u.default.sidePanel||!u.default.sidePanel.open||A?.windowId===void 0?!1:u.default.sidePanel.open({windowId:A?.windowId}).then(async()=>u.default.runtime.getContexts?await u.default.runtime.getContexts({contextTypes:["SIDE_PANEL"]}).then(t=>t.length>0):!1).catch(e=>!1)}})();
