"use strict";(()=>{var Cs=Object.create;var ei=Object.defineProperty;var ks=Object.getOwnPropertyDescriptor;var Rs=Object.getOwnPropertyNames;var Os=Object.getPrototypeOf,Ms=Object.prototype.hasOwnProperty;var pt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Ls=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Rs(t))!Ms.call(e,i)&&i!==r&&ei(e,i,{get:()=>t[i],enumerable:!(n=ks(t,i))||n.enumerable});return e};var V=(e,t,r)=>(r=e!=null?Cs(Os(e)):{},Ls(t||!e||!e.__esModule?ei(r,"default",{value:e,enumerable:!0}):r,e));var q=pt((jr,ti)=>{(function(e,t){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],t);else if(typeof jr<"u")t(ti);else{var r={exports:{}};t(r),e.browser=r.exports}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:jr,function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){let t="The message port closed before a response was received.",r=n=>{let i={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(i).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class a extends WeakMap{constructor(x,b=void 0){super(b),this.createItem=x}get(x){return this.has(x)||this.set(x,this.createItem(x)),super.get(x)}}let o=d=>d&&typeof d=="object"&&typeof d.then=="function",s=(d,x)=>(...b)=>{n.runtime.lastError?d.reject(new Error(n.runtime.lastError.message)):x.singleCallbackArg||b.length<=1&&x.singleCallbackArg!==!1?d.resolve(b[0]):d.resolve(b)},l=d=>d==1?"argument":"arguments",u=(d,x)=>function(_,...E){if(E.length<x.minArgs)throw new Error(`Expected at least ${x.minArgs} ${l(x.minArgs)} for ${d}(), got ${E.length}`);if(E.length>x.maxArgs)throw new Error(`Expected at most ${x.maxArgs} ${l(x.maxArgs)} for ${d}(), got ${E.length}`);return new Promise((M,L)=>{if(x.fallbackToNoCallback)try{_[d](...E,s({resolve:M,reject:L},x))}catch{_[d](...E),x.fallbackToNoCallback=!1,x.noCallback=!0,M()}else x.noCallback?(_[d](...E),M()):_[d](...E,s({resolve:M,reject:L},x))})},c=(d,x,b)=>new Proxy(x,{apply(_,E,M){return b.call(E,d,...M)}}),p=Function.call.bind(Object.prototype.hasOwnProperty),f=(d,x={},b={})=>{let _=Object.create(null),E={has(L,S){return S in d||S in _},get(L,S,H){if(S in _)return _[S];if(!(S in d))return;let k=d[S];if(typeof k=="function")if(typeof x[S]=="function")k=c(d,d[S],x[S]);else if(p(b,S)){let ee=u(S,b[S]);k=c(d,d[S],ee)}else k=k.bind(d);else if(typeof k=="object"&&k!==null&&(p(x,S)||p(b,S)))k=f(k,x[S],b[S]);else if(p(b,"*"))k=f(k,x[S],b["*"]);else return Object.defineProperty(_,S,{configurable:!0,enumerable:!0,get(){return d[S]},set(ee){d[S]=ee}}),k;return _[S]=k,k},set(L,S,H,k){return S in _?_[S]=H:d[S]=H,!0},defineProperty(L,S,H){return Reflect.defineProperty(_,S,H)},deleteProperty(L,S){return Reflect.deleteProperty(_,S)}},M=Object.create(d);return new Proxy(M,E)},m=d=>({addListener(x,b,..._){x.addListener(d.get(b),..._)},hasListener(x,b){return x.hasListener(d.get(b))},removeListener(x,b){x.removeListener(d.get(b))}}),h=new a(d=>typeof d!="function"?d:function(b){let _=f(b,{},{getContent:{minArgs:0,maxArgs:0}});d(_)}),T=new a(d=>typeof d!="function"?d:function(b,_,E){let M=!1,L,S=new Promise(C=>{L=function(re){M=!0,C(re)}}),H;try{H=d(b,_,L)}catch(C){H=Promise.reject(C)}let k=H!==!0&&o(H);if(H!==!0&&!k&&!M)return!1;let ee=C=>{C.then(re=>{E(re)},re=>{let G;re&&(re instanceof Error||typeof re.message=="string")?G=re.message:G="An unexpected error occurred",E({__mozWebExtensionPolyfillReject__:!0,message:G})}).catch(re=>{})};return ee(k?H:S),!0}),g=({reject:d,resolve:x},b)=>{n.runtime.lastError?n.runtime.lastError.message===t?x():d(new Error(n.runtime.lastError.message)):b&&b.__mozWebExtensionPolyfillReject__?d(new Error(b.message)):x(b)},v=(d,x,b,..._)=>{if(_.length<x.minArgs)throw new Error(`Expected at least ${x.minArgs} ${l(x.minArgs)} for ${d}(), got ${_.length}`);if(_.length>x.maxArgs)throw new Error(`Expected at most ${x.maxArgs} ${l(x.maxArgs)} for ${d}(), got ${_.length}`);return new Promise((E,M)=>{let L=g.bind(null,{resolve:E,reject:M});_.push(L),b.sendMessage(..._)})},w={devtools:{network:{onRequestFinished:m(h)}},runtime:{onMessage:m(T),onMessageExternal:m(T),sendMessage:v.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:v.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},A={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return i.privacy={network:{"*":A},services:{"*":A},websites:{"*":A}},f(n,w,i)};e.exports=r(chrome)}else e.exports=globalThis.browser})});var ri=pt((Ud,Ct)=>{(function(){"use strict";var e={}.hasOwnProperty;function t(){for(var i="",a=0;a<arguments.length;a++){var o=arguments[a];o&&(i=n(i,r(o)))}return i}function r(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return t.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var a="";for(var o in i)e.call(i,o)&&i[o]&&(a=n(a,o));return a}function n(i,a){return a?i?i+" "+a:i+a:i}typeof Ct<"u"&&Ct.exports?(t.default=t,Ct.exports=t):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return t}):window.classNames=t})()});var Io=pt((yw,gn)=>{function Eo(e,t){if(t&&t.documentElement)e=t,t=arguments[2];else if(!e||!e.documentElement)throw new Error("First argument to Readability constructor should be a document object.");if(t=t||{},this._doc=e,this._docJSDOMParser=this._doc.firstChild.__JSDOMParser__,this._articleTitle=null,this._articleByline=null,this._articleDir=null,this._articleSiteName=null,this._attempts=[],this._debug=!!t.debug,this._maxElemsToParse=t.maxElemsToParse||this.DEFAULT_MAX_ELEMS_TO_PARSE,this._nbTopCandidates=t.nbTopCandidates||this.DEFAULT_N_TOP_CANDIDATES,this._charThreshold=t.charThreshold||this.DEFAULT_CHAR_THRESHOLD,this._classesToPreserve=this.CLASSES_TO_PRESERVE.concat(t.classesToPreserve||[]),this._keepClasses=!!t.keepClasses,this._serializer=t.serializer||function(r){return r.innerHTML},this._disableJSONLD=!!t.disableJSONLD,this._allowedVideoRegex=t.allowedVideoRegex||this.REGEXPS.videos,this._flags=this.FLAG_STRIP_UNLIKELYS|this.FLAG_WEIGHT_CLASSES|this.FLAG_CLEAN_CONDITIONALLY,this._debug){let r=function(n){if(n.nodeType==n.TEXT_NODE)return`${n.nodeName} ("${n.textContent}")`;let i=Array.from(n.attributes||[],function(a){return`${a.name}="${a.value}"`}).join(" ");return`<${n.localName} ${i}>`};this.log=function(){if(typeof console<"u")Array.from(arguments,a=>a&&a.nodeType==this.ELEMENT_NODE?r(a):a).unshift("Reader: (Readability)");else if(typeof dump<"u"){var n=Array.prototype.map.call(arguments,function(i){return i&&i.nodeName?r(i):i}).join(" ");dump("Reader: (Readability) "+n+`
`)}}}else this.log=function(){}}Eo.prototype={FLAG_STRIP_UNLIKELYS:1,FLAG_WEIGHT_CLASSES:2,FLAG_CLEAN_CONDITIONALLY:4,ELEMENT_NODE:1,TEXT_NODE:3,DEFAULT_MAX_ELEMS_TO_PARSE:0,DEFAULT_N_TOP_CANDIDATES:5,DEFAULT_TAGS_TO_SCORE:"section,h2,h3,h4,h5,h6,p,td,pre".toUpperCase().split(","),DEFAULT_CHAR_THRESHOLD:500,REGEXPS:{unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i,positive:/article|body|content|entry|hentry|h-entry|main|page|pagination|post|text|blog|story/i,negative:/-ad-|hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|gdpr|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i,extraneous:/print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single|utility/i,byline:/byline|author|dateline|writtenby|p-author/i,replaceFonts:/<(\/?)font[^>]*>/gi,normalize:/\s{2,}/g,videos:/\/\/(www\.)?((dailymotion|youtube|youtube-nocookie|player\.vimeo|v\.qq)\.com|(archive|upload\.wikimedia)\.org|player\.twitch\.tv)/i,shareElements:/(\b|_)(share|sharedaddy)(\b|_)/i,nextLink:/(next|weiter|continue|>([^\|]|$)|»([^\|]|$))/i,prevLink:/(prev|earl|old|new|<|«)/i,tokenize:/\W+/g,whitespace:/^\s*$/,hasContent:/\S$/,hashUrl:/^#.+/,srcsetUrl:/(\S+)(\s+[\d.]+[xw])?(\s*(?:,|$))/g,b64DataUrl:/^data:\s*([^\s;,]+)\s*;\s*base64\s*,/i,jsonLdArticleTypes:/^Article|AdvertiserContentArticle|NewsArticle|AnalysisNewsArticle|AskPublicNewsArticle|BackgroundNewsArticle|OpinionNewsArticle|ReportageNewsArticle|ReviewNewsArticle|Report|SatiricalArticle|ScholarlyArticle|MedicalScholarlyArticle|SocialMediaPosting|BlogPosting|LiveBlogPosting|DiscussionForumPosting|TechArticle|APIReference$/},UNLIKELY_ROLES:["menu","menubar","complementary","navigation","alert","alertdialog","dialog"],DIV_TO_P_ELEMS:new Set(["BLOCKQUOTE","DL","DIV","IMG","OL","P","PRE","TABLE","UL"]),ALTER_TO_DIV_EXCEPTIONS:["DIV","ARTICLE","SECTION","P"],PRESENTATIONAL_ATTRIBUTES:["align","background","bgcolor","border","cellpadding","cellspacing","frame","hspace","rules","style","valign","vspace"],DEPRECATED_SIZE_ATTRIBUTE_ELEMS:["TABLE","TH","TD","HR","PRE"],PHRASING_ELEMS:["ABBR","AUDIO","B","BDO","BR","BUTTON","CITE","CODE","DATA","DATALIST","DFN","EM","EMBED","I","IMG","INPUT","KBD","LABEL","MARK","MATH","METER","NOSCRIPT","OBJECT","OUTPUT","PROGRESS","Q","RUBY","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRONG","SUB","SUP","TEXTAREA","TIME","VAR","WBR"],CLASSES_TO_PRESERVE:["page"],HTML_ESCAPE_MAP:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"},_postProcessContent:function(e){this._fixRelativeUris(e),this._simplifyNestedElements(e),this._keepClasses||this._cleanClasses(e)},_removeNodes:function(e,t){if(this._docJSDOMParser&&e._isLiveNodeList)throw new Error("Do not pass live node lists to _removeNodes");for(var r=e.length-1;r>=0;r--){var n=e[r],i=n.parentNode;i&&(!t||t.call(this,n,r,e))&&i.removeChild(n)}},_replaceNodeTags:function(e,t){if(this._docJSDOMParser&&e._isLiveNodeList)throw new Error("Do not pass live node lists to _replaceNodeTags");for(let r of e)this._setNodeTag(r,t)},_forEachNode:function(e,t){Array.prototype.forEach.call(e,t,this)},_findNode:function(e,t){return Array.prototype.find.call(e,t,this)},_someNode:function(e,t){return Array.prototype.some.call(e,t,this)},_everyNode:function(e,t){return Array.prototype.every.call(e,t,this)},_concatNodeLists:function(){var e=Array.prototype.slice,t=e.call(arguments),r=t.map(function(n){return e.call(n)});return Array.prototype.concat.apply([],r)},_getAllNodesWithTag:function(e,t){return e.querySelectorAll?e.querySelectorAll(t.join(",")):[].concat.apply([],t.map(function(r){var n=e.getElementsByTagName(r);return Array.isArray(n)?n:Array.from(n)}))},_cleanClasses:function(e){var t=this._classesToPreserve,r=(e.getAttribute("class")||"").split(/\s+/).filter(function(n){return t.indexOf(n)!=-1}).join(" ");for(r?e.setAttribute("class",r):e.removeAttribute("class"),e=e.firstElementChild;e;e=e.nextElementSibling)this._cleanClasses(e)},_fixRelativeUris:function(e){var t=this._doc.baseURI,r=this._doc.documentURI;function n(o){if(t==r&&o.charAt(0)=="#")return o;try{return new URL(o,t).href}catch{}return o}var i=this._getAllNodesWithTag(e,["a"]);this._forEachNode(i,function(o){var s=o.getAttribute("href");if(s)if(s.indexOf("javascript:")===0)if(o.childNodes.length===1&&o.childNodes[0].nodeType===this.TEXT_NODE){var l=this._doc.createTextNode(o.textContent);o.parentNode.replaceChild(l,o)}else{for(var u=this._doc.createElement("span");o.firstChild;)u.appendChild(o.firstChild);o.parentNode.replaceChild(u,o)}else o.setAttribute("href",n(s))});var a=this._getAllNodesWithTag(e,["img","picture","figure","video","audio","source"]);this._forEachNode(a,function(o){var s=o.getAttribute("src"),l=o.getAttribute("poster"),u=o.getAttribute("srcset");if(s&&o.setAttribute("src",n(s)),l&&o.setAttribute("poster",n(l)),u){var c=u.replace(this.REGEXPS.srcsetUrl,function(p,f,m,h){return n(f)+(m||"")+h});o.setAttribute("srcset",c)}})},_simplifyNestedElements:function(e){for(var t=e;t;){if(t.parentNode&&["DIV","SECTION"].includes(t.tagName)&&!(t.id&&t.id.startsWith("readability"))){if(this._isElementWithoutContent(t)){t=this._removeAndGetNext(t);continue}else if(this._hasSingleTagInsideElement(t,"DIV")||this._hasSingleTagInsideElement(t,"SECTION")){for(var r=t.children[0],n=0;n<t.attributes.length;n++)r.setAttribute(t.attributes[n].name,t.attributes[n].value);t.parentNode.replaceChild(r,t),t=r;continue}}t=this._getNextNode(t)}},_getArticleTitle:function(){var e=this._doc,t="",r="";try{t=r=e.title.trim(),typeof t!="string"&&(t=r=this._getInnerText(e.getElementsByTagName("title")[0]))}catch{}var n=!1;function i(c){return c.split(/\s+/).length}if(/ [\|\-\\\/>»] /.test(t))n=/ [\\\/>»] /.test(t),t=r.replace(/(.*)[\|\-\\\/>»] .*/gi,"$1"),i(t)<3&&(t=r.replace(/[^\|\-\\\/>»]*[\|\-\\\/>»](.*)/gi,"$1"));else if(t.indexOf(": ")!==-1){var a=this._concatNodeLists(e.getElementsByTagName("h1"),e.getElementsByTagName("h2")),o=t.trim(),s=this._someNode(a,function(c){return c.textContent.trim()===o});s||(t=r.substring(r.lastIndexOf(":")+1),i(t)<3?t=r.substring(r.indexOf(":")+1):i(r.substr(0,r.indexOf(":")))>5&&(t=r))}else if(t.length>150||t.length<15){var l=e.getElementsByTagName("h1");l.length===1&&(t=this._getInnerText(l[0]))}t=t.trim().replace(this.REGEXPS.normalize," ");var u=i(t);return u<=4&&(!n||u!=i(r.replace(/[\|\-\\\/>»]+/g,""))-1)&&(t=r),t},_prepDocument:function(){var e=this._doc;this._removeNodes(this._getAllNodesWithTag(e,["style"])),e.body&&this._replaceBrs(e.body),this._replaceNodeTags(this._getAllNodesWithTag(e,["font"]),"SPAN")},_nextNode:function(e){for(var t=e;t&&t.nodeType!=this.ELEMENT_NODE&&this.REGEXPS.whitespace.test(t.textContent);)t=t.nextSibling;return t},_replaceBrs:function(e){this._forEachNode(this._getAllNodesWithTag(e,["br"]),function(t){for(var r=t.nextSibling,n=!1;(r=this._nextNode(r))&&r.tagName=="BR";){n=!0;var i=r.nextSibling;r.parentNode.removeChild(r),r=i}if(n){var a=this._doc.createElement("p");for(t.parentNode.replaceChild(a,t),r=a.nextSibling;r;){if(r.tagName=="BR"){var o=this._nextNode(r.nextSibling);if(o&&o.tagName=="BR")break}if(!this._isPhrasingContent(r))break;var s=r.nextSibling;a.appendChild(r),r=s}for(;a.lastChild&&this._isWhitespace(a.lastChild);)a.removeChild(a.lastChild);a.parentNode.tagName==="P"&&this._setNodeTag(a.parentNode,"DIV")}})},_setNodeTag:function(e,t){if(this.log("_setNodeTag",e,t),this._docJSDOMParser)return e.localName=t.toLowerCase(),e.tagName=t.toUpperCase(),e;for(var r=e.ownerDocument.createElement(t);e.firstChild;)r.appendChild(e.firstChild);e.parentNode.replaceChild(r,e),e.readability&&(r.readability=e.readability);for(var n=0;n<e.attributes.length;n++)try{r.setAttribute(e.attributes[n].name,e.attributes[n].value)}catch{}return r},_prepArticle:function(e){this._cleanStyles(e),this._markDataTables(e),this._fixLazyImages(e),this._cleanConditionally(e,"form"),this._cleanConditionally(e,"fieldset"),this._clean(e,"object"),this._clean(e,"embed"),this._clean(e,"footer"),this._clean(e,"link"),this._clean(e,"aside");var t=this.DEFAULT_CHAR_THRESHOLD;this._forEachNode(e.children,function(r){this._cleanMatchedNodes(r,function(n,i){return this.REGEXPS.shareElements.test(i)&&n.textContent.length<t})}),this._clean(e,"iframe"),this._clean(e,"input"),this._clean(e,"textarea"),this._clean(e,"select"),this._clean(e,"button"),this._cleanHeaders(e),this._cleanConditionally(e,"table"),this._cleanConditionally(e,"ul"),this._cleanConditionally(e,"div"),this._replaceNodeTags(this._getAllNodesWithTag(e,["h1"]),"h2"),this._removeNodes(this._getAllNodesWithTag(e,["p"]),function(r){var n=r.getElementsByTagName("img").length,i=r.getElementsByTagName("embed").length,a=r.getElementsByTagName("object").length,o=r.getElementsByTagName("iframe").length,s=n+i+a+o;return s===0&&!this._getInnerText(r,!1)}),this._forEachNode(this._getAllNodesWithTag(e,["br"]),function(r){var n=this._nextNode(r.nextSibling);n&&n.tagName=="P"&&r.parentNode.removeChild(r)}),this._forEachNode(this._getAllNodesWithTag(e,["table"]),function(r){var n=this._hasSingleTagInsideElement(r,"TBODY")?r.firstElementChild:r;if(this._hasSingleTagInsideElement(n,"TR")){var i=n.firstElementChild;if(this._hasSingleTagInsideElement(i,"TD")){var a=i.firstElementChild;a=this._setNodeTag(a,this._everyNode(a.childNodes,this._isPhrasingContent)?"P":"DIV"),r.parentNode.replaceChild(a,r)}}})},_initializeNode:function(e){switch(e.readability={contentScore:0},e.tagName){case"DIV":e.readability.contentScore+=5;break;case"PRE":case"TD":case"BLOCKQUOTE":e.readability.contentScore+=3;break;case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":e.readability.contentScore-=3;break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":e.readability.contentScore-=5;break}e.readability.contentScore+=this._getClassWeight(e)},_removeAndGetNext:function(e){var t=this._getNextNode(e,!0);return e.parentNode.removeChild(e),t},_getNextNode:function(e,t){if(!t&&e.firstElementChild)return e.firstElementChild;if(e.nextElementSibling)return e.nextElementSibling;do e=e.parentNode;while(e&&!e.nextElementSibling);return e&&e.nextElementSibling},_textSimilarity:function(e,t){var r=e.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean),n=t.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean);if(!r.length||!n.length)return 0;var i=n.filter(o=>!r.includes(o)),a=i.join(" ").length/n.join(" ").length;return 1-a},_checkByline:function(e,t){if(this._articleByline)return!1;if(e.getAttribute!==void 0)var r=e.getAttribute("rel"),n=e.getAttribute("itemprop");return(r==="author"||n&&n.indexOf("author")!==-1||this.REGEXPS.byline.test(t))&&this._isValidByline(e.textContent)?(this._articleByline=e.textContent.trim(),!0):!1},_getNodeAncestors:function(e,t){t=t||0;for(var r=0,n=[];e.parentNode&&(n.push(e.parentNode),!(t&&++r===t));)e=e.parentNode;return n},_grabArticle:function(e){this.log("**** grabArticle ****");var t=this._doc,r=e!==null;if(e=e||this._doc.body,!e)return this.log("No body found in document. Abort."),null;for(var n=e.innerHTML;;){this.log("Starting grabArticle loop");var i=this._flagIsActive(this.FLAG_STRIP_UNLIKELYS),a=[],o=this._doc.documentElement;let Zn=!0;for(;o;){o.tagName==="HTML"&&(this._articleLang=o.getAttribute("lang"));var s=o.className+" "+o.id;if(!this._isProbablyVisible(o)){this.log("Removing hidden node - "+s),o=this._removeAndGetNext(o);continue}if(o.getAttribute("aria-modal")=="true"&&o.getAttribute("role")=="dialog"){o=this._removeAndGetNext(o);continue}if(this._checkByline(o,s)){o=this._removeAndGetNext(o);continue}if(Zn&&this._headerDuplicatesTitle(o)){this.log("Removing header: ",o.textContent.trim(),this._articleTitle.trim()),Zn=!1,o=this._removeAndGetNext(o);continue}if(i){if(this.REGEXPS.unlikelyCandidates.test(s)&&!this.REGEXPS.okMaybeItsACandidate.test(s)&&!this._hasAncestorTag(o,"table")&&!this._hasAncestorTag(o,"code")&&o.tagName!=="BODY"&&o.tagName!=="A"){this.log("Removing unlikely candidate - "+s),o=this._removeAndGetNext(o);continue}if(this.UNLIKELY_ROLES.includes(o.getAttribute("role"))){this.log("Removing content with role "+o.getAttribute("role")+" - "+s),o=this._removeAndGetNext(o);continue}}if((o.tagName==="DIV"||o.tagName==="SECTION"||o.tagName==="HEADER"||o.tagName==="H1"||o.tagName==="H2"||o.tagName==="H3"||o.tagName==="H4"||o.tagName==="H5"||o.tagName==="H6")&&this._isElementWithoutContent(o)){o=this._removeAndGetNext(o);continue}if(this.DEFAULT_TAGS_TO_SCORE.indexOf(o.tagName)!==-1&&a.push(o),o.tagName==="DIV"){for(var l=null,u=o.firstChild;u;){var c=u.nextSibling;if(this._isPhrasingContent(u))l!==null?l.appendChild(u):this._isWhitespace(u)||(l=t.createElement("p"),o.replaceChild(l,u),l.appendChild(u));else if(l!==null){for(;l.lastChild&&this._isWhitespace(l.lastChild);)l.removeChild(l.lastChild);l=null}u=c}if(this._hasSingleTagInsideElement(o,"P")&&this._getLinkDensity(o)<.25){var p=o.children[0];o.parentNode.replaceChild(p,o),o=p,a.push(o)}else this._hasChildBlockElement(o)||(o=this._setNodeTag(o,"P"),a.push(o))}o=this._getNextNode(o)}var f=[];this._forEachNode(a,function(ye){if(!(!ye.parentNode||typeof ye.parentNode.tagName>"u")){var Ae=this._getInnerText(ye);if(!(Ae.length<25)){var y=this._getNodeAncestors(ye,5);if(y.length!==0){var Nt=0;Nt+=1,Nt+=Ae.split(",").length,Nt+=Math.min(Math.floor(Ae.length/100),3),this._forEachNode(y,function(De,Dr){if(!(!De.tagName||!De.parentNode||typeof De.parentNode.tagName>"u")){if(typeof De.readability>"u"&&(this._initializeNode(De),f.push(De)),Dr===0)var Br=1;else Dr===1?Br=2:Br=Dr*3;De.readability.contentScore+=Nt/Br}})}}}});for(var m=[],h=0,T=f.length;h<T;h+=1){var g=f[h],v=g.readability.contentScore*(1-this._getLinkDensity(g));g.readability.contentScore=v,this.log("Candidate:",g,"with score "+v);for(var w=0;w<this._nbTopCandidates;w++){var A=m[w];if(!A||v>A.readability.contentScore){m.splice(w,0,g),m.length>this._nbTopCandidates&&m.pop();break}}}var d=m[0]||null,x=!1,b;if(d===null||d.tagName==="BODY"){for(d=t.createElement("DIV"),x=!0;e.firstChild;)this.log("Moving child out:",e.firstChild),d.appendChild(e.firstChild);e.appendChild(d),this._initializeNode(d)}else if(d){for(var _=[],E=1;E<m.length;E++)m[E].readability.contentScore/d.readability.contentScore>=.75&&_.push(this._getNodeAncestors(m[E]));var M=3;if(_.length>=M)for(b=d.parentNode;b.tagName!=="BODY";){for(var L=0,S=0;S<_.length&&L<M;S++)L+=Number(_[S].includes(b));if(L>=M){d=b;break}b=b.parentNode}d.readability||this._initializeNode(d),b=d.parentNode;for(var H=d.readability.contentScore,k=H/3;b.tagName!=="BODY";){if(!b.readability){b=b.parentNode;continue}var ee=b.readability.contentScore;if(ee<k)break;if(ee>H){d=b;break}H=b.readability.contentScore,b=b.parentNode}for(b=d.parentNode;b.tagName!="BODY"&&b.children.length==1;)d=b,b=d.parentNode;d.readability||this._initializeNode(d)}var C=t.createElement("DIV");r&&(C.id="readability-content");var re=Math.max(10,d.readability.contentScore*.2);b=d.parentNode;for(var G=b.children,le=0,ut=G.length;le<ut;le++){var U=G[le],ct=!1;if(this.log("Looking at sibling node:",U,U.readability?"with score "+U.readability.contentScore:""),this.log("Sibling has score",U.readability?U.readability.contentScore:"Unknown"),U===d)ct=!0;else{var Yn=0;if(U.className===d.className&&d.className!==""&&(Yn+=d.readability.contentScore*.2),U.readability&&U.readability.contentScore+Yn>=re)ct=!0;else if(U.nodeName==="P"){var Jn=this._getLinkDensity(U),Qn=this._getInnerText(U),Mr=Qn.length;(Mr>80&&Jn<.25||Mr<80&&Mr>0&&Jn===0&&Qn.search(/\.( |$)/)!==-1)&&(ct=!0)}}ct&&(this.log("Appending node:",U),this.ALTER_TO_DIV_EXCEPTIONS.indexOf(U.nodeName)===-1&&(this.log("Altering sibling:",U,"to div."),U=this._setNodeTag(U,"DIV")),C.appendChild(U),G=b.children,le-=1,ut-=1)}if(this._debug&&this.log("Article content pre-prep: "+C.innerHTML),this._prepArticle(C),this._debug&&this.log("Article content post-prep: "+C.innerHTML),x)d.id="readability-page-1",d.className="page";else{var Pt=t.createElement("DIV");for(Pt.id="readability-page-1",Pt.className="page";C.firstChild;)Pt.appendChild(C.firstChild);C.appendChild(Pt)}this._debug&&this.log("Article content after paging: "+C.innerHTML);var Lr=!0,ft=this._getInnerText(C,!0).length;if(ft<this._charThreshold)if(Lr=!1,e.innerHTML=n,this._flagIsActive(this.FLAG_STRIP_UNLIKELYS))this._removeFlag(this.FLAG_STRIP_UNLIKELYS),this._attempts.push({articleContent:C,textLength:ft});else if(this._flagIsActive(this.FLAG_WEIGHT_CLASSES))this._removeFlag(this.FLAG_WEIGHT_CLASSES),this._attempts.push({articleContent:C,textLength:ft});else if(this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY))this._removeFlag(this.FLAG_CLEAN_CONDITIONALLY),this._attempts.push({articleContent:C,textLength:ft});else{if(this._attempts.push({articleContent:C,textLength:ft}),this._attempts.sort(function(ye,Ae){return Ae.textLength-ye.textLength}),!this._attempts[0].textLength)return null;C=this._attempts[0].articleContent,Lr=!0}if(Lr){var Ns=[b,d].concat(this._getNodeAncestors(b));return this._someNode(Ns,function(ye){if(!ye.tagName)return!1;var Ae=ye.getAttribute("dir");return Ae?(this._articleDir=Ae,!0):!1}),C}}},_isValidByline:function(e){return typeof e=="string"||e instanceof String?(e=e.trim(),e.length>0&&e.length<100):!1},_unescapeHtmlEntities:function(e){if(!e)return e;var t=this.HTML_ESCAPE_MAP;return e.replace(/&(quot|amp|apos|lt|gt);/g,function(r,n){return t[n]}).replace(/&#(?:x([0-9a-z]{1,4})|([0-9]{1,4}));/gi,function(r,n,i){var a=parseInt(n||i,n?16:10);return String.fromCharCode(a)})},_getJSONLD:function(e){var t=this._getAllNodesWithTag(e,["script"]),r;return this._forEachNode(t,function(n){if(!r&&n.getAttribute("type")==="application/ld+json")try{var i=n.textContent.replace(/^\s*<!\[CDATA\[|\]\]>\s*$/g,""),a=JSON.parse(i);if(!a["@context"]||!a["@context"].match(/^https?\:\/\/schema\.org$/)||(!a["@type"]&&Array.isArray(a["@graph"])&&(a=a["@graph"].find(function(u){return(u["@type"]||"").match(this.REGEXPS.jsonLdArticleTypes)})),!a||!a["@type"]||!a["@type"].match(this.REGEXPS.jsonLdArticleTypes)))return;if(r={},typeof a.name=="string"&&typeof a.headline=="string"&&a.name!==a.headline){var o=this._getArticleTitle(),s=this._textSimilarity(a.name,o)>.75,l=this._textSimilarity(a.headline,o)>.75;l&&!s?r.title=a.headline:r.title=a.name}else typeof a.name=="string"?r.title=a.name.trim():typeof a.headline=="string"&&(r.title=a.headline.trim());a.author&&(typeof a.author.name=="string"?r.byline=a.author.name.trim():Array.isArray(a.author)&&a.author[0]&&typeof a.author[0].name=="string"&&(r.byline=a.author.filter(function(u){return u&&typeof u.name=="string"}).map(function(u){return u.name.trim()}).join(", "))),typeof a.description=="string"&&(r.excerpt=a.description.trim()),a.publisher&&typeof a.publisher.name=="string"&&(r.siteName=a.publisher.name.trim());return}catch(u){this.log(u.message)}}),r||{}},_getArticleMetadata:function(e){var t={},r={},n=this._doc.getElementsByTagName("meta"),i=/\s*(dc|dcterm|og|twitter)\s*:\s*(author|creator|description|title|site_name)\s*/gi,a=/^\s*(?:(dc|dcterm|og|twitter|weibo:(article|webpage))\s*[\.:]\s*)?(author|creator|description|title|site_name)\s*$/i;return this._forEachNode(n,function(o){var s=o.getAttribute("name"),l=o.getAttribute("property"),u=o.getAttribute("content");if(u){var c=null,p=null;l&&(c=l.match(i),c&&(p=c[0].toLowerCase().replace(/\s/g,""),r[p]=u.trim())),!c&&s&&a.test(s)&&(p=s,u&&(p=p.toLowerCase().replace(/\s/g,"").replace(/\./g,":"),r[p]=u.trim()))}}),t.title=e.title||r["dc:title"]||r["dcterm:title"]||r["og:title"]||r["weibo:article:title"]||r["weibo:webpage:title"]||r.title||r["twitter:title"],t.title||(t.title=this._getArticleTitle()),t.byline=e.byline||r["dc:creator"]||r["dcterm:creator"]||r.author,t.excerpt=e.excerpt||r["dc:description"]||r["dcterm:description"]||r["og:description"]||r["weibo:article:description"]||r["weibo:webpage:description"]||r.description||r["twitter:description"],t.siteName=e.siteName||r["og:site_name"],t.title=this._unescapeHtmlEntities(t.title),t.byline=this._unescapeHtmlEntities(t.byline),t.excerpt=this._unescapeHtmlEntities(t.excerpt),t.siteName=this._unescapeHtmlEntities(t.siteName),t},_isSingleImage:function(e){return e.tagName==="IMG"?!0:e.children.length!==1||e.textContent.trim()!==""?!1:this._isSingleImage(e.children[0])},_unwrapNoscriptImages:function(e){var t=Array.from(e.getElementsByTagName("img"));this._forEachNode(t,function(n){for(var i=0;i<n.attributes.length;i++){var a=n.attributes[i];switch(a.name){case"src":case"srcset":case"data-src":case"data-srcset":return}if(/\.(jpg|jpeg|png|webp)/i.test(a.value))return}n.parentNode.removeChild(n)});var r=Array.from(e.getElementsByTagName("noscript"));this._forEachNode(r,function(n){var i=e.createElement("div");if(i.innerHTML=n.innerHTML,!!this._isSingleImage(i)){var a=n.previousElementSibling;if(a&&this._isSingleImage(a)){var o=a;o.tagName!=="IMG"&&(o=a.getElementsByTagName("img")[0]);for(var s=i.getElementsByTagName("img")[0],l=0;l<o.attributes.length;l++){var u=o.attributes[l];if(u.value!==""&&(u.name==="src"||u.name==="srcset"||/\.(jpg|jpeg|png|webp)/i.test(u.value))){if(s.getAttribute(u.name)===u.value)continue;var c=u.name;s.hasAttribute(c)&&(c="data-old-"+c),s.setAttribute(c,u.value)}}n.parentNode.replaceChild(i.firstElementChild,a)}}})},_removeScripts:function(e){this._removeNodes(this._getAllNodesWithTag(e,["script","noscript"]))},_hasSingleTagInsideElement:function(e,t){return e.children.length!=1||e.children[0].tagName!==t?!1:!this._someNode(e.childNodes,function(r){return r.nodeType===this.TEXT_NODE&&this.REGEXPS.hasContent.test(r.textContent)})},_isElementWithoutContent:function(e){return e.nodeType===this.ELEMENT_NODE&&e.textContent.trim().length==0&&(e.children.length==0||e.children.length==e.getElementsByTagName("br").length+e.getElementsByTagName("hr").length)},_hasChildBlockElement:function(e){return this._someNode(e.childNodes,function(t){return this.DIV_TO_P_ELEMS.has(t.tagName)||this._hasChildBlockElement(t)})},_isPhrasingContent:function(e){return e.nodeType===this.TEXT_NODE||this.PHRASING_ELEMS.indexOf(e.tagName)!==-1||(e.tagName==="A"||e.tagName==="DEL"||e.tagName==="INS")&&this._everyNode(e.childNodes,this._isPhrasingContent)},_isWhitespace:function(e){return e.nodeType===this.TEXT_NODE&&e.textContent.trim().length===0||e.nodeType===this.ELEMENT_NODE&&e.tagName==="BR"},_getInnerText:function(e,t){t=typeof t>"u"?!0:t;var r=e.textContent.trim();return t?r.replace(this.REGEXPS.normalize," "):r},_getCharCount:function(e,t){return t=t||",",this._getInnerText(e).split(t).length-1},_cleanStyles:function(e){if(!(!e||e.tagName.toLowerCase()==="svg")){for(var t=0;t<this.PRESENTATIONAL_ATTRIBUTES.length;t++)e.removeAttribute(this.PRESENTATIONAL_ATTRIBUTES[t]);this.DEPRECATED_SIZE_ATTRIBUTE_ELEMS.indexOf(e.tagName)!==-1&&(e.removeAttribute("width"),e.removeAttribute("height"));for(var r=e.firstElementChild;r!==null;)this._cleanStyles(r),r=r.nextElementSibling}},_getLinkDensity:function(e){var t=this._getInnerText(e).length;if(t===0)return 0;var r=0;return this._forEachNode(e.getElementsByTagName("a"),function(n){var i=n.getAttribute("href"),a=i&&this.REGEXPS.hashUrl.test(i)?.3:1;r+=this._getInnerText(n).length*a}),r/t},_getClassWeight:function(e){if(!this._flagIsActive(this.FLAG_WEIGHT_CLASSES))return 0;var t=0;return typeof e.className=="string"&&e.className!==""&&(this.REGEXPS.negative.test(e.className)&&(t-=25),this.REGEXPS.positive.test(e.className)&&(t+=25)),typeof e.id=="string"&&e.id!==""&&(this.REGEXPS.negative.test(e.id)&&(t-=25),this.REGEXPS.positive.test(e.id)&&(t+=25)),t},_clean:function(e,t){var r=["object","embed","iframe"].indexOf(t)!==-1;this._removeNodes(this._getAllNodesWithTag(e,[t]),function(n){if(r){for(var i=0;i<n.attributes.length;i++)if(this._allowedVideoRegex.test(n.attributes[i].value))return!1;if(n.tagName==="object"&&this._allowedVideoRegex.test(n.innerHTML))return!1}return!0})},_hasAncestorTag:function(e,t,r,n){r=r||3,t=t.toUpperCase();for(var i=0;e.parentNode;){if(r>0&&i>r)return!1;if(e.parentNode.tagName===t&&(!n||n(e.parentNode)))return!0;e=e.parentNode,i++}return!1},_getRowAndColumnCount:function(e){for(var t=0,r=0,n=e.getElementsByTagName("tr"),i=0;i<n.length;i++){var a=n[i].getAttribute("rowspan")||0;a&&(a=parseInt(a,10)),t+=a||1;for(var o=0,s=n[i].getElementsByTagName("td"),l=0;l<s.length;l++){var u=s[l].getAttribute("colspan")||0;u&&(u=parseInt(u,10)),o+=u||1}r=Math.max(r,o)}return{rows:t,columns:r}},_markDataTables:function(e){for(var t=e.getElementsByTagName("table"),r=0;r<t.length;r++){var n=t[r],i=n.getAttribute("role");if(i=="presentation"){n._readabilityDataTable=!1;continue}var a=n.getAttribute("datatable");if(a=="0"){n._readabilityDataTable=!1;continue}var o=n.getAttribute("summary");if(o){n._readabilityDataTable=!0;continue}var s=n.getElementsByTagName("caption")[0];if(s&&s.childNodes.length>0){n._readabilityDataTable=!0;continue}var l=["col","colgroup","tfoot","thead","th"],u=function(p){return!!n.getElementsByTagName(p)[0]};if(l.some(u)){this.log("Data table because found data-y descendant"),n._readabilityDataTable=!0;continue}if(n.getElementsByTagName("table")[0]){n._readabilityDataTable=!1;continue}var c=this._getRowAndColumnCount(n);if(c.rows>=10||c.columns>4){n._readabilityDataTable=!0;continue}n._readabilityDataTable=c.rows*c.columns>10}},_fixLazyImages:function(e){this._forEachNode(this._getAllNodesWithTag(e,["img","picture","figure"]),function(t){if(t.src&&this.REGEXPS.b64DataUrl.test(t.src)){var r=this.REGEXPS.b64DataUrl.exec(t.src);if(r[1]==="image/svg+xml")return;for(var n=!1,i=0;i<t.attributes.length;i++){var a=t.attributes[i];if(a.name!=="src"&&/\.(jpg|jpeg|png|webp)/i.test(a.value)){n=!0;break}}if(n){var o=t.src.search(/base64\s*/i)+7,s=t.src.length-o;s<133&&t.removeAttribute("src")}}if(!((t.src||t.srcset&&t.srcset!="null")&&t.className.toLowerCase().indexOf("lazy")===-1)){for(var l=0;l<t.attributes.length;l++)if(a=t.attributes[l],!(a.name==="src"||a.name==="srcset"||a.name==="alt")){var u=null;if(/\.(jpg|jpeg|png|webp)\s+\d/.test(a.value)?u="srcset":/^\s*\S+\.(jpg|jpeg|png|webp)\S*\s*$/.test(a.value)&&(u="src"),u){if(t.tagName==="IMG"||t.tagName==="PICTURE")t.setAttribute(u,a.value);else if(t.tagName==="FIGURE"&&!this._getAllNodesWithTag(t,["img","picture"]).length){var c=this._doc.createElement("img");c.setAttribute(u,a.value),t.appendChild(c)}}}}})},_getTextDensity:function(e,t){var r=this._getInnerText(e,!0).length;if(r===0)return 0;var n=0,i=this._getAllNodesWithTag(e,t);return this._forEachNode(i,a=>n+=this._getInnerText(a,!0).length),n/r},_cleanConditionally:function(e,t){this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY)&&this._removeNodes(this._getAllNodesWithTag(e,[t]),function(r){var n=function(b){return b._readabilityDataTable},i=t==="ul"||t==="ol";if(!i){var a=0,o=this._getAllNodesWithTag(r,["ul","ol"]);this._forEachNode(o,b=>a+=this._getInnerText(b).length),i=a/this._getInnerText(r).length>.9}if(t==="table"&&n(r)||this._hasAncestorTag(r,"table",-1,n)||this._hasAncestorTag(r,"code"))return!1;var s=this._getClassWeight(r);this.log("Cleaning Conditionally",r);var l=0;if(s+l<0)return!0;if(this._getCharCount(r,",")<10){for(var u=r.getElementsByTagName("p").length,c=r.getElementsByTagName("img").length,p=r.getElementsByTagName("li").length-100,f=r.getElementsByTagName("input").length,m=this._getTextDensity(r,["h1","h2","h3","h4","h5","h6"]),h=0,T=this._getAllNodesWithTag(r,["object","embed","iframe"]),g=0;g<T.length;g++){for(var v=0;v<T[g].attributes.length;v++)if(this._allowedVideoRegex.test(T[g].attributes[v].value))return!1;if(T[g].tagName==="object"&&this._allowedVideoRegex.test(T[g].innerHTML))return!1;h++}var w=this._getLinkDensity(r),A=this._getInnerText(r).length,d=c>1&&u/c<.5&&!this._hasAncestorTag(r,"figure")||!i&&p>u||f>Math.floor(u/3)||!i&&m<.9&&A<25&&(c===0||c>2)&&!this._hasAncestorTag(r,"figure")||!i&&s<25&&w>.2||s>=25&&w>.5||h===1&&A<75||h>1;if(i&&d){for(var x=0;x<r.children.length;x++)if(r.children[x].children.length>1)return d;let b=r.getElementsByTagName("li").length;if(c==b)return!1}return d}return!1})},_cleanMatchedNodes:function(e,t){for(var r=this._getNextNode(e,!0),n=this._getNextNode(e);n&&n!=r;)t.call(this,n,n.className+" "+n.id)?n=this._removeAndGetNext(n):n=this._getNextNode(n)},_cleanHeaders:function(e){let t=this._getAllNodesWithTag(e,["h1","h2"]);this._removeNodes(t,function(r){let n=this._getClassWeight(r)<0;return n&&this.log("Removing header with low class weight:",r),n})},_headerDuplicatesTitle:function(e){if(e.tagName!="H1"&&e.tagName!="H2")return!1;var t=this._getInnerText(e,!1);return this.log("Evaluating similarity of header:",t,this._articleTitle),this._textSimilarity(this._articleTitle,t)>.75},_flagIsActive:function(e){return(this._flags&e)>0},_removeFlag:function(e){this._flags=this._flags&~e},_isProbablyVisible:function(e){return(!e.style||e.style.display!="none")&&!e.hasAttribute("hidden")&&(!e.hasAttribute("aria-hidden")||e.getAttribute("aria-hidden")!="true"||e.className&&e.className.indexOf&&e.className.indexOf("fallback-image")!==-1)},parse:function(){if(this._maxElemsToParse>0){var e=this._doc.getElementsByTagName("*").length;if(e>this._maxElemsToParse)throw new Error("Aborting parsing document; "+e+" elements found")}this._unwrapNoscriptImages(this._doc);var t=this._disableJSONLD?{}:this._getJSONLD(this._doc);this._removeScripts(this._doc),this._prepDocument();var r=this._getArticleMetadata(t);this._articleTitle=r.title;var n=this._grabArticle();if(!n)return null;if(this.log("Grabbed: "+n.innerHTML),this._postProcessContent(n),!r.excerpt){var i=n.getElementsByTagName("p");i.length>0&&(r.excerpt=i[0].textContent.trim())}var a=n.textContent;return{title:this._articleTitle,byline:r.byline||this._articleByline,dir:this._articleDir,lang:this._articleLang,content:this._serializer(n),textContent:a,length:a.length,excerpt:r.excerpt,siteName:r.siteName||this._articleSiteName}}};typeof gn=="object"&&(gn.exports=Eo)});var No=pt((bw,hn)=>{var Po={unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i};function xm(e){return(!e.style||e.style.display!="none")&&!e.hasAttribute("hidden")&&(!e.hasAttribute("aria-hidden")||e.getAttribute("aria-hidden")!="true"||e.className&&e.className.indexOf&&e.className.indexOf("fallback-image")!==-1)}function Tm(e,t={}){typeof t=="function"&&(t={visibilityChecker:t});var r={minScore:20,minContentLength:140,visibilityChecker:xm};t=Object.assign(r,t);var n=e.querySelectorAll("p, pre, article"),i=e.querySelectorAll("div > br");if(i.length){var a=new Set(n);[].forEach.call(i,function(s){a.add(s.parentNode)}),n=Array.from(a)}var o=0;return[].some.call(n,function(s){if(!t.visibilityChecker(s))return!1;var l=s.className+" "+s.id;if(Po.unlikelyCandidates.test(l)&&!Po.okMaybeItsACandidate.test(l)||s.matches("li p"))return!1;var u=s.textContent.trim().length;return u<t.minContentLength?!1:(o+=Math.sqrt(u-t.minContentLength),o>t.minScore)})}typeof hn=="object"&&(hn.exports=Tm)});var yn=pt((xw,Co)=>{var vm=Io(),_m=No();Co.exports={Readability:vm,isProbablyReaderable:_m}});var we=V(q());var um=V(ri());var Ds=typeof global=="object"&&global&&global.Object===Object&&global,kt=Ds;var Bs=typeof self=="object"&&self&&self.Object===Object&&self,js=kt||Bs||Function("return this")(),j=js;var Gs=j.Symbol,be=Gs;var ni=Object.prototype,Us=ni.hasOwnProperty,Ks=ni.toString,mt=be?be.toStringTag:void 0;function Fs(e){var t=Us.call(e,mt),r=e[mt];try{e[mt]=void 0;var n=!0}catch{}var i=Ks.call(e);return n&&(t?e[mt]=r:delete e[mt]),i}var ii=Fs;var $s=Object.prototype,Hs=$s.toString;function Vs(e){return Hs.call(e)}var ai=Vs;var Ws="[object Null]",zs="[object Undefined]",oi=be?be.toStringTag:void 0;function qs(e){return e==null?e===void 0?zs:Ws:oi&&oi in Object(e)?ii(e):ai(e)}var ie=qs;function Xs(e){return e!=null&&typeof e=="object"}var X=Xs;var Ys="[object Symbol]";function Js(e){return typeof e=="symbol"||X(e)&&ie(e)==Ys}var si=Js;var Qs=Array.isArray,ue=Qs;var Zs=/\s/;function el(e){for(var t=e.length;t--&&Zs.test(e.charAt(t)););return t}var li=el;var tl=/^\s+/;function rl(e){return e&&e.slice(0,li(e)+1).replace(tl,"")}var ui=rl;function nl(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var K=nl;var ci=NaN,il=/^[-+]0x[0-9a-f]+$/i,al=/^0b[01]+$/i,ol=/^0o[0-7]+$/i,sl=parseInt;function ll(e){if(typeof e=="number")return e;if(si(e))return ci;if(K(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=K(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ui(e);var r=al.test(e);return r||ol.test(e)?sl(e.slice(2),r?2:8):il.test(e)?ci:+e}var Gr=ll;function ul(e){return e}var Rt=ul;var cl="[object AsyncFunction]",fl="[object Function]",pl="[object GeneratorFunction]",ml="[object Proxy]";function dl(e){if(!K(e))return!1;var t=ie(e);return t==fl||t==pl||t==cl||t==ml}var $e=dl;var gl=j["__core-js_shared__"],Ot=gl;var fi=function(){var e=/[^.]+$/.exec(Ot&&Ot.keys&&Ot.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function hl(e){return!!fi&&fi in e}var pi=hl;var yl=Function.prototype,bl=yl.toString;function xl(e){if(e!=null){try{return bl.call(e)}catch{}try{return e+""}catch{}}return""}var xe=xl;var Tl=/[\\^$.*+?()[\]{}|]/g,vl=/^\[object .+?Constructor\]$/,_l=Function.prototype,wl=Object.prototype,Al=_l.toString,Sl=wl.hasOwnProperty,El=RegExp("^"+Al.call(Sl).replace(Tl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Il(e){if(!K(e)||pi(e))return!1;var t=$e(e)?El:vl;return t.test(xe(e))}var mi=Il;function Pl(e,t){return e?.[t]}var di=Pl;function Nl(e,t){var r=di(e,t);return mi(r)?r:void 0}var ne=Nl;var Cl=ne(j,"WeakMap"),Mt=Cl;var gi=Object.create,kl=function(){function e(){}return function(t){if(!K(t))return{};if(gi)return gi(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),hi=kl;function Rl(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var yi=Rl;function Ol(){}var Ur=Ol;function Ml(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var Lt=Ml;var Ll=800,Dl=16,Bl=Date.now;function jl(e){var t=0,r=0;return function(){var n=Bl(),i=Dl-(n-r);if(r=n,i>0){if(++t>=Ll)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var bi=jl;function Gl(e){return function(){return e}}var xi=Gl;var Ul=function(){try{var e=ne(Object,"defineProperty");return e({},"",{}),e}catch{}}(),He=Ul;var Kl=He?function(e,t){return He(e,"toString",{configurable:!0,enumerable:!1,value:xi(t),writable:!0})}:Rt,Ti=Kl;var Fl=bi(Ti),vi=Fl;function $l(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var _i=$l;var Hl=9007199254740991,Vl=/^(?:0|[1-9]\d*)$/;function Wl(e,t){var r=typeof e;return t=t??Hl,!!t&&(r=="number"||r!="symbol"&&Vl.test(e))&&e>-1&&e%1==0&&e<t}var Dt=Wl;function zl(e,t,r){t=="__proto__"&&He?He(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Ve=zl;function ql(e,t){return e===t||e!==e&&t!==t}var Se=ql;var Xl=Object.prototype,Yl=Xl.hasOwnProperty;function Jl(e,t,r){var n=e[t];(!(Yl.call(e,t)&&Se(n,r))||r===void 0&&!(t in e))&&Ve(e,t,r)}var Bt=Jl;function Ql(e,t,r,n){var i=!r;r||(r={});for(var a=-1,o=t.length;++a<o;){var s=t[a],l=n?n(r[s],e[s],s,r,e):void 0;l===void 0&&(l=e[s]),i?Ve(r,s,l):Bt(r,s,l)}return r}var ce=Ql;var wi=Math.max;function Zl(e,t,r){return t=wi(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,a=wi(n.length-t,0),o=Array(a);++i<a;)o[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(o),yi(e,this,s)}}var Ai=Zl;function eu(e,t){return vi(Ai(e,t,Rt),e+"")}var Si=eu;var tu=9007199254740991;function ru(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=tu}var jt=ru;function nu(e){return e!=null&&jt(e.length)&&!$e(e)}var fe=nu;function iu(e,t,r){if(!K(r))return!1;var n=typeof t;return(n=="number"?fe(r)&&Dt(t,r.length):n=="string"&&t in r)?Se(r[t],e):!1}var Ei=iu;function au(e){return Si(function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(a=e.length>3&&typeof a=="function"?(i--,a):void 0,o&&Ei(r[0],r[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var s=r[n];s&&e(t,s,n,a)}return t})}var Ii=au;var ou=Object.prototype;function su(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||ou;return e===r}var Ee=su;function lu(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var Pi=lu;var uu="[object Arguments]";function cu(e){return X(e)&&ie(e)==uu}var Kr=cu;var Ni=Object.prototype,fu=Ni.hasOwnProperty,pu=Ni.propertyIsEnumerable,mu=Kr(function(){return arguments}())?Kr:function(e){return X(e)&&fu.call(e,"callee")&&!pu.call(e,"callee")},Be=mu;function du(){return!1}var Ci=du;var Oi=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ki=Oi&&typeof module=="object"&&module&&!module.nodeType&&module,gu=ki&&ki.exports===Oi,Ri=gu?j.Buffer:void 0,hu=Ri?Ri.isBuffer:void 0,yu=hu||Ci,Ie=yu;var bu="[object Arguments]",xu="[object Array]",Tu="[object Boolean]",vu="[object Date]",_u="[object Error]",wu="[object Function]",Au="[object Map]",Su="[object Number]",Eu="[object Object]",Iu="[object RegExp]",Pu="[object Set]",Nu="[object String]",Cu="[object WeakMap]",ku="[object ArrayBuffer]",Ru="[object DataView]",Ou="[object Float32Array]",Mu="[object Float64Array]",Lu="[object Int8Array]",Du="[object Int16Array]",Bu="[object Int32Array]",ju="[object Uint8Array]",Gu="[object Uint8ClampedArray]",Uu="[object Uint16Array]",Ku="[object Uint32Array]",D={};D[Ou]=D[Mu]=D[Lu]=D[Du]=D[Bu]=D[ju]=D[Gu]=D[Uu]=D[Ku]=!0;D[bu]=D[xu]=D[ku]=D[Tu]=D[Ru]=D[vu]=D[_u]=D[wu]=D[Au]=D[Su]=D[Eu]=D[Iu]=D[Pu]=D[Nu]=D[Cu]=!1;function Fu(e){return X(e)&&jt(e.length)&&!!D[ie(e)]}var Mi=Fu;function $u(e){return function(t){return e(t)}}var We=$u;var Li=typeof exports=="object"&&exports&&!exports.nodeType&&exports,dt=Li&&typeof module=="object"&&module&&!module.nodeType&&module,Hu=dt&&dt.exports===Li,Fr=Hu&&kt.process,Vu=function(){try{var e=dt&&dt.require&&dt.require("util").types;return e||Fr&&Fr.binding&&Fr.binding("util")}catch{}}(),Te=Vu;var Di=Te&&Te.isTypedArray,Wu=Di?We(Di):Mi,ze=Wu;var zu=Object.prototype,qu=zu.hasOwnProperty;function Xu(e,t){var r=ue(e),n=!r&&Be(e),i=!r&&!n&&Ie(e),a=!r&&!n&&!i&&ze(e),o=r||n||i||a,s=o?Pi(e.length,String):[],l=s.length;for(var u in e)(t||qu.call(e,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Dt(u,l)))&&s.push(u);return s}var Gt=Xu;function Yu(e,t){return function(r){return e(t(r))}}var Ut=Yu;var Ju=Ut(Object.keys,Object),Bi=Ju;var Qu=Object.prototype,Zu=Qu.hasOwnProperty;function ec(e){if(!Ee(e))return Bi(e);var t=[];for(var r in Object(e))Zu.call(e,r)&&r!="constructor"&&t.push(r);return t}var Kt=ec;function tc(e){return fe(e)?Gt(e):Kt(e)}var qe=tc;function rc(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var ji=rc;var nc=Object.prototype,ic=nc.hasOwnProperty;function ac(e){if(!K(e))return ji(e);var t=Ee(e),r=[];for(var n in e)n=="constructor"&&(t||!ic.call(e,n))||r.push(n);return r}var Gi=ac;function oc(e){return fe(e)?Gt(e,!0):Gi(e)}var pe=oc;var sc=ne(Object,"create"),ve=sc;function lc(){this.__data__=ve?ve(null):{},this.size=0}var Ui=lc;function uc(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Ki=uc;var cc="__lodash_hash_undefined__",fc=Object.prototype,pc=fc.hasOwnProperty;function mc(e){var t=this.__data__;if(ve){var r=t[e];return r===cc?void 0:r}return pc.call(t,e)?t[e]:void 0}var Fi=mc;var dc=Object.prototype,gc=dc.hasOwnProperty;function hc(e){var t=this.__data__;return ve?t[e]!==void 0:gc.call(t,e)}var $i=hc;var yc="__lodash_hash_undefined__";function bc(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ve&&t===void 0?yc:t,this}var Hi=bc;function Xe(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Xe.prototype.clear=Ui;Xe.prototype.delete=Ki;Xe.prototype.get=Fi;Xe.prototype.has=$i;Xe.prototype.set=Hi;var $r=Xe;function xc(){this.__data__=[],this.size=0}var Vi=xc;function Tc(e,t){for(var r=e.length;r--;)if(Se(e[r][0],t))return r;return-1}var Pe=Tc;var vc=Array.prototype,_c=vc.splice;function wc(e){var t=this.__data__,r=Pe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():_c.call(t,r,1),--this.size,!0}var Wi=wc;function Ac(e){var t=this.__data__,r=Pe(t,e);return r<0?void 0:t[r][1]}var zi=Ac;function Sc(e){return Pe(this.__data__,e)>-1}var qi=Sc;function Ec(e,t){var r=this.__data__,n=Pe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Xi=Ec;function Ye(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ye.prototype.clear=Vi;Ye.prototype.delete=Wi;Ye.prototype.get=zi;Ye.prototype.has=qi;Ye.prototype.set=Xi;var Ne=Ye;var Ic=ne(j,"Map"),Ce=Ic;function Pc(){this.size=0,this.__data__={hash:new $r,map:new(Ce||Ne),string:new $r}}var Yi=Pc;function Nc(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Ji=Nc;function Cc(e,t){var r=e.__data__;return Ji(t)?r[typeof t=="string"?"string":"hash"]:r.map}var ke=Cc;function kc(e){var t=ke(this,e).delete(e);return this.size-=t?1:0,t}var Qi=kc;function Rc(e){return ke(this,e).get(e)}var Zi=Rc;function Oc(e){return ke(this,e).has(e)}var ea=Oc;function Mc(e,t){var r=ke(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var ta=Mc;function Je(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Je.prototype.clear=Yi;Je.prototype.delete=Qi;Je.prototype.get=Zi;Je.prototype.has=ea;Je.prototype.set=ta;var gt=Je;var Lc="Expected a function";function Hr(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Lc);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var o=e.apply(this,n);return r.cache=a.set(i,o)||a,o};return r.cache=new(Hr.Cache||gt),r}Hr.Cache=gt;var Vr=Hr;function Dc(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var Ft=Dc;var Bc=Ut(Object.getPrototypeOf,Object),Qe=Bc;var jc="[object Object]",Gc=Function.prototype,Uc=Object.prototype,ra=Gc.toString,Kc=Uc.hasOwnProperty,Fc=ra.call(Object);function $c(e){if(!X(e)||ie(e)!=jc)return!1;var t=Qe(e);if(t===null)return!0;var r=Kc.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&ra.call(r)==Fc}var Ze=$c;function Hc(){this.__data__=new Ne,this.size=0}var na=Hc;function Vc(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var ia=Vc;function Wc(e){return this.__data__.get(e)}var aa=Wc;function zc(e){return this.__data__.has(e)}var oa=zc;var qc=200;function Xc(e,t){var r=this.__data__;if(r instanceof Ne){var n=r.__data__;if(!Ce||n.length<qc-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new gt(n)}return r.set(e,t),this.size=r.size,this}var sa=Xc;function et(e){var t=this.__data__=new Ne(e);this.size=t.size}et.prototype.clear=na;et.prototype.delete=ia;et.prototype.get=aa;et.prototype.has=oa;et.prototype.set=sa;var $t=et;function Yc(e,t){return e&&ce(t,qe(t),e)}var la=Yc;function Jc(e,t){return e&&ce(t,pe(t),e)}var ua=Jc;var ma=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ca=ma&&typeof module=="object"&&module&&!module.nodeType&&module,Qc=ca&&ca.exports===ma,fa=Qc?j.Buffer:void 0,pa=fa?fa.allocUnsafe:void 0;function Zc(e,t){if(t)return e.slice();var r=e.length,n=pa?pa(r):new e.constructor(r);return e.copy(n),n}var Ht=Zc;function ef(e,t){for(var r=-1,n=e==null?0:e.length,i=0,a=[];++r<n;){var o=e[r];t(o,r,e)&&(a[i++]=o)}return a}var da=ef;function tf(){return[]}var Vt=tf;var rf=Object.prototype,nf=rf.propertyIsEnumerable,ga=Object.getOwnPropertySymbols,af=ga?function(e){return e==null?[]:(e=Object(e),da(ga(e),function(t){return nf.call(e,t)}))}:Vt,tt=af;function of(e,t){return ce(e,tt(e),t)}var ha=of;var sf=Object.getOwnPropertySymbols,lf=sf?function(e){for(var t=[];e;)Ft(t,tt(e)),e=Qe(e);return t}:Vt,Wt=lf;function uf(e,t){return ce(e,Wt(e),t)}var ya=uf;function cf(e,t,r){var n=t(e);return ue(e)?n:Ft(n,r(e))}var zt=cf;function ff(e){return zt(e,qe,tt)}var ba=ff;function pf(e){return zt(e,pe,Wt)}var xa=pf;var mf=ne(j,"DataView"),qt=mf;var df=ne(j,"Promise"),Xt=df;var gf=ne(j,"Set"),Yt=gf;var Ta="[object Map]",hf="[object Object]",va="[object Promise]",_a="[object Set]",wa="[object WeakMap]",Aa="[object DataView]",yf=xe(qt),bf=xe(Ce),xf=xe(Xt),Tf=xe(Yt),vf=xe(Mt),je=ie;(qt&&je(new qt(new ArrayBuffer(1)))!=Aa||Ce&&je(new Ce)!=Ta||Xt&&je(Xt.resolve())!=va||Yt&&je(new Yt)!=_a||Mt&&je(new Mt)!=wa)&&(je=function(e){var t=ie(e),r=t==hf?e.constructor:void 0,n=r?xe(r):"";if(n)switch(n){case yf:return Aa;case bf:return Ta;case xf:return va;case Tf:return _a;case vf:return wa}return t});var Re=je;var _f=Object.prototype,wf=_f.hasOwnProperty;function Af(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&wf.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Sa=Af;var Sf=j.Uint8Array,Wr=Sf;function Ef(e){var t=new e.constructor(e.byteLength);return new Wr(t).set(new Wr(e)),t}var rt=Ef;function If(e,t){var r=t?rt(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var Ea=If;var Pf=/\w*$/;function Nf(e){var t=new e.constructor(e.source,Pf.exec(e));return t.lastIndex=e.lastIndex,t}var Ia=Nf;var Pa=be?be.prototype:void 0,Na=Pa?Pa.valueOf:void 0;function Cf(e){return Na?Object(Na.call(e)):{}}var Ca=Cf;function kf(e,t){var r=t?rt(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Jt=kf;var Rf="[object Boolean]",Of="[object Date]",Mf="[object Map]",Lf="[object Number]",Df="[object RegExp]",Bf="[object Set]",jf="[object String]",Gf="[object Symbol]",Uf="[object ArrayBuffer]",Kf="[object DataView]",Ff="[object Float32Array]",$f="[object Float64Array]",Hf="[object Int8Array]",Vf="[object Int16Array]",Wf="[object Int32Array]",zf="[object Uint8Array]",qf="[object Uint8ClampedArray]",Xf="[object Uint16Array]",Yf="[object Uint32Array]";function Jf(e,t,r){var n=e.constructor;switch(t){case Uf:return rt(e);case Rf:case Of:return new n(+e);case Kf:return Ea(e,r);case Ff:case $f:case Hf:case Vf:case Wf:case zf:case qf:case Xf:case Yf:return Jt(e,r);case Mf:return new n;case Lf:case jf:return new n(e);case Df:return Ia(e);case Bf:return new n;case Gf:return Ca(e)}}var ka=Jf;function Qf(e){return typeof e.constructor=="function"&&!Ee(e)?hi(Qe(e)):{}}var Qt=Qf;var Zf="[object Map]";function ep(e){return X(e)&&Re(e)==Zf}var Ra=ep;var Oa=Te&&Te.isMap,tp=Oa?We(Oa):Ra,Ma=tp;var rp="[object Set]";function np(e){return X(e)&&Re(e)==rp}var La=np;var Da=Te&&Te.isSet,ip=Da?We(Da):La,Ba=ip;var ap=1,op=2,sp=4,ja="[object Arguments]",lp="[object Array]",up="[object Boolean]",cp="[object Date]",fp="[object Error]",Ga="[object Function]",pp="[object GeneratorFunction]",mp="[object Map]",dp="[object Number]",Ua="[object Object]",gp="[object RegExp]",hp="[object Set]",yp="[object String]",bp="[object Symbol]",xp="[object WeakMap]",Tp="[object ArrayBuffer]",vp="[object DataView]",_p="[object Float32Array]",wp="[object Float64Array]",Ap="[object Int8Array]",Sp="[object Int16Array]",Ep="[object Int32Array]",Ip="[object Uint8Array]",Pp="[object Uint8ClampedArray]",Np="[object Uint16Array]",Cp="[object Uint32Array]",R={};R[ja]=R[lp]=R[Tp]=R[vp]=R[up]=R[cp]=R[_p]=R[wp]=R[Ap]=R[Sp]=R[Ep]=R[mp]=R[dp]=R[Ua]=R[gp]=R[hp]=R[yp]=R[bp]=R[Ip]=R[Pp]=R[Np]=R[Cp]=!0;R[fp]=R[Ga]=R[xp]=!1;function Zt(e,t,r,n,i,a){var o,s=t&ap,l=t&op,u=t&sp;if(r&&(o=i?r(e,n,i,a):r(e)),o!==void 0)return o;if(!K(e))return e;var c=ue(e);if(c){if(o=Sa(e),!s)return Lt(e,o)}else{var p=Re(e),f=p==Ga||p==pp;if(Ie(e))return Ht(e,s);if(p==Ua||p==ja||f&&!i){if(o=l||f?{}:Qt(e),!s)return l?ya(e,ua(o,e)):ha(e,la(o,e))}else{if(!R[p])return i?e:{};o=ka(e,p,s)}}a||(a=new $t);var m=a.get(e);if(m)return m;a.set(e,o),Ba(e)?e.forEach(function(g){o.add(Zt(g,t,r,g,e,a))}):Ma(e)&&e.forEach(function(g,v){o.set(v,Zt(g,t,r,v,e,a))});var h=u?l?xa:ba:l?pe:qe,T=c?void 0:h(e);return _i(T||e,function(g,v){T&&(v=g,g=e[v]),Bt(o,v,Zt(g,t,r,v,e,a))}),o}var Ka=Zt;var kp=4;function Rp(e){return Ka(e,kp)}var zr=Rp;function Op(e){return function(t,r,n){for(var i=-1,a=Object(t),o=n(t),s=o.length;s--;){var l=o[e?s:++i];if(r(a[l],l,a)===!1)break}return t}}var Fa=Op;var Mp=Fa(),$a=Mp;var Lp=function(){return j.Date.now()},er=Lp;var Dp="Expected a function",Bp=Math.max,jp=Math.min;function Gp(e,t,r){var n,i,a,o,s,l,u=0,c=!1,p=!1,f=!0;if(typeof e!="function")throw new TypeError(Dp);t=Gr(t)||0,K(r)&&(c=!!r.leading,p="maxWait"in r,a=p?Bp(Gr(r.maxWait)||0,t):a,f="trailing"in r?!!r.trailing:f);function m(b){var _=n,E=i;return n=i=void 0,u=b,o=e.apply(E,_),o}function h(b){return u=b,s=setTimeout(v,t),c?m(b):o}function T(b){var _=b-l,E=b-u,M=t-_;return p?jp(M,a-E):M}function g(b){var _=b-l,E=b-u;return l===void 0||_>=t||_<0||p&&E>=a}function v(){var b=er();if(g(b))return w(b);s=setTimeout(v,T(b))}function w(b){return s=void 0,f&&n?m(b):(n=i=void 0,o)}function A(){s!==void 0&&clearTimeout(s),u=0,n=l=i=s=void 0}function d(){return s===void 0?o:w(er())}function x(){var b=er(),_=g(b);if(n=arguments,i=this,l=b,_){if(s===void 0)return h(l);if(p)return clearTimeout(s),s=setTimeout(v,t),m(l)}return s===void 0&&(s=setTimeout(v,t)),o}return x.cancel=A,x.flush=d,x}var Y=Gp;function Up(e,t,r){(r!==void 0&&!Se(e[t],r)||r===void 0&&!(t in e))&&Ve(e,t,r)}var ht=Up;function Kp(e){return X(e)&&fe(e)}var Ha=Kp;function Fp(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var yt=Fp;function $p(e){return ce(e,pe(e))}var Va=$p;function Hp(e,t,r,n,i,a,o){var s=yt(e,r),l=yt(t,r),u=o.get(l);if(u){ht(e,r,u);return}var c=a?a(s,l,r+"",e,t,o):void 0,p=c===void 0;if(p){var f=ue(l),m=!f&&Ie(l),h=!f&&!m&&ze(l);c=l,f||m||h?ue(s)?c=s:Ha(s)?c=Lt(s):m?(p=!1,c=Ht(l,!0)):h?(p=!1,c=Jt(l,!0)):c=[]:Ze(l)||Be(l)?(c=s,Be(s)?c=Va(s):(!K(s)||$e(s))&&(c=Qt(l))):p=!1}p&&(o.set(l,c),i(c,l,n,a,o),o.delete(l)),ht(e,r,c)}var Wa=Hp;function za(e,t,r,n,i){e!==t&&$a(t,function(a,o){if(i||(i=new $t),K(a))Wa(e,t,o,r,za,n,i);else{var s=n?n(yt(e,o),a,o+"",e,t,i):void 0;s===void 0&&(s=a),ht(e,o,s)}},pe)}var qa=za;var Vp=Ii(function(e,t,r,n){qa(e,t,r,n)}),qr=Vp;var Wp="[object Map]",zp="[object Set]",qp=Object.prototype,Xp=qp.hasOwnProperty;function Yp(e){if(e==null)return!0;if(fe(e)&&(ue(e)||typeof e=="string"||typeof e.splice=="function"||Ie(e)||ze(e)||Be(e)))return!e.length;var t=Re(e);if(t==Wp||t==zp)return!e.size;if(Ee(e))return!Kt(e).length;for(var r in e)if(Xp.call(e,r))return!1;return!0}var Xr=Yp;var cm=V(q());var uo=V(q());var B=V(q());var Jp=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]),Qp=new Map(Jp),Xa=Qp;var Yr=class e extends Error{name="NonError";constructor(t){super(e._prepareSuperMessage(t))}static _prepareSuperMessage(t){try{return JSON.stringify(t)}catch{return String(t)}}},Zp=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],Jr=new WeakSet,em=e=>{Jr.add(e);let t=e.toJSON();return Jr.delete(e),t},Ja=e=>Xa.get(e)??Error,Qr=({from:e,seen:t,to:r,forceEnumerable:n,maxDepth:i,depth:a,useToJSON:o,serialize:s})=>{if(!r)if(Array.isArray(e))r=[];else if(!s&&Ya(e)){let u=Ja(e.name);r=new u}else r={};if(t.push(e),a>=i)return r;if(o&&typeof e.toJSON=="function"&&!Jr.has(e))return em(e);let l=u=>Qr({from:u,seen:[...t],forceEnumerable:n,maxDepth:i,depth:a,useToJSON:o,serialize:s});for(let[u,c]of Object.entries(e)){if(c&&c instanceof Uint8Array&&c.constructor.name==="Buffer"){r[u]="[object Buffer]";continue}if(c!==null&&typeof c=="object"&&typeof c.pipe=="function"){r[u]="[object Stream]";continue}if(typeof c!="function"){if(!c||typeof c!="object"){try{r[u]=c}catch{}continue}if(!t.includes(e[u])){a++,r[u]=l(e[u]);continue}r[u]="[Circular]"}}for(let{property:u,enumerable:c}of Zp)typeof e[u]<"u"&&e[u]!==null&&Object.defineProperty(r,u,{value:Ya(e[u])?l(e[u]):e[u],enumerable:n?!0:c,configurable:!0,writable:!0});return r};function Qa(e,t={}){let{maxDepth:r=Number.POSITIVE_INFINITY,useToJSON:n=!0}=t;return typeof e=="object"&&e!==null?Qr({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0,useToJSON:n,serialize:!0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function Za(e,t={}){let{maxDepth:r=Number.POSITIVE_INFINITY}=t;if(e instanceof Error)return e;if(tm(e)){let n=Ja(e.name);return Qr({from:e,seen:[],to:new n,maxDepth:r,depth:0,serialize:!1})}return new Yr(e)}function Ya(e){return!!e&&typeof e=="object"&&"name"in e&&"message"in e&&"stack"in e}function tm(e){return!!e&&typeof e=="object"&&"message"in e&&!Array.isArray(e)}var nt=V(q());var eo="__webext_forward_tabs_message__",tr=new Map,rm=io(),nm=no(),to=(e,t)=>{if(rm){let i=im(e,t);if(i)return i}if(e.view==="sidebar"&&!nm)return;let r=e.type,n=tr.get(r);if(n)return new Promise(async i=>{try{i({data:await n({sender:t,data:e.data,id:r,originalSender:e.sender})})}catch(a){i({error:Qa(a)})}})};function im(e,t){if(e.type===eo)return new Promise(async(r,n)=>{let{tabId:i,frameId:a,type:o,data:s,view:l}=e.data,u;try{u=i==="sender"?t.tab.id:i==="active"?await tn():i}catch(p){return n(p)}let c=a==="sender"?t.frameId:a;r(nt.default.tabs.sendMessage(u,{type:o,data:s,sender:t,view:l},c===void 0?void 0:{frameId:c}))})}async function Zr(...e){if(!nt.default.runtime.id)throw new Error("Extension not initialized.");let[t,r,n={}]=e,i=n.tabId,a=n.frameId,o=n.view,s;if(i===void 0?s=await nt.default.runtime.sendMessage({type:t,data:r,view:o}):i!=="sender"&&a!=="sender"&&ro()?s=await nt.default.tabs.sendMessage(i==="active"?await tn():i,{type:t,data:r,view:o},a===void 0?void 0:{frameId:a}):s=await nt.default.runtime.sendMessage({type:eo,data:{tabId:i,frameId:a,type:t,data:r,view:o}}),!s)throw new Error(`null for Message ID "${t}". Maybe multiple async runtime.onMessage listeners or no listener.`);if("error"in s)throw Za(s.error);return s.data}function en(e,t,r={}){let n=r.signal;if(n?.aborted)return Ur;if(tr.get(e))throw new Error(`Message ID "${e}" already has a listener.`);tr.set(e,t);let a=()=>tr.delete(e);return n&&n.addEventListener("abort",a,{once:!0}),()=>{a(),n&&n.removeEventListener("abort",a)}}var ao=V(q());async function J(e,t){let r=await ao.default.storage.local.get(e);return typeof e=="string"?Object.hasOwn(r,e)?r[e]:t:r}var am=V(q());function oe(e){return B.default.storage.local.get(e)}async function O(e){return B.default.storage.local.set(e)}async function Oe(e){return B.default.storage.local.remove(e)}async function rn(e){if(B.default.cookies){let t=await B.default.cookies.get(e);return t?.value?decodeURIComponent(t.value):""}return B.default.runtime.sendMessage({type:"GET_COOKIE",data:e})}async function oo(e){return B.default?.cookies?await B.default.cookies.set(e):B.default.runtime.sendMessage({type:"SET_COOKIE",data:e})}function so(e){return rn({name:e,url:se.origin})}async function rr(){return(await B.default.tabs.query({active:!0,currentWindow:!0}))[0]}function Ge({type:e,data:t}){return B.default.runtime.sendMessage({type:"FORWARD_MSG",subtype:e,data:t})}function nn(e,t){return e.type==="FORWARD_MSG"&&e.subtype?e.subtype===t:e.type===t}function ro(){return!!(B.default.tabs&&B.default.tabs.query)}async function tn(){let[e]=await B.default.tabs.query({active:!0,currentWindow:!0});if(!e)throw new Error("No active tab");let t=e.id;if(t===void 0)throw new Error("No active tab");return t}function no(){try{let t=B.default.runtime.getManifest().side_panel.default_path,r=new URL(B.default.runtime.getURL(t)),n=new URL(window.location.href);return n.pathname===r.pathname&&n.origin===r.origin}catch{return!1}}function io(){if(!("serviceWorker"in navigator)&&!B.default.extension.getViews)return!0;try{let e=new URL(window.location.href);return browser.runtime.getManifest().background.scripts.some(r=>{let n=new URL(B.default.runtime.getURL(r));return e.pathname===n.pathname&&e.origin===n.origin})}catch{return!1}}async function an(){if(await J("sidebarMode","sidepanel")==="sidepanel")return await B.default.runtime.sendMessage({type:"GET_IS_SIDEPANEL_OPEN"})?B.default.runtime.sendMessage({type:"CLOSE_SIDEPANEL"}).then(()=>"sider-closed").catch(()=>"sider-close-error"):B.default.runtime.sendMessage({type:"OPEN_SIDEPANEL"}).then(r=>(r||B.default.runtime.sendMessage({type:"POPUP_OPEN"}),"sider-opened")).catch(()=>"sider-open-error");if(B.default.runtime.id)return B.default.runtime.sendMessage({type:"POPUP_OPEN"}),"sider-opened"}var on="__TMP_GPT5_INFO__";var sn=uo.default.runtime.getManifest(),ln=sn.version_name===sn.version+"-e";var co=`ChitChat_${ln?"Edge":"Chrome"}_Ext`,_e=sn.version;var om={dev:"https://dev.wisehood.ai",test:"https://dev.wisehood.ai",preview:"https://preview.sider.ai",prod:"https://sider.ai"},sm={dev:"wisehood.ai",test:"wisehood.ai",preview:"sider.ai",prod:"sider.ai"},lo=om.prod,se={origin:lo,api:`${lo}/api`,domain:sm.prod},fo="https://www.google-analytics.com/mp/collect",po="G-0PRFKME4HP";var mo="6FX_tIISST2SsnSx29yQRg";var nr=(y=>(y.English="en",y["Chinese(Simplified)"]="zh_CN",y["Chinese(Traditional)"]="zh_TW",y.Spanish="es",y.French="fr",y.Japanese="ja",y.German="de",y.Portuguese="pt",y.Arabic="ar",y.Russian="ru",y.Italian="it",y.Korean="ko",y.Hindi="hi",y.Dutch="nl",y.Polish="pl",y.Amharic="am",y.Bulgarian="bg",y.Bengali="bn",y.Catalan="ca",y.Czech="cs",y.Danish="da",y.Greek="el",y.Estonian="et",y.Persian="fa",y.Finnish="fi",y.Filipino="fil",y.Gujarati="gu",y.Hebrew="he",y.Croatian="hr",y.Hungarian="hu",y.Indonesian="id",y.Kannada="kn",y.Lithuanian="lt",y.Latvian="lv",y.Malayalam="ml",y.Marathi="mr",y.Malay="ms",y.Norwegian="no",y.Romanian="ro",y.Slovak="sk",y.Slovenian="sl",y.Serbian="sr",y.Swedish="sv",y.Swahili="sw",y.Tamil="ta",y.Telugu="te",y.Thai="th",y.Turkish="tr",y.Ukrainian="uk",y.Urdu="ur",y.Vietnamese="vi",y))(nr||{}),go=(y=>(y.English="en",y["English (Australia)"]="en_AU",y["English (Canada)"]="en_CA",y["English (India)"]="en_IN",y["English (UK)"]="en_UK",y["English (US)"]="en_US",y["Chinese (Simplified)"]="zh_CN",y["Chinese (Traditional)"]="zh_TW",y.Spanish="es",y["Spanish (Argentina)"]="es_AR",y["Spanish (Colombia)"]="es_CO",y["Spanish (Spain)"]="es_ES",y["Spanish (Mexico)"]="es_MX",y.French="fr",y.Japanese="ja",y.German="de",y.Portuguese="pt",y.Arabic="ar",y["Arabic (Egypt)"]="ar_EG",y["Arabic (Saudi)"]="ar_SA",y.Russian="ru",y.Italian="it",y.Korean="ko",y.Hindi="hi",y.Dutch="nl",y.Polish="pl",y["Portuguese (Brazil)"]="pt_BR",y["Portuguese (Portugal)"]="pt_PT",y.Amharic="am",y.Bengali="bn",y.Bulgarian="bg",y.Catalan="ca",y.Croatian="hr",y.Czech="cs",y.Danish="da",y.Estonian="et",y.Filipino="fil",y.Finnish="fi",y.Greek="el",y.Gujarati="gu",y.Hebrew="he",y.Hungarian="hu",y.Indonesian="id",y.Kannada="kn",y.Latvian="lv",y.Lithuanian="lt",y.Malay="ms",y.Malayalam="ml",y.Marathi="mr",y.Norwegian="no",y.Persian="fa",y.Romanian="ro",y.Serbian="sr",y.Slovak="sk",y.Slovenian="sl",y.Swahili="sw",y.Swedish="sv",y.Tamil="ta",y.Telugu="te",y.Thai="th",y.Turkish="tr",y.Ukrainian="uk",y.Urdu="ur",y.Vietnamese="vi",y))(go||{}),ho={en:"English",zh_CN:"\u4E2D\u6587(\u7B80\u4F53)",zh_TW:"\u4E2D\u6587(\u7E41\u9AD4)",es:"Espa\xF1ol",fr:"Fran\xE7ais",ja:"\u65E5\u672C\u8A9E",de:"Deutsch",pt:"Portugu\xEAs",ar:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",ru:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",it:"Italiano",ko:"\uD55C\uAD6D\uC5B4",hi:"\u0939\u093F\u0928\u094D\u0926\u0940",nl:"Nederlands",pl:"Polski",am:"\u12A0\u121B\u122D\u129B",bg:"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438",bn:"\u09AC\u09BE\u0982\u09B2\u09BE",ca:"Catal\xE0",cs:"\u010Ce\u0161tina",da:"Dansk",el:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",et:"Eesti",fa:"\u0641\u0627\u0631\u0633\u06CC",fi:"Suomi",fil:"Filipino",gu:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0",he:"\u05E2\u05D1\u05E8\u05D9\u05EA",hr:"Hrvatski",hu:"Magyar",id:"Indonesia",kn:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1",lt:"Lietuvi\u0173",lv:"Latvie\u0161u",ml:"\u0D2E\u0D32\u0D2F\u0D3E\u0D33\u0D02",mr:"\u092E\u0930\u093E\u0920\u0940",ms:"Melayu",no:"Norsk",ro:"Rom\xE2n\u0103",sk:"Sloven\u010Dina",sl:"Sloven\u0161\u010Dina",sr:"\u0421\u0440\u043F\u0441\u043A\u0438",sv:"Svenska",sw:"Kiswahili",ta:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD",te:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41",th:"\u0E44\u0E17\u0E22",tr:"T\xFCrk\xE7e",uk:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",ur:"\u0627\u0631\u062F\u0648",vi:"Ti\u1EBFng Vi\u1EC7t"},lm={en:"English",en_AU:"English (Australia)",en_CA:"English (Canada)",en_IN:"English (India)",en_UK:"English (UK)",en_US:"English (US)",zh_CN:"\u4E2D\u6587(\u7B80\u4F53)",zh_TW:"\u4E2D\u6587(\u7E41\u9AD4)",es:"Espa\xF1ol",es_AR:"Espa\xF1ol (Argentina)",es_CO:"Espa\xF1ol (Colombia)",es_ES:"Espa\xF1ol (Spain)",es_MX:"Espa\xF1ol (Mexico)",fr:"Fran\xE7ais",ja:"\u65E5\u672C\u8A9E",de:"Deutsch",pt:"Portugu\xEAs",ar:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",ar_EG:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629 (Egypt)",ar_SA:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629 (Saudi)",ru:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",it:"Italiano",ko:"\uD55C\uAD6D\uC5B4",hi:"\u0939\u093F\u0928\u094D\u0926\u0940",nl:"Nederlands",pl:"Polski",pt_BR:"Portugu\xEAs (Brazil)",pt_PT:"Portugu\xEAs (Portugal)",am:"\u12A0\u121B\u122D\u129B",bn:"\u09AC\u09BE\u0982\u09B2\u09BE",bg:"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438",ca:"Catal\xE0",hr:"Hrvatski",cs:"\u010Ce\u0161tina",da:"Dansk",et:"Eesti",fil:"Filipino",fi:"Suomi",el:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",gu:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0",he:"\u05E2\u05D1\u05E8\u05D9\u05EA",hu:"Magyar",id:"Indonesia",kn:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1",lv:"Latvie\u0161u",lt:"Lietuvi\u0173",ms:"Melayu",ml:"\u0D2E\u0D32\u0D2F\u0D3E\u0D33\u0D02",mr:"\u092E\u0930\u093E\u0920\u0940",no:"Norsk",fa:"\u0641\u0627\u0631\u0633\u06CC",ro:"Rom\xE2n\u0103",sr:"\u0421\u0440\u043F\u0441\u043A\u0438",sk:"Sloven\u010Dina",sl:"Sloven\u0161\u010Dina",sw:"Kiswahili",sv:"Svenska",ta:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD",te:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41",th:"\u0E44\u0E17\u0E22",tr:"T\xFCrk\xE7e",uk:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",ur:"\u0627\u0631\u062F\u0648",vi:"Ti\u1EBFng Vi\u1EC7t"},N_=Object.entries(nr).reduce((e,[t,r])=>(e[r]=t,e),{}),C_=Object.entries(nr).map(([e,t])=>({label:e,value:t,name:ho[t]})),k_=Object.entries(go).map(([e,t])=>({label:e,value:t,name:lm[t]})),R_=Object.entries(ho).map(([e,t])=>({label:t,value:e}));var yo="provider:siderApi",O_=`${yo}:SelectedModels`;var bo={stackoverflow:/stackoverflow\.com\/questions\/\d+\/.+/,stackexchange:/stackexchange\.com\/questions\/\d+\/.+/,quora:/quora\.com\/.+-(.+-?)+/,zhihu:/zhihu\.com\/question\/\d+/,youtube:/youtube\.com\/watch/,gDocs:/docs\.google\.com\/document\/d\//,bilibili:/bilibili\.com\/video\/\w+/,googleSearch:/(https:\/\/(www\.)?google\.com)|(google(\.\w+)+\/search\?)/,notion:/notion\.so\/\w+/,gmail:/^https:\/\/mail\.google\.com\/mail\/u\/\d+\//},M_={login:`${se.origin}/login`,openaiChat:"https://chatgpt.com",openaiLogin:"https://platform.openai.com/login",openaiSignup:"https://platform.openai.com/signup",openaiApiKey:"https://platform.openai.com/account/api-keys",openaiApiSession:"https://chatgpt.com/api/auth/session",edgeStore:"https://microsoftedge.microsoft.com/addons/detail/sider-ai-sidebar/dhoenijjpgpeimemopealfcbiecgceod",chromeStore:"https://chromewebstore.google.com/detail/sider-chatgpt-sidebar-+-v/difoiogjjojoaoomphldepapgpbgkhkb",chromeStoreReview:"https://chromewebstore.google.com/detail/sider-chatgpt-sidebar-+-v/difoiogjjojoaoomphldepapgpbgkhkb/reviews",weChatQrCode:"https://sider.ai/resource/weixin/qrcode.jpeg",producthuntPromoteApi:"https://sider.ai/resource/promotion/extension-promote.json",promoteConfigApi:"https://sider.ai/resource/promotion/promote-config.json"},un={sidebarShortcut:{key:"p",keyCode:80,metaKey:!0,ctrlKey:!0,altKey:!1,shiftKey:!1},sidebarFab:!0,selectionSidebarFab:!0};var cn={key:"j",keyCode:74,metaKey:!0,ctrlKey:!0,altKey:!1,shiftKey:!1};var L_=1024*1024*10,D_=1024*1024*100;var xo=["search","text_to_image","data_analysis"];var P="https://sider-pub.s3.amazonaws.com/videos/set-up/",B_=[{name:"chat",list:[{name:"ai-bot",url:P+"1-chat/1-ai-bots-all-in-one.mp4"},{name:"web-access",url:P+"1-chat/2-web-access.mp4"},{name:"data-analysis",url:P+"1-chat/3-data-analysis.mp4"},{name:"painter",url:P+"1-chat/4-painter-in-chat.mp4"},{name:"prompts",url:P+"1-chat/5-prompts-in-chat.mp4"}]},{name:"translation",list:[{name:"widget",url:P+"2-translation/1-translation-widget.mp4"},{name:"selected",url:P+"2-translation/2-selected-words-translation.mp4"},{name:"input",url:P+"2-translation/3-input-box-translation.mp4"},{name:"page",url:P+"2-translation/4-page-translation.mp4"},{name:"in-chat",url:P+"2-translation/5-translation-in-chat.mp4"},{name:"in-chat2",url:P+"2-translation/6-translation-in-chat2.mp4"}]},{name:"summary",list:[{name:"youtube",url:P+"3-summary/1-youtube-summary.mp4"},{name:"doc",url:P+"3-summary/2-doc-summary.mp4"},{name:"page",url:P+"3-summary/3-page-summary.mp4"},{name:"page2",url:P+"3-summary/4-page-summary2.mp4"}]},{name:"chatpdf",list:[{name:"chatpdf",url:P+"4-chatpdf/1-chatpdf.mp4"}]},{name:"write",list:[{name:"widget",url:P+"5-write/1-write-widget.mp4"},{name:"context",url:P+"5-write/2-context-menu-write.mp4"},{name:"input",url:P+"5-write/3-input-box-write.mp4"}]},{name:"painter",list:[{name:"image",url:P+"6-ai-painter/1-ai-image.mp4"},{name:"bg-remove",url:P+"6-ai-painter/2-background-remover.mp4"},{name:"bg-replace",url:P+"6-ai-painter/3-background-replacer.mp4"},{name:"upscale",url:P+"6-ai-painter/4-image-upscale.mp4"},{name:"eraser",url:P+"6-ai-painter/5-item-eraser.mp4"},{name:"text-remove",url:P+"6-ai-painter/6-text-remover.mp4"}]},{name:"ocr",list:[{name:"ocr",url:P+"7-ocr/1-ocr.mp4"}]},{name:"grammar",list:[{name:"widget",url:P+"8-grammar/1-grammar-widget.mp4"},{name:"context",url:P+"8-grammar/2-context-menu-grammar.mp4"}]},{name:"email",list:[{name:"reply",url:P+"9-email-reply/1-email-reply.mp4"}]}];function fn(e){return[...new Set(e)]}var To=(...e)=>e.join("/").replace(/([^:])\/{2,}/g,"$1/");function bt(e=1e3){return new Promise(t=>setTimeout(t,e))}async function Ue(e,t=1e3,r=2){let n=0;for(;;){try{return await e()}catch(i){if(r>=0&&n++>=r)throw i}await bt(t)}}function me(e,t=0){let r=!1,n;return function(...i){return r||(r=!0,n=new Promise((a,o)=>{e(...i).then(a).catch(o).finally(async()=>{t&&await bt(t),r=!1})})),n}}function vo(e,t,r){return async()=>{let n=Date.now(),i=await oe({[e]:0});if(n-i[e]>r){let a=await t();return await O({[e]:n}),a}return null}}function _o(e,t){let r=new ClipboardEvent("paste",{clipboardData:new DataTransfer,bubbles:!0,cancelable:!0});return r.clipboardData?.setData("text/plain",e),t.dispatchEvent(r)}function ae(e,t){return bo[e].test(t||location.href)}var ir=Vr(e=>{let t=0;for(let r=0;r<e.length;r++)t=Math.imul(31,t)+e.charCodeAt(r)|0;return""+t});function pn(e){let t=r=>{let n=r.timeRemaining();(n>0?e(n):!1)||requestIdleCallback(t)};requestIdleCallback(t)}function ar(e,t){return Promise.race([e,new Promise((r,n)=>{setTimeout(()=>{n(new Error("timeout"))},t)})])}function wo(e){return e.replaceAll(/[\s\u200C]{3,}/gu,t=>t.includes(`
`)?`
`:"  ")}var or,fm=new Uint8Array(16);function mn(){if(!or&&(or=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!or))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return or(fm)}var W=[];for(let e=0;e<256;++e)W.push((e+256).toString(16).slice(1));function Ao(e,t=0){return W[e[t+0]]+W[e[t+1]]+W[e[t+2]]+W[e[t+3]]+"-"+W[e[t+4]]+W[e[t+5]]+"-"+W[e[t+6]]+W[e[t+7]]+"-"+W[e[t+8]]+W[e[t+9]]+"-"+W[e[t+10]]+W[e[t+11]]+W[e[t+12]]+W[e[t+13]]+W[e[t+14]]+W[e[t+15]]}var pm=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),dn={randomUUID:pm};function mm(e,t,r){if(dn.randomUUID&&!t&&!e)return dn.randomUUID();e=e||{};let n=e.random||(e.rng||mn)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let i=0;i<16;++i)t[r+i]=n[i];return t}return Ao(n)}var Ke=mm;var de=class{constructor(){this.eventMap=new Map}on(t,r){let n=this.eventMap.get(t);return n||(n=new Set,this.eventMap.set(t,n)),n.add(r),this}off(t,r){let n=this.eventMap.get(t);return n&&(n.delete(r),n.size===0&&this.eventMap.delete(t)),this}remvoeAllListeners(t){t?this.eventMap.get(t)?.clear():this.eventMap.clear()}emit(t,...r){let n=this.eventMap.get(t);if(n)for(let i of n)i(...r);return this}};var dm='[data-ext-insert="no"]',xt=class extends de{constructor(){super();this.id="";this.selectionEl=null;this.containerEl=null;this.canInsert=!1;this.range=null;this.inSidebar=!1;this.id=Ke()}onCanInsert(r,n){r&&O({__LAST_CAN_INSERT_ID__:this.id}),this.emit("canInsert",{canInsert:r,triggerEl:n})}register(){let r=new AbortController,n=Y(l=>{if(l){if(l.rangeCount>0){let u=l.getRangeAt(0);this.range=u.cloneRange();let c=u.startContainer.childNodes[u.startOffset]||u.startContainer;if(this.selectionEl=c.tagName?c:c.parentElement,!this.selectionEl){this.onCanInsert(this.canInsert=!1,this.containerEl=null);return}if(this.selectionEl.nodeName==="CHATGPT-SIDEBAR")return;let p=null;(hm(this.selectionEl)||(p=gm(this.selectionEl)))&&ym(p||this.selectionEl)&&!bm(p||this.selectionEl)?(this.containerEl=p||this.selectionEl,this.onCanInsert(this.canInsert=!0,this.containerEl)):this.onCanInsert(this.canInsert=!1,this.containerEl=null)}}else this.onCanInsert(this.canInsert=!1,this.containerEl=null)},300,{leading:!0}),i=l=>{let u=l.target;this.inSidebar=u.nodeName==="CHATGPT-SIDEBAR"},a=()=>{this.inSidebar||setTimeout(()=>{n(getSelection())},0)},o=Y(()=>{this.inSidebar||n(getSelection())},300,{leading:!0}),s=Y(l=>{let u=l.target,c=u?u.getRootNode():document;u.nodeName!=="CHATGPT-SIDEBAR"&&n(c?.getSelection?.())},300,{leading:!0});return window.addEventListener("pointerdown",i,{signal:r.signal}),window.addEventListener("pointerup",a,{signal:r.signal}),document.addEventListener("selectionchange",o,{signal:r.signal}),document.addEventListener("click",s,{signal:r.signal}),()=>{r.abort(),this.remvoeAllListeners()}}async checkIsCurrentActive(){let{__LAST_CAN_INSERT_ID__:r}=await oe({__LAST_CAN_INSERT_ID__:""});return!r||this.id===r}async insert(r,n="replace",i="",a=!0){let o=this.containerEl;if(!o||!await this.checkIsCurrentActive())return;let s=document;if(o.getRootNode().nodeName==="#document"&&(s=o.getRootNode()),So(o)){let u=o;u.focus();let c=r;if(n==="insert"&&i&&(c=`${i}${a?`
`:""}${c}`),document.execCommand("insertText",!1,c))return;if(n==="replace")u.setRangeText(r);else{let f=u.selectionEnd;if(f!==null){if(a){let m=u.value[f-1]||"";m&&!/[\n\r\t]/gi.test(m)&&(r=`
`+r)}u.setRangeText(r,f,f,"end"),u.setSelectionRange(f,f+r.length)}}}else{if(o&&o.focus(),this.range){let c=s.getSelection();c?.removeAllRanges(),c?.addRange(this.range)}let u=r;n==="insert"&&i&&(u=`${i}${n==="insert"&&a&&o.textContent&&!ae("notion")?`
`:""}${u}`),_o(u,this.containerEl)}}async select(r,n){let i=this.containerEl;if(!i||!await this.checkIsCurrentActive())return;let a=So(i);if(i&&i.focus(),a){let o=i;o.focus(),o.setSelectionRange(r||0,n||o.value.length,"forward")}else{let o=new Range;o.selectNodeContents(i);let s=getSelection();s?.removeAllRanges(),s?.addRange(o),this.range=o.cloneRange()}}};function So(e){return e&&(e.nodeName==="INPUT"||e.nodeName==="TEXTAREA")}function gm(e){if(!e.isContentEditable){let t=e.parentElement;for(let r=0;r<10&&t;r++)if(t?.isContentEditable){e=t;break}else t=t.parentElement}if(e.isContentEditable){let t=e;for(;t?.parentElement?.isContentEditable;)t=t.parentElement;return t}return null}function hm(e){return(e.nodeName==="INPUT"&&["text","url","search","password"].includes(e.type)||e.nodeName==="TEXTAREA")&&!(e.disabled||e.readOnly)}function ym(e){let t=getComputedStyle(e);return!(t.opacity==="0"||t.display==="none"||t.visibility==="hidden")}function bm(e){return!!e.closest(dm)}var Tt=class extends de{constructor(){super();this.x=0;this.y=0}register(){let r=new AbortController,n=Date.now(),i=ae("gDocs"),a=".docs-texteventtarget-iframe",o=!1,s=!1,l=h=>{o=!0,s=h.target.nodeName==="CHATGPT-SIDEBAR"},u=h=>{if(o=!1,n=Date.now(),s)return;let T=window.top!==window;this.x=T?h.pageX-window.scrollX:h.pageX,this.y=T?h.pageY-window.scrollY:h.pageY,setTimeout(()=>{c()},0)},c=()=>{let h=document.activeElement;if(h?.nodeName==="CHATGPT-SIDEBAR")return;if(h?.tagName==="INPUT"||h?.tagName==="TEXTAREA"){f(h);return}let T=document.getSelection();if(T?.rangeCount){let g=T.getRangeAt(0);if(T.type==="Range"&&!g.collapsed){let v=g.startContainer.childNodes[g.startOffset]||g.startContainer;this.onSelect(T.toString().trim(),g,v.tagName?v:v.parentElement)}else this.onSelect("",null,null)}else this.onSelect("",null,null)},p=Y(h=>{o||s||c()},100),f=h=>{let{selectionStart:T,selectionEnd:g}=h;this.onSelect(h.value.slice(T||0,g||0).trim(),null,h)},m=h=>{if(s)return;let T=h.target;(T.tagName==="INPUT"||T.tagName==="TEXTAREA")&&f(T)};return window.addEventListener("pointerdown",l,{signal:r.signal}),window.addEventListener("pointerup",u,{signal:r.signal}),document.addEventListener("selectionchange",p,{signal:r.signal}),document.addEventListener("select",m,{signal:r.signal}),()=>{r.abort(),this.remvoeAllListeners()}}onSelect(r,n,i){this.emit("select",{text:r,range:n,triggerEl:i,pos:{x:this.x,y:this.y}})}};var ko=V(yn()),Ro=V(q());var it=e=>document.querySelector(e);async function sr(e){let t=await rr();return t?.id?Ro.default.tabs.sendMessage(t.id,{type:"WEB_PARSER_PROXY",action:e}):null}var Me=class{static async parseTitle(){if(window.isInSidepanel)return await sr("parseTitle")||"";let t=document.title;if(ae("youtube")){let r=it("#title.ytd-watch-metadata")?.innerText;r&&(t=r)}else if(ae("bilibili")){let r=it(".video-title")?.innerText;r&&(t=r)}return t}static async parseQuestion(){if(window.isInSidepanel)return await sr("parseQuestion");if(ae("stackoverflow")||ae("stackexchange")){let t=it(".question-hyperlink")?.innerText?.trim(),r=it(".s-prose.js-post-body")?.innerText?.trim();return{question:t,desc:r}}if(ae("quora"))return{question:it(".qu-userSelect--text")?.innerText?.trim()};if(ae("zhihu")){let t=it(".QuestionHeader-title")?.innerText?.trim(),r="",n=document.documentElement.textContent?.match(/"detail":"(.+)","editableDetail"/);if(n&&n[1]){let i=JSON.parse(`["${n[1]}"]`)[0],a=document.createElement("div");a.innerHTML=i,r=a.innerText||""}return{question:t,desc:r}}return{}}static async parseArticle(){return window.isInSidepanel?await sr("parseArticle"):new ko.Readability(document.cloneNode(!0),{charThreshold:500}).parse()}static{this.parseTranscript=me(async()=>{if(window.isInSidepanel)return await sr("parseTranscript");let t=location.href;if(ae("youtube")){let n=(await(await fetch(t)).text())?.split('"captions":')||[];if(n.length<2)return null;let i=JSON.parse(n[1].split(',"videoDetails')[0].replace(`
`,"")).playerCaptionsTracklistRenderer,{captionTracks:a,translationLanguages:o}=i,s=a.reduce((m,h)=>{let T=h.kind==="asr"?h.languageCode+"__asr":h.languageCode,g=T.split("-")[0];return m[T]||(m[T]=h),m[g]||(m[g]=h),m},{}),l=(document.documentElement.lang||"en").split("-");l.length>2&&l.pop();let u=l.join("-"),c=l[0],p=0,f=async m=>{let h="";if(m)try{h=JSON.parse(localStorage["yt-player-caption-sticky-language"]).data||""}catch{}let T=h.split("-")[0],g=(s[h]||s[T]||s[u]||s[c]||a[0])?.baseUrl;if(!g)return null;h&&h!=="zh"&&!(h in s)&&!(T in s)&&(new URL(g).searchParams.get("lang")||"").toLowerCase()!==h.toLowerCase()&&(g=`${g}&tlang=${h}`);let v=await(await fetch(g)).text(),w=[],A=new DOMParser().parseFromString(v,"text/xml").querySelectorAll("text"),d=document.createElement("div");for(let x of A){let b=(x.textContent||"").trim();b&&(d.innerHTML=b,w.push({text:d.innerText,start:""+x.getAttribute("start"),duration:""+x.getAttribute("dur")}))}return p<=2&&w.length<=2?(p++,await bt(1e3),await f(p<2)):w};return await f(!0)}if(ae("bilibili")){let r=location.pathname;r.endsWith("/")&&(r=r.slice(0,-1));let n=r.split("/"),i=n[n.length-1],a=await fetch(`https://api.bilibili.com/x/web-interface/view?bvid=${i}`,{credentials:"include"}).then(m=>m.json()).then(m=>m.data),o=a.aid,s=a.cid,l="";if(a.pages?.length>1){let m=a.pages.reduce((T,g)=>(T[g.page]=g,T),{}),h=new URLSearchParams(location.search).get("p")||1;s=m[h].cid}if(l=(await fetch(`https://api.bilibili.com/x/player/v2?aid=${o}&cid=${s}`,{credentials:"include"}).then(m=>m.json()).then(m=>m.data)).subtitle?.subtitles?.[0]?.subtitle_url,!l)return null;let c=l.replace(/^http:/,"https:"),p=await(await fetch(c)).json(),f=[];for(let m of p.body)f.push({text:m.content,start:""+m.from,duration:""+(m.to-m.from).toFixed(2)});return f}return null},2e3)}};var Jo=V(yn());function wm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e}function vn(e,t){return Array(t+1).join(e)}function Am(e){return e.replace(/^\n*/,"")}function Sm(e){for(var t=e.length;t>0&&e[t-1]===`
`;)t--;return e.substring(0,t)}var Em=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function _n(e){return wn(e,Em)}var Lo=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function Do(e){return wn(e,Lo)}function Im(e){return jo(e,Lo)}var Bo=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function Pm(e){return wn(e,Bo)}function Nm(e){return jo(e,Bo)}function wn(e,t){return t.indexOf(e.nodeName)>=0}function jo(e,t){return e.getElementsByTagName&&t.some(function(r){return e.getElementsByTagName(r).length})}var Q={};Q.paragraph={filter:"p",replacement:function(e){return`

`+e+`

`}};Q.lineBreak={filter:"br",replacement:function(e,t,r){return r.br+`
`}};Q.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,r){var n=Number(t.nodeName.charAt(1));if(r.headingStyle==="setext"&&n<3){var i=vn(n===1?"=":"-",e.length);return`

`+e+`
`+i+`

`}else return`

`+vn("#",n)+" "+e+`

`}};Q.blockquote={filter:"blockquote",replacement:function(e){return e=e.replace(/^\n+|\n+$/g,""),e=e.replace(/^/gm,"> "),`

`+e+`

`}};Q.list={filter:["ul","ol"],replacement:function(e,t){var r=t.parentNode;return r.nodeName==="LI"&&r.lastElementChild===t?`
`+e:`

`+e+`

`}};Q.listItem={filter:"li",replacement:function(e,t,r){e=e.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var n=r.bulletListMarker+"   ",i=t.parentNode;if(i.nodeName==="OL"){var a=i.getAttribute("start"),o=Array.prototype.indexOf.call(i.children,t);n=(a?Number(a)+o:o+1)+".  "}return n+e+(t.nextSibling&&!/\n$/.test(e)?`
`:"")}};Q.indentedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="indented"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,r){return`

    `+t.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};Q.fencedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="fenced"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,r){for(var n=t.firstChild.getAttribute("class")||"",i=(n.match(/language-(\S+)/)||[null,""])[1],a=t.firstChild.textContent,o=r.fence.charAt(0),s=3,l=new RegExp("^"+o+"{3,}","gm"),u;u=l.exec(a);)u[0].length>=s&&(s=u[0].length+1);var c=vn(o,s);return`

`+c+i+`
`+a.replace(/\n$/,"")+`
`+c+`

`}};Q.horizontalRule={filter:"hr",replacement:function(e,t,r){return`

`+r.hr+`

`}};Q.inlineLink={filter:function(e,t){return t.linkStyle==="inlined"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t){var r=t.getAttribute("href"),n=lr(t.getAttribute("title"));return n&&(n=' "'+n+'"'),"["+e+"]("+r+n+")"}};Q.referenceLink={filter:function(e,t){return t.linkStyle==="referenced"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t,r){var n=t.getAttribute("href"),i=lr(t.getAttribute("title"));i&&(i=' "'+i+'"');var a,o;switch(r.linkReferenceStyle){case"collapsed":a="["+e+"][]",o="["+e+"]: "+n+i;break;case"shortcut":a="["+e+"]",o="["+e+"]: "+n+i;break;default:var s=this.references.length+1;a="["+e+"]["+s+"]",o="["+s+"]: "+n+i}return this.references.push(o),a},references:[],append:function(e){var t="";return this.references.length&&(t=`

`+this.references.join(`
`)+`

`,this.references=[]),t}};Q.emphasis={filter:["em","i"],replacement:function(e,t,r){return e.trim()?r.emDelimiter+e+r.emDelimiter:""}};Q.strong={filter:["strong","b"],replacement:function(e,t,r){return e.trim()?r.strongDelimiter+e+r.strongDelimiter:""}};Q.code={filter:function(e){var t=e.previousSibling||e.nextSibling,r=e.parentNode.nodeName==="PRE"&&!t;return e.nodeName==="CODE"&&!r},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",r="`",n=e.match(/`+/gm)||[];n.indexOf(r)!==-1;)r=r+"`";return r+t+e+t+r}};Q.image={filter:"img",replacement:function(e,t){var r=lr(t.getAttribute("alt")),n=t.getAttribute("src")||"",i=lr(t.getAttribute("title")),a=i?' "'+i+'"':"";return n?"!["+r+"]("+n+a+")":""}};function lr(e){return e?e.replace(/(\n+\s*)+/g,`
`):""}function Go(e){this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[];for(var t in e.rules)this.array.push(e.rules[t])}Go.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){if(e.isBlank)return this.blankRule;var t;return(t=bn(this.array,e,this.options))||(t=bn(this._keep,e,this.options))||(t=bn(this._remove,e,this.options))?t:this.defaultRule},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};function bn(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];if(Cm(i,t,r))return i}}function Cm(e,t,r){var n=e.filter;if(typeof n=="string"){if(n===t.nodeName.toLowerCase())return!0}else if(Array.isArray(n)){if(n.indexOf(t.nodeName.toLowerCase())>-1)return!0}else if(typeof n=="function"){if(n.call(e,t,r))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function km(e){var t=e.element,r=e.isBlock,n=e.isVoid,i=e.isPre||function(p){return p.nodeName==="PRE"};if(!(!t.firstChild||i(t))){for(var a=null,o=!1,s=null,l=Oo(s,t,i);l!==t;){if(l.nodeType===3||l.nodeType===4){var u=l.data.replace(/[ \r\n\t]+/g," ");if((!a||/ $/.test(a.data))&&!o&&u[0]===" "&&(u=u.substr(1)),!u){l=xn(l);continue}l.data=u,a=l}else if(l.nodeType===1)r(l)||l.nodeName==="BR"?(a&&(a.data=a.data.replace(/ $/,"")),a=null,o=!1):n(l)||i(l)?(a=null,o=!0):a&&(o=!1);else{l=xn(l);continue}var c=Oo(s,l,i);s=l,l=c}a&&(a.data=a.data.replace(/ $/,""),a.data||xn(a))}}function xn(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function Oo(e,t,r){return e&&e.parentNode===t||r(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}var Uo=typeof window<"u"?window:{};function Rm(){var e=Uo.DOMParser,t=!1;try{new e().parseFromString("","text/html")&&(t=!0)}catch{}return t}function Om(){var e=function(){};return Mm()?e.prototype.parseFromString=function(t){var r=new window.ActiveXObject("htmlfile");return r.designMode="on",r.open(),r.write(t),r.close(),r}:e.prototype.parseFromString=function(t){var r=document.implementation.createHTMLDocument("");return r.open(),r.write(t),r.close(),r},e}function Mm(){var e=!1;try{document.implementation.createHTMLDocument("").open()}catch{window.ActiveXObject&&(e=!0)}return e}var Lm=Rm()?Uo.DOMParser:Om();function Dm(e,t){var r;if(typeof e=="string"){var n=Bm().parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html");r=n.getElementById("turndown-root")}else r=e.cloneNode(!0);return km({element:r,isBlock:_n,isVoid:Do,isPre:t.preformattedCode?jm:null}),r}var Tn;function Bm(){return Tn=Tn||new Lm,Tn}function jm(e){return e.nodeName==="PRE"||e.nodeName==="CODE"}function Gm(e,t){return e.isBlock=_n(e),e.isCode=e.nodeName==="CODE"||e.parentNode.isCode,e.isBlank=Um(e),e.flankingWhitespace=Km(e,t),e}function Um(e){return!Do(e)&&!Pm(e)&&/^\s*$/i.test(e.textContent)&&!Im(e)&&!Nm(e)}function Km(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var r=Fm(e.textContent);return r.leadingAscii&&Mo("left",e,t)&&(r.leading=r.leadingNonAscii),r.trailingAscii&&Mo("right",e,t)&&(r.trailing=r.trailingNonAscii),{leading:r.leading,trailing:r.trailing}}function Fm(e){var t=e.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}function Mo(e,t,r){var n,i,a;return e==="left"?(n=t.previousSibling,i=/ $/):(n=t.nextSibling,i=/^ /),n&&(n.nodeType===3?a=i.test(n.nodeValue):r.preformattedCode&&n.nodeName==="CODE"?a=!1:n.nodeType===1&&!_n(n)&&(a=i.test(n.textContent))),a}var $m=Array.prototype.reduce,Hm=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function ur(e){if(!(this instanceof ur))return new ur(e);var t={rules:Q,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(r,n){return n.isBlock?`

`:""},keepReplacement:function(r,n){return n.isBlock?`

`+n.outerHTML+`

`:n.outerHTML},defaultReplacement:function(r,n){return n.isBlock?`

`+r+`

`:r}};this.options=wm({},t,e),this.rules=new Go(this.options)}ur.prototype={turndown:function(e){if(!zm(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(e==="")return"";var t=Ko.call(this,new Dm(e,this.options));return Vm.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else if(typeof e=="function")e(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return Hm.reduce(function(t,r){return t.replace(r[0],r[1])},e)}};function Ko(e){var t=this;return $m.call(e.childNodes,function(r,n){n=new Gm(n,t.options);var i="";return n.nodeType===3?i=n.isCode?n.nodeValue:t.escape(n.nodeValue):n.nodeType===1&&(i=Wm.call(t,n)),Fo(r,i)},"")}function Vm(e){var t=this;return this.rules.forEach(function(r){typeof r.append=="function"&&(e=Fo(e,r.append(t.options)))}),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function Wm(e){var t=this.rules.forNode(e),r=Ko.call(this,e),n=e.flankingWhitespace;return(n.leading||n.trailing)&&(r=r.trim()),n.leading+t.replacement(r,e,this.options)+n.trailing}function Fo(e,t){var r=Sm(e),n=Am(t),i=Math.max(e.length-r.length,t.length-n.length),a=`

`.substring(0,i);return r+a+n}function zm(e){return e!=null&&(typeof e=="string"||e.nodeType&&(e.nodeType===1||e.nodeType===9||e.nodeType===11))}var cr=ur;var od=V(q());var qm=Object.hasOwn;function fr(e){let t,r,n,i,a,o,s;return l(),{feed:u,reset:l};function l(){t=!0,r="",n=0,i=-1,a=void 0,o=void 0,s=""}function u(p){r=r?r+p:p,t&&Xm(r)&&(r=r.slice($o.length)),t=!1;let f=r.length,m=0,h=!1;for(;m<f;){h&&(r[m]===`
`&&++m,h=!1);let T=-1,g=i,v;for(let w=n;T<0&&w<f;++w)v=r[w],v===":"&&g<0?g=w-m:v==="\r"?(h=!0,T=w-m):v===`
`&&(T=w-m);if(T<0){n=f-m,i=g;break}else n=0,i=-1;c(r,m,g,T),m+=T+1}m===f?r="":m>0&&(r=r.slice(m))}function c(p,f,m,h){if(h===0){s.length>0&&(e({type:"event",id:a,event:o||void 0,data:s.slice(0,-1)}),s="",a=void 0),o=void 0;return}let T=m<0,g=p.slice(f,f+(T?h:m)),v=0;T?v=h:p[f+m+1]===" "?v=m+2:v=m+1;let w=f+v,A=h-v,d=p.slice(w,w+A).toString();if(g==="data")s+=d?"".concat(d,`
`):`
`;else if(g==="event")o=d;else if(g==="id"&&!d.includes("\0"))a=d;else if(g==="retry"){let x=parseInt(d,10);Number.isNaN(x)||e({type:"reconnect-interval",value:x})}}}var $o=[239,187,191];function Xm(e){return $o.every((t,r)=>e.charCodeAt(r)===t)}async function*pr(e){let t=e.getReader();try{for(;;){let{done:r,value:n}=await t.read();if(r)return;yield n}}finally{t.releaseLock()}}var ed=V(q());var _t=V(q());var Ho=V(q());async function vt(){let{generatedRandomId:e}=await oe({generatedRandomId:""});if(!e){let t=await Ym();return t||(t=Ke(),Jm(t)),Ho.default.storage.local.set({generatedRandomId:t}),t}return e}var Vo=se.origin.replace(/\/\/\w+?\./,"//Y2hhdGdwdC1zaWRlYmFy."),Wo="zgv2awnlswq";async function Ym(){try{return await rn({url:Vo,name:Wo})}catch{return""}}async function Jm(e){let t=Math.round(Date.now()/1e3)+31104e3;try{return await oo({url:Vo,name:Wo,value:e,expirationDate:t,secure:!0})}catch{}}var An={609:"error_sider_premium_required",610:"error_sider_high_traffic",1003:"error_sider_need_login",1006:"error_sider_device_bind_account",1101:"error_sider_processing",1102:"error_sider_api_limit",1107:"error_sider_api_limit2",1109:"error_sider_gpt4_highload",1110:"error_sider_gpt_highload",1112:"error_sider_gpt4_limit",1113:"error_sider_gpt4_limit",1118:"error_sider_image_limit",1127:"error_sider_ocr_limit",1128:"error_sider_summary_video_limit",1501:"error_sider_openai_fault",1515:"error_sider_gemini_pro_busy",1129:"error_sider_basic_text_limit",1130:"error_sider_advanced_text_limit",1132:"error_sider_openai_filter",2003:"error_sider_embedding_limit_by_count"};function Sn(e,t){switch(e){case 1102:case 1107:case 1112:case 1113:case 1118:case 1127:case 1128:mr.getVipInfoCached();break;default:break}throw new Error(Qm(e,t))}function Qm(e,t){if(e===1129||e===1130){let r=t.match(/restriction of (.*) messages/),n=t.match(/messages every (.*) minute[s]?\. Alternatively/);return An[e]+"-"+r[1]+"-"+n[1]}return e in An?An[e]:typeof t=="string"&&t.startsWith("504")?"error_sider_timeout":t}async function Zm(e,t,r){return new Promise((n,i)=>{let a=new XMLHttpRequest;a.open(t.method||"GET",e),t.headers instanceof Headers&&t.headers.forEach((o,s)=>{a.setRequestHeader(s,o)}),a.onload=function(){n(new Response(a.responseText,{status:a.status,statusText:a.statusText}))},a.upload.onprogress=function(o){o.lengthComputable&&r&&r?.(o.loaded/o.total*100)},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request timed out"))},a.send(t.body),t.signal&&(t.signal.onabort=function(){a.abort(),i(new DOMException("Aborted","AbortError"))})})}async function dr(e,t=null,r={}){e.startsWith("http")||(e=To(se.api,e));let{onStreamData:n,getAbortMethod:i,noAuth:a,timeout:o,onProgress:s,...l}=r;l.method&&(l.method=l.method.toUpperCase());let u=new AbortController;if(l.signal=u.signal,i?.(()=>{u.abort()}),l.headers=new Headers(l.headers||{}),!a&&!l.headers.has("Authorization")){let m=(await gr()).token;m&&(l.headers.set("Authorization",m),Oe("ERR_MUST_LOGIN"))}if(t)try{t instanceof FormData||t instanceof Blob||t instanceof URLSearchParams||t instanceof ReadableStream||t instanceof ArrayBuffer||t instanceof DataView?l.body=t:(l.body=JSON.stringify(t),l.headers.set("Content-Type","application/json"))}catch{l.body=t}let c;o&&(c=setTimeout(()=>u.abort(),o));let p=s?await Zm(e,l,s):await fetch(e,l);o&&clearTimeout(c);let f=null;if(n||(f=await p.json().catch(()=>({}))),!p.ok||p.status!==204&&f&&f.code!==0){if(f||(f=await p.json().catch(()=>({}))),f.errMsg=f.msg||f.message,Xr(f))f.errMsg=`${p.status} ${p.statusText}`;else{(f.code===1003||f.code===1006)&&O({ERR_MUST_LOGIN:!0});try{Sn(f.code,f.msg||f.message)}catch(m){f.errMsg=m.message}}throw n&&n({data:null,done:!0}),f}if(n&&p.body){let m=fr(h=>{if(h.type==="event"){let T={code:0,data:null,msg:"",errMsg:"",done:h.data==="[DONE]"},g=null;try{g=JSON.parse(h.data)}catch{}if(g&&(T={...T,...g}),T.code!==0){try{Sn(T.code,T.msg)}catch(v){T.errMsg=v.message}throw n({data:null,done:!0}),T}n({data:T.data,done:T.done})}});for await(let h of pr(p.body)){let T=new TextDecoder().decode(h);m.feed(T)}}return f?.data}function $(e,t=null,r={}){return dr(e,t,{method:"GET",...r})}function N(e,t=null,r={}){return dr(e,t,{method:"POST",...r})}function En(e,t=null,r={}){return dr(e,t,{method:"POST",...r})}function zo(e,t=null,r={}){return dr(e,t,{method:"DELETE",...r})}var I=co,F=_e,Z=Intl.DateTimeFormat().resolvedOptions().timeZone,In="ChitChat_Ext",Pn="ChitChat_Ext_UserStatus",mr={async refreshToken(e){let t=await N("/v1/user/token/refresh",{refresh_token:e},{headers:{Authorization:""}});return{token:t.token.token,refreshToken:t.token.refresh_token}},getSiderAnonymousToken:me(async()=>{let e=await vt();return N("/v1/user/login/device_id",{device_id:e,uuid:e,app_name:I,app_version:F},{headers:{Authorization:""}})}),getUserInfo:async()=>{let e=await $(`/v1/user/info?app_name=${I}&app_version=${F}`);return await O({userInfo:e}),e},getVipInfo:qo,getVipInfoCached:me(qo,5e3),async getPricingPlan(){let e=await $("/v1/app/ipinfo",null,{headers:{Authorization:""}}),t=e.region==="CN"||Z==="Asia/Shanghai"&&await J("language","en")==="zh_CN",r=await $(`/v1/payment/pricing?from=web&location=${t?"CN":e.region}`,null,{headers:{Authorization:""}});O({isCNUser:t,pricingPlan:r.plan.map(n=>({name:n.name,displayName:n.display_name,currency:n.currency,interval:n.interval,originPrice:n.origin_price/100,price:n.price/100}))})},getTMPGPT5Info:vo("__GET_TMP_GPT5_INFO_AT__",async()=>{let t=(await $(`/v1/app/config?app_name=${I}&app_version=${F}&tz_name=${Z}`))?.["tmp-gpt5-info"];t&&t.active?(t.mentionName=t.name.replace(/\s+/g,"-"),O({[on]:t})):Oe(on)},1*60*60*1e3),getClientConfig:async e=>{let t=await $(`/v1/app/config?app_name=${I}&app_version=${F}&tz_name=${Z}`);return e?t?.[e]:t},getUserSettings:me(async()=>await Nn()?(await $(`/v1/user/settings?app_name=${I}&keys=${In}`)).keys?.[In]:{},2e3),setUserSettings(e){if(!(!e||Object.keys(e).length===0))return Ue(()=>N("/v1/user/settings",{app_name:I,key:In,key_setting:e}))},getUserStatus:me(async()=>{let t=(await $(`/v1/user/settings?app_name=${I}&keys=${Pn}`)).keys?.[Pn];return t&&Object.keys(t).length&&await O({userStatus:t}),t},2e3),async setUserStatus(e){if(!e||Object.keys(e).length===0)return;await Ue(()=>N("/v1/user/settings",{app_name:I,key:Pn,key_setting:e}));let{userStatus:t}=await J({userStatus:{}});O({userStatus:{...t||{},...e}})},getUserPromptList(e){return $(`/v1/prompt/list?type=${e}&page_size=999`)},getAllPromptList:Y(async()=>{let e=await J({language:"",chatVisiblePromptKeys:null,readVisiblePromptKeys:null,writeVisiblePromptKeys:null,sidebarPromptTemplate:null}),t=e.language;if(!t)return;let r={};try{r=await mr.getUserSettings()}catch{}let[n,i]=await Promise.all([$(`/v1/prompt/list_all?app_name=${I}&page_size=999&language=${t}`,null,{headers:{Authorization:(await at())?.token||""}}),$(`/v1/prompt/list?type=special&app_name=${I}&page_size=999&language=${t}`,null,{headers:{Authorization:(await at())?.token||""}})]),a=n.List;a.sort((g,v)=>(g.sort!==0||g.key==="improve_writing")&&(v.sort!==0||v.key==="improve_writing")?v.sort-g.sort:v.sort===0?1:g.sort===0?-1:0);let o=a.reduce((g,v)=>(g[v.key||v.id]=v,g),{});function s(g){return{id:String(g.id),key:String(g.key||g.id),isCustom:!g.key||g.key.startsWith("custom"),name:g.display_name||g.name,shortName:g.short_name,content:g.content,icon:g.icon,placeholder:g.placeholder,usedIn:g.use||void 0,children:g.has_child?[]:void 0,parentKey:g.parent_key}}let l=[],u={};for(let g of a){let{key:v,has_child:w,parent_key:A}=g;if(w){if(!(v in u)){let x=s(g);u[v]=x,l.push(x)}continue}if(A){let x=o[A];if(!x)continue;if(!(A in u)){let b=s(x);u[A]=b,l.push(b)}u[A]?.children?.push(s(g));continue}let d=s(g);l.push(d)}if(e.sidebarPromptTemplate)for(let g of e.sidebarPromptTemplate)!g.uid&&g.key?.startsWith("custom")&&l.unshift({id:"",key:g.key,isCustom:!0,name:g.title,content:g.template});function c(g,v=!1){let w=[];for(let A of l){let{usedIn:d}=A;(!d||d.includes(g))&&(!v||A.isCustom)&&w.push(A.key)}return w}let p=new Set(l.map(({key:g})=>g)),f=n.Sort,m={chat:["chatVisiblePromptKeys","ChatAsk"],read:["readVisiblePromptKeys","ReadingAssistant"],write:["writeVisiblePromptKeys","WritingAssistant"]},h={};for(let[g,[v,w]]of Object.entries(m)){let A=e[v];A?h[v]=fn([...A.filter(x=>p.has(x)),...c(g)]):h[v]=fn([...c(g,!0),...f[w].split(",").map(x=>x.trim()),...c(g)]);let d=r?.[v];if(d?.length){let x=d.reduce((b,_,E)=>(b[_]=E,b),{});h[v].sort((b,_)=>{let E=x[b],M=x[_],L=typeof E>"u",S=typeof M>"u";return L&&S?0:L?1:S?-1:E-M})}}let T=i.List.map(g=>s(g));await O({...h,allPromptList:l,specialPromptList:T,__DONT_SYNC__:`visiblePromptKeys${Date.now()}`})},1e3),createPrompt(e){return Ue(()=>N("/v1/prompt/create",{is_template:!1,type:"sidebar",...e}))},createUserPrompt(e){return Ue(()=>N("/v1/prompt/create",{is_template:!1,...e}))},editUserPrompt(e){return Ue(()=>N("/v1/prompt/edit",e))},delUserPrompt(e){return Ue(()=>N("/v1/prompt/update",{id:e,status:"Deleted"}))},async uploadHistoryMsg(e){return(await N("/v1/conversation/upload",{app_name:I,app_version:F,messages:e})).cid},uploadConversion(e){return N("/v1/conversation/upload",{share:!0,app_name:I,app_version:F,messages:e})},saveConversion(e){return N("/v1/conversation/upload",{save_by_user:!0,app_name:I,app_version:F,messages:e})},async shareConversion(e){return(await $(`/v1/conversation/share/${e}`)).share_key},saveSiderConversion(e){return $(`/v1/conversation/save-by-user/${e}`)},unSaveSiderConversion(e){return $(`/v1/conversation/unsave-by-user/${e}`)},delConversion(e){return zo(`/v1/conversation/delete/${e}`)},checkGrammarError(e){return N("/v1/completion/grammar_check",{content:e,tz_name:Z,app_name:I,app_version:F})},async improveWriting(e){function t(n){if(n?.total){let i={[e.model]:{total:n.total,remain:n.remain,extraTotal:n.extra_total,extraRemain:n.extra_quota,period:n.remain_period}};ge(i)}}let r=Y(t,1e3,{leading:!0});return N("/v1/completion/improve_writing",{content:e.content,model:e.model==="gpt-4"?e.model:"gpt3.5",tz_name:Z,app_name:I,app_version:F},{onStreamData({data:n,done:i}){!i&&n&&r(n),e.onStreamData({text:n?.text||"",done:i})},getAbortMethod(n){}})},async sendFeedback({title:e,detail:t,email:r}){let n=await at();return N("/v1/app/feedback",{title:e,email:r,data:{detail:t},app_name:I,app_version:F},{headers:{Authorization:n?.token||""}})},async sendFiveStarFeedback(e,t){let r=await at(),n=await J("language","en"),i=`[FiveStarRate][${_e}][${n}] Feedback by FiveStarRate`;return N("/v1/app/feedback",{title:i,data:{from:t,detail:e},app_name:I,app_version:F},{headers:{Authorization:r?.token||""}})},async getInviteRewardConfig(){let e=await $("/v1/invite/config",null,{headers:{Authorization:""}});return O({inviteRewardConfig:{"gpt3.5":e.GPT3Dot5Count,gpt4:e.GPT4Count}}),e},createInviteLink(){return N("/v1/invite/create",{type:"link"})},async getInviteRewardCount(e){let t=await $(`/v1/invite/reward?app_name=${I}&app_version=${F}&last_req_time=${e}`);return{addedQuery:t.recent_reward_gpt3dot5_count+t.recent_reward_gpt4_count,addedUser:t.recent_invited_count}},inviteFinish:async()=>{let e=await vt();return N("/v1/invite/finish",{device_id:e})},async summaryVideo(e){function t(m){if(m?.total)if(e.vip){let h={"gpt-3.5":{total:m.total,remain:m.remain,extraTotal:m.extra_total,extraRemain:m.extra_quota,period:m.remain_period}};ge(h)}else{let h={summary:{remain:m.remain}};ge(h)}}let r=Y(t,1e3,{leading:!0}),n={app_name:I,app_version:F,tz_name:Z,content:e.text,title:e.title,language:e.lang,source:e.source,source_type:e.sourceType,request_id:Ke(),cid:""},i=[];e.getAbortMethod(()=>{for(let m of i)m()});let{content:a,cid:o,...s}=n,l=null;try{l=await N("/v1/completion/summarize_init",s,{getAbortMethod(m){i.push(m)}})}catch{}l&&(n.cid=l.cid||"");let u=N("/v1/completion/summarize_all",n,{onStreamData({data:m,done:h}){!h&&m&&r(m),e.onStreamData({text:m?.text||"",done:h})},getAbortMethod(m){i.push(m)}}),c=N("/v1/completion/summarize",n,{getAbortMethod(m){i.push(m)}}),[p,f]=await Promise.all([u,c]);return t(f),{text:f.text,subtitle:f.subtitle}},async summaryVideoByEid(e){function t(a){if(a?.total)if(e.vip){let o={[a.chat_model]:{total:a.total,remain:a.remain,extraTotal:a.extra_total,extraRemain:a.extra_quota,period:a.remain_period}};ge(o)}else{let o={summary:{remain:a.remain}};ge(o)}}let r=Y(t,1e3,{leading:!0}),n={app_name:I,app_version:F,tz_name:Z,eid:e.eid,language:e.language},i=await N("/v1/completion/video_summarize",n,{onStreamData({data:a,done:o}){!o&&a?(r(a),a.type==="text"?e.onStreamTextData({text:a.text,done:o}):a.type==="text_done"?e.onStreamTextData({text:a.text,done:!0}):e.onKey_momentsData(a.key_moments)):e.onStreamTextData({text:"",done:o})},getAbortMethod:a=>{e.getAbortMethod&&e.getAbortMethod(()=>{a()})}})},async getSummaryCache(e){let{is_creator:t,eid:r,summary:n,key_moments:i,language:a}=await N("/v1/completion/video_info",{source:e.source,source_type:e.source_type,title:e.title,app_name:I,app_version:F,tz_name:Z,language:e.language});return{is_creator:t,eid:r,summary:n,key_moments:i,language:a}},statUserStop(e,t){return N("/v1/completion/mark-user-stop",{app_name:I,app_version:F,cid:e,mid:t})},async OCR(e,t){let r=new FormData;r.append("file",e),r.append("app_name",I),r.append("app_version",F),r.append("tz_name",Z);let n=await N("/v1/ocr/math",r,{getAbortMethod:t});if(n?.limit){let a={"image-creator":{total:n.limit.total,remain:n.limit.remain,extraTotal:n.limit.extra_total,extraRemain:n.limit.extra_quota,period:n.limit.remain_period}};ge(a)}return n?.result?.text||""},adStat(e){return N("/v1/lp/action",{...e,meta:{browser:ln?"Edge":"Chrome",ext_version:_e}},{headers:{}})},async googleAnalytics(e,t){return _t.default.tabs?N(`${fo}?measurement_id=${po}&api_secret=${mo}`,{client_id:await vt(),events:[{name:e.replace(/-/gi,"_"),params:{...t}}]},{headers:{Authorization:""}}):_t.default.runtime.sendMessage({type:"GA_API",args:[e,t]})},uploadImage(e){let t=new FormData;return t.append("file",e),En("/v1/imagechat/upload",t,{onProgress:r=>{}})},signImageCookie(){return N("/v1/image/sign-cookie")},uploadFile(e,t,r,n,i){let a=new FormData;return a.append("file",e),a.append("app_name",I),a.append("app_version",F),a.append("tz_name",Z),r&&a.append("webpage_url",r),n&&a.append("file_for",n),En("/v1/embedding/upload-file",a,{onProgress:t,getAbortMethod:o=>{i&&i(()=>{o()})}}).then(o=>{let s=o.limit;return ge({reader:{total:s.count,remain:s.remain,limitSize:s.size,period:s.period,used:s.used}}),o})},getFileStauts(e){return $(`/v1/embedding/status?id=${e}`)},async getPromotionCountdown(){let e=await $(`/v1/user/promotion/promotion_info?app_name=${I}&app_version=${F}&tz_name=${Z}`);return{countdownStartAt:e.countdown_start*1e3,countdownStopAt:e.countdown_stop*1e3,countdownRemain:e.countdown_remain*1e3}}};async function qo(){let e=await $(`/v1/completion/limit?app_name=${I}&app_version=${F}&tz_name=${Z}`);if(!e.chat.count)throw O({ERR_MUST_LOGIN:!0}),new Error("wrong_data");let t=e.user_type,r=["device","login","premium"],n=e.chat_period_info,i=e.gpt_4_chat_period_info,a={isVIP:e.user_type==="premium",userTypeDetail:e.user_type_detail,resetTimeSec:e.chat.reset_time,showNewPlan:!!e.show_new_plan,"gpt-3.5":{total:e.chat.count,remain:e.chat.remain,extraTotal:e.chat.extra_total,extraRemain:e.chat.extra_quota,used:e.chat.used,period:e.chat.period,maxToken:n[t]?.prompt_max_token,award:r.reduce((o,s)=>(o[s]={count:n[s].count},o),{})},"gpt-4":{total:e.gpt_4_chat.count,remain:e.gpt_4_chat.remain,extraTotal:e.gpt_4_chat.extra_total,extraRemain:e.gpt_4_chat.extra_quota,used:e.gpt_4_chat.used,period:e.gpt_4_chat.period,maxToken:i[t]?.prompt_max_token,award:r.reduce((o,s)=>(o[s]={count:i[s].count},o),{})},summary:{total:e.summarize.count,remain:e.summarize.remain,cost:e.summarize.deduct_count,period:e.summarize.period},ocr:{cost:e.ocr_period_info.deduct_count},"image-creator":{total:e.image.count,remain:e.image.remain,used:e.image.used,extraTotal:e.image.extra_total,extraRemain:e.image.extra_quota,period:e.image.period},reader:{total:e.embedding.count,remain:e.embedding.remain,used:e.embedding.used,period:e.embedding.period,limitSize:e.embedding.size}};if(ge(a),a.isVIP){let{autoTools:o,isDoneAutoToolsAction:s}=await _t.default.storage.local.get(["autoTools","isDoneAutoToolsAction"]);typeof o>"u"&&!s&&O({autoTools:xo,isDoneAutoToolsAction:!0})}else{let{autoTools:o}=await _t.default.storage.local.get("autoTools");typeof o<"u"&&O({autoTools:[]})}return a}async function Nn(){let e=await hr("userinfo-type"),t=await hr("token");if(e===null)return null;let r=!!(t&&e&&e!=="device");return O({logged:r}),r}async function td(){let{vipInfo:e}=await oe({vipInfo:{isVIP:!1,userTypeDetail:"login",resetTimeSec:0,"gpt-3.5":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},"gpt-4":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},"image-creator":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},summary:{total:0,remain:0,cost:3,period:"total"},ocr:{cost:1},reader:{total:0,remain:0,used:0,limitSize:104857600,period:"total"}}});return e}async function ge(e){let t=await td();return qr(t,e,(r,n)=>{if(Array.isArray(r))return n}),O({vipInfo:t})}async function gr(){let e=await at();return e?{...e,anonymous:!1}:{token:"",refreshToken:"",anonymous:!1}}async function at(){if(await Nn()){let e=await hr("token"),t=await hr("refresh_token");return e?{token:e,refreshToken:t}:null}return null}async function hr(e){try{let t=await so(e);if(!t)throw new Error("");return O({[e]:t}),t}catch{return(await oe({[e]:""}))[e]}}async function Xo(e,t,r={},n={}){let i=r.signal;if(i?.aborted)throw new DOMException("Aborted","AbortError");let a=new AbortController,o=id(e)??new URL(`${se.api}${e}`),s=nd(r.body??t),l=new Headers(r.headers),u=(r.method??"GET").toUpperCase(),c=u==="GET"||u==="HEAD";l.has("Content-Type")||l.set("Content-Type","application/json");let{noAuth:p=!1,timeout:f,noAppInfo:m=!1}=n;if(!p&&!l.has("Authorization")){let A;try{A=(await gr()).token}catch(d){throw d instanceof Error?d:rd(d)&&d.msg?new Error(d.msg,{cause:d}):new Error("Failed to get token")}A&&l.set("Authorization",A)}let h;if(i&&i.addEventListener("abort",h=A=>{let d=A.target.reason;d instanceof DOMException?a.abort(d):a.abort()},{once:!0}),s instanceof FormData&&l.delete("Content-Type"),!m)if(c){let A=o.searchParams;A.has("app_name")||A.append("app_name",I),A.has("tz_name")||A.append("tz_name",Z),A.has("app_version")||A.append("app_version",_e)}else s instanceof FormData?(s.has("app_name")||s.append("app_name",I),s.has("tz_name")||s.append("tz_name",Z),s.has("app_version")||s.append("app_version",_e)):Ze(s)&&(Object.hasOwn(s,"app_name")||(s.app_name=I),Object.hasOwn(s,"tz_name")||(s.tz_name=Z),Object.hasOwn(s,"app_version")||(s.app_version=_e));let T=Object.assign({},r,{signal:a.signal,headers:l,method:u,body:c?void 0:l.get("Content-Type")==="application/json"?JSON.stringify(s):s}),g;f&&(g=setTimeout(()=>a.abort(new DOMException("signal time out","TimeoutError")),f));let v=await fetch(o,T).finally(()=>{clearTimeout(g),i&&i.removeEventListener("abort",h)});if(n.onStream&&v.body&&v.ok){let A=n.onStream,d=fr(x=>{if(x.type!=="event")return;let b=x.data==="[DONE]";if(b){A({done:b});return}let _=JSON.parse(x.data);if(_.code!==0)throw new Error(_.msg,{cause:_});A({data:_.data})});for await(let x of pr(v.body)){let b=new TextDecoder().decode(x);d.feed(b)}return{}}let w=await v.json().catch(()=>{});if(!v.ok)throw new Error(`${v.status}: ${w?.msg||v.statusText}`,{cause:w});if(!w)throw new Error("Response body is not json");if(w.code!==0)throw(w.code===1003||w.code===1006)&&O({ERR_MUST_LOGIN:!0}),new Error(w.msg,{cause:w});return Oe("ERR_MUST_LOGIN"),w.data}function rd(e){return Ze(e)&&Object.hasOwn(e,"code")&&Object.hasOwn(e,"data")&&Object.hasOwn(e,"msg")&&typeof e.code=="number"}function nd(e){if(e instanceof FormData){let t=new FormData;for(let[r,n]of e.entries())t.append(r,n);return t}else return zr(e)}function id(e,t){try{return new URL(e,t)}catch{return null}}async function Yo(e){let t=new URLSearchParams(e);return(await Xo(`/v1/search/suggestions?${t}`,void 0,{method:"GET"})).suggestions}async function Cn(){let e=document.querySelector.bind(document);if(location.protocol==="file:")throw new Error("Cannot get search suggestions in local file");let t=document.title||e('meta[property="og:title"]')?.getAttribute("content")||"",r=e('meta[name="keywords"]')?.getAttribute("content")||"",n=(e('meta[name="description"]')||e('meta[property="og:description"]'))?.getAttribute("content")||"";if(!t&&!r&&!n)throw new Error("No title, keywords or description");let i="";try{let l=new Jo.Readability(document.cloneNode(!0)).parse();if(!l)throw new Error("No article");i=new cr().turndown(l.content.trim()).slice(0,200)}catch{i=wo(document.body.innerText?.slice(0,400)||"").slice(0,200)}let[a,o]=await Promise.all([J("language",void 0),Zr("detect-language",void 0)]);return(await Yo({title:t,keywords:r,description:n,host:location.host,lang:a,content:i,page_lang:o==="und"?"":o})).map(l=>l.trim()).filter(Boolean)}function kn(e,t){return!(e.key!==t.key||(e.metaKey!==t.metaKey||e.ctrlKey!==t.ctrlKey)&&!e.metaKey&&!e.ctrlKey||e.shiftKey!==!!t.shiftKey||e.altKey!==!!t.altKey||e.target?.dataset.preventsidershortcut)}var Qo=V(q());async function Zo(){if(window.isInSidepanel){let i=await rr();return i?.id?Qo.default.tabs.sendMessage(i.id,{type:"get-readability-text"}):null}let e=document.body.querySelector('embed[type="application/pdf"]');if(e&&e.getAttribute("width")==="100%"&&e.getAttribute("height")==="100%"&&e.getAttribute("internalid"))return{type:"pdf",title:window.location.href,canSummarize:!0,pdfUrl:window.location.href};let t=window.location.href,r=t.startsWith("https://www.youtube.com/watch")?"youtube":t.startsWith("https://www.bilibili.com/video")?"bilibili":null;if(r){let i=await Me.parseTranscript();return{type:"video",title:document.title,url:t,sourceType:r,subTitle:i,canSummarize:!!i}}let n=await Me.parseArticle();if(n){let a=new cr().turndown(n.content.trim());return{type:"webpage",title:document.title,url:window.location.href,text:a,canSummarize:a.length>500,lang:n.lang}}else return null}var sd=V(q());function es(e,t){if(window.location.href===t){let r=document.querySelector("video");r&&(r.currentTime=e)}}var ld={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]}},On=class e{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,r)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=r.prefix||"i18next:",this.logger=t||ld,this.options=r,this.debug=r.debug}log(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"log","",!0)}warn(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"warn","",!0)}error(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"error","")}deprecate(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,n,i){return i&&!this.debug?null:(typeof t[0]=="string"&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new e(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new e(this.logger,t)}},he=new On,lt=class{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(n=>{this.observers[n]=this.observers[n]||[],this.observers[n].push(r)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t]=this.observers[t].filter(n=>n!==r)}}emit(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.observers[t]&&[].concat(this.observers[t]).forEach(o=>{o(...n)}),this.observers["*"]&&[].concat(this.observers["*"]).forEach(o=>{o.apply(o,[t,...n])})}};function wt(){let e,t,r=new Promise((n,i)=>{e=n,t=i});return r.resolve=e,r.reject=t,r}function ts(e){return e==null?"":""+e}function ud(e,t,r){e.forEach(n=>{t[n]&&(r[n]=t[n])})}function jn(e,t,r){function n(o){return o&&o.indexOf("###")>-1?o.replace(/###/g,"."):o}function i(){return!e||typeof e=="string"}let a=typeof t!="string"?[].concat(t):t.split(".");for(;a.length>1;){if(i())return{};let o=n(a.shift());!e[o]&&r&&(e[o]=new r),Object.prototype.hasOwnProperty.call(e,o)?e=e[o]:e={}}return i()?{}:{obj:e,k:n(a.shift())}}function rs(e,t,r){let{obj:n,k:i}=jn(e,t,Object);n[i]=r}function cd(e,t,r,n){let{obj:i,k:a}=jn(e,t,Object);i[a]=i[a]||[],n&&(i[a]=i[a].concat(r)),n||i[a].push(r)}function br(e,t){let{obj:r,k:n}=jn(e,t);if(r)return r[n]}function fd(e,t,r){let n=br(e,r);return n!==void 0?n:br(t,r)}function ls(e,t,r){for(let n in t)n!=="__proto__"&&n!=="constructor"&&(n in e?typeof e[n]=="string"||e[n]instanceof String||typeof t[n]=="string"||t[n]instanceof String?r&&(e[n]=t[n]):ls(e[n],t[n],r):e[n]=t[n]);return e}function ot(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var pd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function md(e){return typeof e=="string"?e.replace(/[&<>"'\/]/g,t=>pd[t]):e}var dd=[" ",",","?","!",";"];function gd(e,t,r){t=t||"",r=r||"";let n=dd.filter(o=>t.indexOf(o)<0&&r.indexOf(o)<0);if(n.length===0)return!0;let i=new RegExp(`(${n.map(o=>o==="?"?"\\?":o).join("|")})`),a=!i.test(e);if(!a){let o=e.indexOf(r);o>0&&!i.test(e.substring(0,o))&&(a=!0)}return a}function xr(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!e)return;if(e[t])return e[t];let n=t.split(r),i=e;for(let a=0;a<n.length;++a){if(!i||typeof i[n[a]]=="string"&&a+1<n.length)return;if(i[n[a]]===void 0){let o=2,s=n.slice(a,a+o).join(r),l=i[s];for(;l===void 0&&n.length>a+o;)o++,s=n.slice(a,a+o).join(r),l=i[s];if(l===void 0)return;if(l===null)return null;if(t.endsWith(s)){if(typeof l=="string")return l;if(s&&typeof l[s]=="string")return l[s]}let u=n.slice(a+o).join(r);return u?xr(l,u,r):void 0}i=i[n[a]]}return i}function Tr(e){return e&&e.indexOf("_")>0?e.replace("_","-"):e}var vr=class extends lt{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){let r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,o=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure,s=[t,r];n&&typeof n!="string"&&(s=s.concat(n)),n&&typeof n=="string"&&(s=s.concat(a?n.split(a):n)),t.indexOf(".")>-1&&(s=t.split("."));let l=br(this.data,s);return l||!o||typeof n!="string"?l:xr(this.data&&this.data[t]&&this.data[t][r],n,a)}addResource(t,r,n,i){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},o=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,s=[t,r];n&&(s=s.concat(o?n.split(o):n)),t.indexOf(".")>-1&&(s=t.split("."),i=r,r=s[1]),this.addNamespaces(r),rs(this.data,s,i),a.silent||this.emit("added",t,r,n,i)}addResources(t,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(let a in n)(typeof n[a]=="string"||Object.prototype.toString.apply(n[a])==="[object Array]")&&this.addResource(t,r,a,n[a],{silent:!0});i.silent||this.emit("added",t,r,n)}addResourceBundle(t,r,n,i,a){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},s=[t,r];t.indexOf(".")>-1&&(s=t.split("."),i=n,n=r,r=s[1]),this.addNamespaces(r);let l=br(this.data,s)||{};i?ls(l,n,a):l={...l,...n},rs(this.data,s,l),o.silent||this.emit("added",t,r,n)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(t,r)}:this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){let r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(i=>r[i]&&Object.keys(r[i]).length>0)}toJSON(){return this.data}},us={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,n,i){return e.forEach(a=>{this.processors[a]&&(t=this.processors[a].process(t,r,n,i))}),t}},ns={},_r=class e extends lt{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),ud(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=he.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;let n=this.resolve(t,r);return n&&n.res!==void 0}extractFromKey(t,r){let n=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");let i=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,a=r.ns||this.options.defaultNS||[],o=n&&t.indexOf(n)>-1,s=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!gd(t,n,i);if(o&&!s){let l=t.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:t,namespaces:a};let u=t.split(n);(n!==i||n===i&&this.options.ns.indexOf(u[0])>-1)&&(a=u.shift()),t=u.join(i)}return typeof a=="string"&&(a=[a]),{key:t,namespaces:a}}translate(t,r,n){if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);let i=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:o,namespaces:s}=this.extractFromKey(t[t.length-1],r),l=s[s.length-1],u=r.lng||this.language,c=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(c){let d=r.nsSeparator||this.options.nsSeparator;return i?{res:`${l}${d}${o}`,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(r)}:`${l}${d}${o}`}return i?{res:o,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(r)}:o}let p=this.resolve(t,r),f=p&&p.res,m=p&&p.usedKey||o,h=p&&p.exactUsedKey||o,T=Object.prototype.toString.apply(f),g=["[object Number]","[object Function]","[object RegExp]"],v=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,w=!this.i18nFormat||this.i18nFormat.handleAsObject;if(w&&f&&(typeof f!="string"&&typeof f!="boolean"&&typeof f!="number")&&g.indexOf(T)<0&&!(typeof v=="string"&&T==="[object Array]")){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let d=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,f,{...r,ns:s}):`key '${o} (${this.language})' returned an object instead of string.`;return i?(p.res=d,p.usedParams=this.getUsedParamsDetails(r),p):d}if(a){let d=T==="[object Array]",x=d?[]:{},b=d?h:m;for(let _ in f)if(Object.prototype.hasOwnProperty.call(f,_)){let E=`${b}${a}${_}`;x[_]=this.translate(E,{...r,joinArrays:!1,ns:s}),x[_]===E&&(x[_]=f[_])}f=x}}else if(w&&typeof v=="string"&&T==="[object Array]")f=f.join(v),f&&(f=this.extendTranslation(f,t,r,n));else{let d=!1,x=!1,b=r.count!==void 0&&typeof r.count!="string",_=e.hasDefaultValue(r),E=b?this.pluralResolver.getSuffix(u,r.count,r):"",M=r.ordinal&&b?this.pluralResolver.getSuffix(u,r.count,{ordinal:!1}):"",L=r[`defaultValue${E}`]||r[`defaultValue${M}`]||r.defaultValue;!this.isValidLookup(f)&&_&&(d=!0,f=L),this.isValidLookup(f)||(x=!0,f=o);let H=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&x?void 0:f,k=_&&L!==f&&this.options.updateMissing;if(x||d||k){if(this.logger.log(k?"updateKey":"missingKey",u,l,o,k?L:f),a){let G=this.resolve(o,{...r,keySeparator:!1});G&&G.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ee=[],C=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&C&&C[0])for(let G=0;G<C.length;G++)ee.push(C[G]);else this.options.saveMissingTo==="all"?ee=this.languageUtils.toResolveHierarchy(r.lng||this.language):ee.push(r.lng||this.language);let re=(G,le,ut)=>{let U=_&&ut!==f?ut:H;this.options.missingKeyHandler?this.options.missingKeyHandler(G,l,le,U,k,r):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(G,l,le,U,k,r),this.emit("missingKey",G,l,le,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&b?ee.forEach(G=>{this.pluralResolver.getSuffixes(G,r).forEach(le=>{re([G],o+le,r[`defaultValue${le}`]||L)})}):re(ee,o,L))}f=this.extendTranslation(f,t,r,p,n),x&&f===o&&this.options.appendNamespaceToMissingKey&&(f=`${l}:${o}`),(x||d)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?f=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${o}`:o,d?f:void 0):f=this.options.parseMissingKeyHandler(f))}return i?(p.res=f,p.usedParams=this.getUsedParamsDetails(r),p):f}extendTranslation(t,r,n,i,a){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});let u=typeof t=="string"&&(n&&n.interpolation&&n.interpolation.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),c;if(u){let f=t.match(this.interpolator.nestingRegexp);c=f&&f.length}let p=n.replace&&typeof n.replace!="string"?n.replace:n;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),t=this.interpolator.interpolate(t,p,n.lng||this.language,n),u){let f=t.match(this.interpolator.nestingRegexp),m=f&&f.length;c<m&&(n.nest=!1)}!n.lng&&this.options.compatibilityAPI!=="v1"&&i&&i.res&&(n.lng=i.usedLng),n.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var f=arguments.length,m=new Array(f),h=0;h<f;h++)m[h]=arguments[h];return a&&a[0]===m[0]&&!n.context?(o.logger.warn(`It seems you are nesting recursively key: ${m[0]} in key: ${r[0]}`),null):o.translate(...m,r)},n)),n.interpolation&&this.interpolator.reset()}let s=n.postProcess||this.options.postProcess,l=typeof s=="string"?[s]:s;return t!=null&&l&&l.length&&n.applyPostProcessor!==!1&&(t=us.handle(l,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,i,a,o,s;return typeof t=="string"&&(t=[t]),t.forEach(l=>{if(this.isValidLookup(n))return;let u=this.extractFromKey(l,r),c=u.key;i=c;let p=u.namespaces;this.options.fallbackNS&&(p=p.concat(this.options.fallbackNS));let f=r.count!==void 0&&typeof r.count!="string",m=f&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),h=r.context!==void 0&&(typeof r.context=="string"||typeof r.context=="number")&&r.context!=="",T=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);p.forEach(g=>{this.isValidLookup(n)||(s=g,!ns[`${T[0]}-${g}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(s)&&(ns[`${T[0]}-${g}`]=!0,this.logger.warn(`key "${i}" for languages "${T.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),T.forEach(v=>{if(this.isValidLookup(n))return;o=v;let w=[c];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(w,c,v,g,r);else{let d;f&&(d=this.pluralResolver.getSuffix(v,r.count,r));let x=`${this.options.pluralSeparator}zero`,b=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(f&&(w.push(c+d),r.ordinal&&d.indexOf(b)===0&&w.push(c+d.replace(b,this.options.pluralSeparator)),m&&w.push(c+x)),h){let _=`${c}${this.options.contextSeparator}${r.context}`;w.push(_),f&&(w.push(_+d),r.ordinal&&d.indexOf(b)===0&&w.push(_+d.replace(b,this.options.pluralSeparator)),m&&w.push(_+x))}}let A;for(;A=w.pop();)this.isValidLookup(n)||(a=A,n=this.getResource(v,g,A,r))}))})}),{res:n,usedKey:i,exactUsedKey:a,usedLng:o,usedNS:s}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,r,n,i):this.resourceStore.getResource(t,r,n,i)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=t.replace&&typeof t.replace!="string",i=n?t.replace:t;if(n&&typeof t.count<"u"&&(i.count=t.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!n){i={...i};for(let a of r)delete i[a]}return i}static hasDefaultValue(t){let r="defaultValue";for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&r===n.substring(0,r.length)&&t[n]!==void 0)return!0;return!1}};function Rn(e){return e.charAt(0).toUpperCase()+e.slice(1)}var wr=class{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=he.create("languageUtils")}getScriptPartFromCode(t){if(t=Tr(t),!t||t.indexOf("-")<0)return null;let r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=Tr(t),!t||t.indexOf("-")<0)return t;let r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(typeof t=="string"&&t.indexOf("-")>-1){let r=["hans","hant","latn","cyrl","cans","mong","arab"],n=t.split("-");return this.options.lowerCaseLng?n=n.map(i=>i.toLowerCase()):n.length===2?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),r.indexOf(n[1].toLowerCase())>-1&&(n[1]=Rn(n[1].toLowerCase()))):n.length===3&&(n[0]=n[0].toLowerCase(),n[1].length===2&&(n[1]=n[1].toUpperCase()),n[0]!=="sgn"&&n[2].length===2&&(n[2]=n[2].toUpperCase()),r.indexOf(n[1].toLowerCase())>-1&&(n[1]=Rn(n[1].toLowerCase())),r.indexOf(n[2].toLowerCase())>-1&&(n[2]=Rn(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(n=>{if(r)return;let i=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(i))&&(r=i)}),!r&&this.options.supportedLngs&&t.forEach(n=>{if(r)return;let i=this.getLanguagePartFromCode(n);if(this.isSupportedCode(i))return r=i;r=this.options.supportedLngs.find(a=>{if(a===i)return a;if(!(a.indexOf("-")<0&&i.indexOf("-")<0)&&a.indexOf(i)===0)return a})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),typeof t=="string"&&(t=[t]),Object.prototype.toString.apply(t)==="[object Array]")return t;if(!r)return t.default||[];let n=t[r];return n||(n=t[this.getScriptPartFromCode(r)]),n||(n=t[this.formatLanguageCode(r)]),n||(n=t[this.getLanguagePartFromCode(r)]),n||(n=t.default),n||[]}toResolveHierarchy(t,r){let n=this.getFallbackCodes(r||this.options.fallbackLng||[],t),i=[],a=o=>{o&&(this.isSupportedCode(o)?i.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return typeof t=="string"&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&a(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&a(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&a(this.getLanguagePartFromCode(t))):typeof t=="string"&&a(this.formatLanguageCode(t)),n.forEach(o=>{i.indexOf(o)<0&&a(this.formatLanguageCode(o))}),i}},hd=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],yd={1:function(e){return+(e>1)},2:function(e){return+(e!=1)},3:function(e){return 0},4:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},5:function(e){return e==0?0:e==1?1:e==2?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},6:function(e){return e==1?0:e>=2&&e<=4?1:2},7:function(e){return e==1?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},8:function(e){return e==1?0:e==2?1:e!=8&&e!=11?2:3},9:function(e){return+(e>=2)},10:function(e){return e==1?0:e==2?1:e<7?2:e<11?3:4},11:function(e){return e==1||e==11?0:e==2||e==12?1:e>2&&e<20?2:3},12:function(e){return+(e%10!=1||e%100==11)},13:function(e){return+(e!==0)},14:function(e){return e==1?0:e==2?1:e==3?2:3},15:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2},16:function(e){return e%10==1&&e%100!=11?0:e!==0?1:2},17:function(e){return e==1||e%10==1&&e%100!=11?0:1},18:function(e){return e==0?0:e==1?1:2},19:function(e){return e==1?0:e==0||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3},20:function(e){return e==1?0:e==0||e%100>0&&e%100<20?1:2},21:function(e){return e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0},22:function(e){return e==1?0:e==2?1:(e<0||e>10)&&e%10==0?2:3}},bd=["v1","v2","v3"],xd=["v4"],is={zero:0,one:1,two:2,few:3,many:4,other:5};function Td(){let e={};return hd.forEach(t=>{t.lngs.forEach(r=>{e[r]={numbers:t.nr,plurals:yd[t.fc]}})}),e}var Mn=class{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=r,this.logger=he.create("pluralResolver"),(!this.options.compatibilityJSON||xd.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=Td()}addRule(t,r){this.rules[t]=r}getRule(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(Tr(t),{type:r.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(t,r);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}getPluralFormsOfKey(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,n).map(i=>`${r}${i}`)}getSuffixes(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(t,r);return n?this.shouldUseIntlApi()?n.resolvedOptions().pluralCategories.sort((i,a)=>is[i]-is[a]).map(i=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${i}`):n.numbers.map(i=>this.getSuffix(t,i,r)):[]}getSuffix(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=this.getRule(t,n);return i?this.shouldUseIntlApi()?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(r)}`:this.getSuffixRetroCompatible(i,r):(this.logger.warn(`no plural rule found for: ${t}`),"")}getSuffixRetroCompatible(t,r){let n=t.noAbs?t.plurals(r):t.plurals(Math.abs(r)),i=t.numbers[n];this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1&&(i===2?i="plural":i===1&&(i=""));let a=()=>this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString();return this.options.compatibilityJSON==="v1"?i===1?"":typeof i=="number"?`_plural_${i.toString()}`:a():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1?a():this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString()}shouldUseIntlApi(){return!bd.includes(this.options.compatibilityJSON)}};function as(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=fd(e,t,r);return!a&&i&&typeof r=="string"&&(a=xr(e,r,n),a===void 0&&(a=xr(t,r,n))),a}var Ln=class{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=he.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(r=>r),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});let r=t.interpolation;this.escape=r.escape!==void 0?r.escape:md,this.escapeValue=r.escapeValue!==void 0?r.escapeValue:!0,this.useRawValueToEscape=r.useRawValueToEscape!==void 0?r.useRawValueToEscape:!1,this.prefix=r.prefix?ot(r.prefix):r.prefixEscaped||"{{",this.suffix=r.suffix?ot(r.suffix):r.suffixEscaped||"}}",this.formatSeparator=r.formatSeparator?r.formatSeparator:r.formatSeparator||",",this.unescapePrefix=r.unescapeSuffix?"":r.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":r.unescapeSuffix||"",this.nestingPrefix=r.nestingPrefix?ot(r.nestingPrefix):r.nestingPrefixEscaped||ot("$t("),this.nestingSuffix=r.nestingSuffix?ot(r.nestingSuffix):r.nestingSuffixEscaped||ot(")"),this.nestingOptionsSeparator=r.nestingOptionsSeparator?r.nestingOptionsSeparator:r.nestingOptionsSeparator||",",this.maxReplaces=r.maxReplaces?r.maxReplaces:1e3,this.alwaysFormat=r.alwaysFormat!==void 0?r.alwaysFormat:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let t=`${this.prefix}(.+?)${this.suffix}`;this.regexp=new RegExp(t,"g");let r=`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`;this.regexpUnescape=new RegExp(r,"g");let n=`${this.nestingPrefix}(.+?)${this.nestingSuffix}`;this.nestingRegexp=new RegExp(n,"g")}interpolate(t,r,n,i){let a,o,s,l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function u(h){return h.replace(/\$/g,"$$$$")}let c=h=>{if(h.indexOf(this.formatSeparator)<0){let w=as(r,l,h,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(w,void 0,n,{...i,...r,interpolationkey:h}):w}let T=h.split(this.formatSeparator),g=T.shift().trim(),v=T.join(this.formatSeparator).trim();return this.format(as(r,l,g,this.options.keySeparator,this.options.ignoreJSONStructure),v,n,{...i,...r,interpolationkey:g})};this.resetRegExp();let p=i&&i.missingInterpolationHandler||this.options.missingInterpolationHandler,f=i&&i.interpolation&&i.interpolation.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:h=>u(h)},{regex:this.regexp,safeValue:h=>this.escapeValue?u(this.escape(h)):u(h)}].forEach(h=>{for(s=0;a=h.regex.exec(t);){let T=a[1].trim();if(o=c(T),o===void 0)if(typeof p=="function"){let v=p(t,a,i);o=typeof v=="string"?v:""}else if(i&&Object.prototype.hasOwnProperty.call(i,T))o="";else if(f){o=a[0];continue}else this.logger.warn(`missed to pass in variable ${T} for interpolating ${t}`),o="";else typeof o!="string"&&!this.useRawValueToEscape&&(o=ts(o));let g=h.safeValue(o);if(t=t.replace(a[0],g),f?(h.regex.lastIndex+=o.length,h.regex.lastIndex-=a[0].length):h.regex.lastIndex=0,s++,s>=this.maxReplaces)break}}),t}nest(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,a,o;function s(l,u){let c=this.nestingOptionsSeparator;if(l.indexOf(c)<0)return l;let p=l.split(new RegExp(`${c}[ ]*{`)),f=`{${p[1]}`;l=p[0],f=this.interpolate(f,o);let m=f.match(/'/g),h=f.match(/"/g);(m&&m.length%2===0&&!h||h.length%2!==0)&&(f=f.replace(/'/g,'"'));try{o=JSON.parse(f),u&&(o={...u,...o})}catch(T){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,T),`${l}${c}${f}`}return delete o.defaultValue,l}for(;i=this.nestingRegexp.exec(t);){let l=[];o={...n},o=o.replace&&typeof o.replace!="string"?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let u=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){let c=i[1].split(this.formatSeparator).map(p=>p.trim());i[1]=c.shift(),l=c,u=!0}if(a=r(s.call(this,i[1].trim(),o),o),a&&i[0]===t&&typeof a!="string")return a;typeof a!="string"&&(a=ts(a)),a||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${t}`),a=""),u&&(a=l.reduce((c,p)=>this.format(c,p,n.lng,{...n,interpolationkey:i[1].trim()}),a.trim())),t=t.replace(i[0],a),this.regexp.lastIndex=0}return t}};function vd(e){let t=e.toLowerCase().trim(),r={};if(e.indexOf("(")>-1){let n=e.split("(");t=n[0].toLowerCase().trim();let i=n[1].substring(0,n[1].length-1);t==="currency"&&i.indexOf(":")<0?r.currency||(r.currency=i.trim()):t==="relativetime"&&i.indexOf(":")<0?r.range||(r.range=i.trim()):i.split(";").forEach(o=>{if(!o)return;let[s,...l]=o.split(":"),u=l.join(":").trim().replace(/^'+|'+$/g,"");r[s.trim()]||(r[s.trim()]=u),u==="false"&&(r[s.trim()]=!1),u==="true"&&(r[s.trim()]=!0),isNaN(u)||(r[s.trim()]=parseInt(u,10))})}return{formatName:t,formatOptions:r}}function st(e){let t={};return function(n,i,a){let o=i+JSON.stringify(a),s=t[o];return s||(s=e(Tr(i),a),t[o]=s),s(n)}}var Dn=class{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=he.create("formatter"),this.options=t,this.formats={number:st((r,n)=>{let i=new Intl.NumberFormat(r,{...n});return a=>i.format(a)}),currency:st((r,n)=>{let i=new Intl.NumberFormat(r,{...n,style:"currency"});return a=>i.format(a)}),datetime:st((r,n)=>{let i=new Intl.DateTimeFormat(r,{...n});return a=>i.format(a)}),relativetime:st((r,n)=>{let i=new Intl.RelativeTimeFormat(r,{...n});return a=>i.format(a,n.range||"day")}),list:st((r,n)=>{let i=new Intl.ListFormat(r,{...n});return a=>i.format(a)})},this.init(t)}init(t){let n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=n.formatSeparator?n.formatSeparator:n.formatSeparator||","}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=st(r)}format(t,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return r.split(this.formatSeparator).reduce((s,l)=>{let{formatName:u,formatOptions:c}=vd(l);if(this.formats[u]){let p=s;try{let f=i&&i.formatParams&&i.formatParams[i.interpolationkey]||{},m=f.locale||f.lng||i.locale||i.lng||n;p=this.formats[u](s,m,{...c,...i,...f})}catch(f){this.logger.warn(f)}return p}else this.logger.warn(`there was no format function for ${u}`);return s},t)}};function _d(e,t){e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)}var Bn=class extends lt{constructor(t,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=r,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=he.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(n,i.backend,i)}queueLoad(t,r,n,i){let a={},o={},s={},l={};return t.forEach(u=>{let c=!0;r.forEach(p=>{let f=`${u}|${p}`;!n.reload&&this.store.hasResourceBundle(u,p)?this.state[f]=2:this.state[f]<0||(this.state[f]===1?o[f]===void 0&&(o[f]=!0):(this.state[f]=1,c=!1,o[f]===void 0&&(o[f]=!0),a[f]===void 0&&(a[f]=!0),l[p]===void 0&&(l[p]=!0)))}),c||(s[u]=!0)}),(Object.keys(a).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(a),pending:Object.keys(o),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(l)}}loaded(t,r,n){let i=t.split("|"),a=i[0],o=i[1];r&&this.emit("failedLoading",a,o,r),n&&this.store.addResourceBundle(a,o,n),this.state[t]=r?-1:2;let s={};this.queue.forEach(l=>{cd(l.loaded,[a],o),_d(l,t),r&&l.errors.push(r),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{s[u]||(s[u]={});let c=l.loaded[u];c.length&&c.forEach(p=>{s[u][p]===void 0&&(s[u][p]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",s),this.queue=this.queue.filter(l=>!l.done)}read(t,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!t.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:n,tried:i,wait:a,callback:o});return}this.readingCalls++;let s=(u,c)=>{if(this.readingCalls--,this.waitingReads.length>0){let p=this.waitingReads.shift();this.read(p.lng,p.ns,p.fcName,p.tried,p.wait,p.callback)}if(u&&c&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,n,i+1,a*2,o)},a);return}o(u,c)},l=this.backend[n].bind(this.backend);if(l.length===2){try{let u=l(t,r);u&&typeof u.then=="function"?u.then(c=>s(null,c)).catch(s):s(null,u)}catch(u){s(u)}return}return l(t,r,s)}prepareLoading(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();typeof t=="string"&&(t=this.languageUtils.toResolveHierarchy(t)),typeof r=="string"&&(r=[r]);let a=this.queueLoad(t,r,n,i);if(!a.toLoad.length)return a.pending.length||i(),null;a.toLoad.forEach(o=>{this.loadOne(o)})}load(t,r,n){this.prepareLoading(t,r,{},n)}reload(t,r,n){this.prepareLoading(t,r,{reload:!0},n)}loadOne(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=t.split("|"),i=n[0],a=n[1];this.read(i,a,"read",void 0,void 0,(o,s)=>{o&&this.logger.warn(`${r}loading namespace ${a} for language ${i} failed`,o),!o&&s&&this.logger.log(`${r}loaded namespace ${a} for language ${i}`,s),this.loaded(t,o,s)})}saveMissing(t,r,n,i,a){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${n}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if(this.backend&&this.backend.create){let l={...o,isUpdate:a},u=this.backend.create.bind(this.backend);if(u.length<6)try{let c;u.length===5?c=u(t,r,n,i,l):c=u(t,r,n,i),c&&typeof c.then=="function"?c.then(p=>s(null,p)).catch(s):s(null,c)}catch(c){s(c)}else u(t,r,n,i,s,l)}!t||!t[0]||this.store.addResource(t[0],r,n,i)}}};function os(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){let r={};if(typeof t[1]=="object"&&(r=t[1]),typeof t[1]=="string"&&(r.defaultValue=t[1]),typeof t[2]=="string"&&(r.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){let n=t[3]||t[2];Object.keys(n).forEach(i=>{r[i]=n[i]})}return r},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function ss(e){return typeof e.ns=="string"&&(e.ns=[e.ns]),typeof e.fallbackLng=="string"&&(e.fallbackLng=[e.fallbackLng]),typeof e.fallbackNS=="string"&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function yr(){}function wd(e){Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})}var Ar=class e extends lt{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(super(),this.options=ss(t),this.services={},this.logger=he,this.modules={external:[]},wd(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(){var t=this;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;typeof r=="function"&&(n=r,r={}),!r.defaultNS&&r.defaultNS!==!1&&r.ns&&(typeof r.ns=="string"?r.defaultNS=r.ns:r.ns.indexOf("translation")<0&&(r.defaultNS=r.ns[0]));let i=os();this.options={...i,...this.options,...ss(r)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...i.interpolation,...this.options.interpolation}),r.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=r.keySeparator),r.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=r.nsSeparator);function a(c){return c?typeof c=="function"?new c:c:null}if(!this.options.isClone){this.modules.logger?he.init(a(this.modules.logger),this.options):he.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:typeof Intl<"u"&&(c=Dn);let p=new wr(this.options);this.store=new vr(this.options.resources,this.options);let f=this.services;f.logger=he,f.resourceStore=this.store,f.languageUtils=p,f.pluralResolver=new Mn(p,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),c&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(f.formatter=a(c),f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new Ln(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new Bn(a(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",function(m){for(var h=arguments.length,T=new Array(h>1?h-1:0),g=1;g<h;g++)T[g-1]=arguments[g];t.emit(m,...T)}),this.modules.languageDetector&&(f.languageDetector=a(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=a(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new _r(this.services,this.options),this.translator.on("*",function(m){for(var h=arguments.length,T=new Array(h>1?h-1:0),g=1;g<h;g++)T[g-1]=arguments[g];t.emit(m,...T)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,n||(n=yr),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=function(){return t.store[c](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=function(){return t.store[c](...arguments),t}});let l=wt(),u=()=>{let c=(p,f)=>{this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(f),n(p,f)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),l}loadResources(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yr,i=typeof t=="string"?t:this.language;if(typeof t=="function"&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if(i&&i.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();let a=[],o=s=>{if(!s||s==="cimode")return;this.services.languageUtils.toResolveHierarchy(s).forEach(u=>{u!=="cimode"&&a.indexOf(u)<0&&a.push(u)})};i?o(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>o(l)),this.options.preload&&this.options.preload.forEach(s=>o(s)),this.services.backendConnector.load(a,this.options.ns,s=>{!s&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(s)})}else n(null)}reloadResources(t,r,n){let i=wt();return t||(t=this.languages),r||(r=this.options.ns),n||(n=yr),this.services.backendConnector.reload(t,r,a=>{i.resolve(),n(a)}),i}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&us.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let r=0;r<this.languages.length;r++){let n=this.languages[r];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}changeLanguage(t,r){var n=this;this.isLanguageChangingTo=t;let i=wt();this.emit("languageChanging",t);let a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},o=(l,u)=>{u?(a(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,i.resolve(function(){return n.t(...arguments)}),r&&r(l,function(){return n.t(...arguments)})},s=l=>{!t&&!l&&this.services.languageDetector&&(l=[]);let u=typeof l=="string"?l:this.services.languageUtils.getBestMatchFromCodes(l);u&&(this.language||a(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,c=>{o(c,u)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?s(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(t),i}getFixedT(t,r,n){var i=this;let a=function(o,s){let l;if(typeof s!="object"){for(var u=arguments.length,c=new Array(u>2?u-2:0),p=2;p<u;p++)c[p-2]=arguments[p];l=i.options.overloadTranslationOptionHandler([o,s].concat(c))}else l={...s};l.lng=l.lng||a.lng,l.lngs=l.lngs||a.lngs,l.ns=l.ns||a.ns,l.keyPrefix=l.keyPrefix||n||a.keyPrefix;let f=i.options.keySeparator||".",m;return l.keyPrefix&&Array.isArray(o)?m=o.map(h=>`${l.keyPrefix}${f}${h}`):m=l.keyPrefix?`${l.keyPrefix}${f}${o}`:o,i.t(m,l)};return typeof t=="string"?a.lng=t:a.lngs=t,a.ns=r,a.keyPrefix=n,a}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let n=r.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,a=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;let o=(s,l)=>{let u=this.services.backendConnector.state[`${s}|${l}`];return u===-1||u===2};if(r.precheck){let s=r.precheck(this,o);if(s!==void 0)return s}return!!(this.hasResourceBundle(n,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(n,t)&&(!i||o(a,t)))}loadNamespaces(t,r){let n=wt();return this.options.ns?(typeof t=="string"&&(t=[t]),t.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{n.resolve(),r&&r(i)}),n):(r&&r(),Promise.resolve())}loadLanguages(t,r){let n=wt();typeof t=="string"&&(t=[t]);let i=this.options.preload||[],a=t.filter(o=>i.indexOf(o)<0);return a.length?(this.options.preload=i.concat(a),this.loadResources(o=>{n.resolve(),r&&r(o)}),n):(r&&r(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!t)return"rtl";let r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=this.services&&this.services.languageUtils||new wr(os());return r.indexOf(n.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return new e(t,r)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yr,n=t.forkResourceStore;n&&delete t.forkResourceStore;let i={...this.options,...t,isClone:!0},a=new e(i);return(t.debug!==void 0||t.prefix!==void 0)&&(a.logger=a.logger.clone(t)),["store","services","language"].forEach(s=>{a[s]=this[s]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},n&&(a.store=new vr(this.store.data,i),a.services.resourceStore=a.store),a.translator=new _r(a.services,i),a.translator.on("*",function(s){for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];a.emit(s,...u)}),a.init(i,r),a.translator.options=i,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}},te=Ar.createInstance();te.createInstance=Ar.createInstance;var WA=te.createInstance,zA=te.dir,qA=te.init,XA=te.loadResources,YA=te.reloadResources,JA=te.use,QA=te.changeLanguage,ZA=te.getFixedT,cs=te.t,eS=te.exists,tS=te.setDefaultNamespace,rS=te.hasLoadedNamespace,nS=te.loadNamespaces,iS=te.loadLanguages;var Fe=V(q());var Sr=class e{constructor(t,r,n,i){this.db=null;this.dbName="";this.storeName="";this.dbMapKey="";this.idbMapKey="";if(this.dbMapKey=`${t}_${i||1}`,this.idbMapKey=`${t}_${r}`,e.IDB_MAP[this.idbMapKey])return e.IDB_MAP[this.idbMapKey];e.IDB_MAP[this.idbMapKey]=this,this.dbName=t,this.storeName=r,this.onUpgrade=n.onUpgrade,this.onError=n.onError,this.version=i}static{this.DB_MAP={}}static{this.IDB_MAP={}}async openDB(){let{dbName:t,version:r,onUpgrade:n,onError:i}=this;return e.DB_MAP[this.dbMapKey]?e.DB_MAP[this.dbMapKey]:new Promise((a,o)=>{let s=indexedDB.open(t,r);s.onerror=l=>{o(l)},s.onblocked=l=>{o(l)},s.onupgradeneeded=l=>{n(s.result,l)},s.onsuccess=()=>{let l=s.result;this.db=e.DB_MAP[this.dbMapKey]=l,l.onerror=u=>{i?.(u)},l.onversionchange=()=>{l.close(),this.db=null,delete e.DB_MAP[this.dbMapKey]},a(l)}})}async removeDB(){let t=indexedDB.deleteDatabase(this.dbName);return new Promise((r,n)=>{t.onerror=i=>{n(i)},t.onblocked=i=>{n(i)},t.onsuccess=()=>{r(!0)}})}async transactionAction(t,r){this.db||(this.db=await this.openDB());let n=this.db.transaction(this.storeName,r).objectStore(this.storeName);return new Promise((i,a)=>{let o=t(n);o.onerror=a,o.onsuccess=()=>i(o.result)})}getData(t){return this.transactionAction(r=>r.get(t))}addData(t,r){return this.transactionAction(n=>n.add(t,r),"readwrite")}setData(t,r){return this.transactionAction(n=>n.put(t,r),"readwrite")}deleteData(t){return this.transactionAction(r=>r.delete(t),"readwrite")}clearData(){return this.transactionAction(t=>t.clear(),"readwrite")}};function Ad(e){return new Sr("CACHE",e,{onUpgrade(t){try{t.createObjectStore("TRANSLATION_CACHE",{keyPath:"key"})}catch{}}},1)}function Er(){return Ad("TRANSLATION_CACHE")}var At=class{constructor(t=[new Un,new Gn]){this.cahce=new Kn;this.translators=[];this.CHOOSE_DURATION=5*60*1e3;this.lastChooseTime=0;this.translators=t,this.translator=this.translators[0],this.chooseTranslator=me(this.chooseTranslator.bind(this))}async translate(t,r,n="",i=!0){let a={},o=i?[]:t,s={};if(i){let c=await this.cahce.get(t.map(p=>({originalText:p,fromCode:n,toCode:r,translatorName:this.translator.name})));for(let p=0;p<t.length;p++){let f=t[p],m=c[p];m?a[p]=m:(s[p]=o.length,o.push(f))}}let l=o.length?await this.translator.translate(o,r,n).catch(async c=>{throw this.lastChooseTime=0,await this.chooseTranslator(),c}):[];i&&l.length&&this.cahce.set(o.map((c,p)=>({originalText:c,fromCode:n,toCode:r,translatedText:l[p],translatorName:this.translator.name})));let u=i?t.map((c,p)=>{let f=a[p];return f||l[s[p]]}):l;return this.chooseTranslator(),u}abort(){this.translator.abort()}async chooseTranslator(){if(!(this.translators.length<=1)&&!(Date.now()-this.lastChooseTime<this.CHOOSE_DURATION)){this.lastChooseTime=Date.now();try{this.translator=await Promise.any(this.translators.map(t=>ar(t.translate(["hello world"],"es").then(()=>t),3e3)))}catch{this.translator=this.translators[0]}}}},Ir=class{constructor(){this.name="";this.controller=new AbortController}abort(){this.controller.abort()}},Gn=class extends Ir{constructor(){super(...arguments);this.name="google";this.URL="https://translate.googleapis.com/translate_a/single";this.SEPARATOR=`



`}async translate(r,n,i=""){if(n=Pr(n),i=Pr(i),n===i||!r.length)return[...r];let a=r.map(l=>l.replace(/\n{2,}/g,`
`)).join(this.SEPARATOR),o=await fetch(`${this.URL}?client=gtx&dt=t&dj=1&sl=${i||"auto"}&tl=${n}&q=${encodeURIComponent(a)}`,{signal:this.controller.signal});if(!o.ok)throw new Error("google translate fail");let s=await o.json();return this.parseResult(s)}parseResult(r){let{paragraphGroup:n,sentences:i}=r;return(i||n).reduce((a,o)=>a+o.trans,"").split(this.SEPARATOR)}},Un=class extends Ir{constructor(){super();this.name="bing";this.URL="https://api-edge.cognitive.microsofttranslator.com/translate";this.AUTH_URL="https://edge.microsoft.com/translate/auth";this.token="";this.getToken=me(this.getToken.bind(this))}async translate(r,n,i=""){if(n=Pr(n),i=Pr(i),n===i||!r.length)return[...r];this.token||(this.token=await this.getToken());let a=r.map(u=>({Text:u})),o=()=>fetch(`${this.URL}?from=${i}&to=${n}&api-version=3.0`,{signal:this.controller.signal,method:"POST",body:JSON.stringify(a),headers:{authorization:`Bearer ${this.token}`,"content-type":"application/json"}}),s=await o();if(s.status===401&&(this.token=await this.getToken(!1),s=await o()),!s.ok)throw new Error("bing translate fail");return(await s.json()).map(u=>u.translations[0].text)}async getToken(r=!0){let n="__bing_translation_token__",i="";if(r){let a=await J(n);a&&(i=a)}if(!i){let a=await fetch(this.AUTH_URL,{method:"GET",headers:{}});if(!a.ok)throw new Error("bing token fail");i=await a.text(),await O({[n]:i})}return i}};function Pr(e){switch(e){case"zh_CN":return"zh-Hans";case"zh_TW":return"zh-Hant";case"auto":return"";default:return e}}var Kn=class{async get(t){let r=t.map(({originalText:i,toCode:a,fromCode:o,translatorName:s})=>this.getKey(i,a,o,s)),n=[];try{if(Fe.default.tabs){let i=Er();n=await Promise.all(r.map(a=>i.getData(a)))}else n=await Fe.default.runtime.sendMessage({type:"TRANSLATION_CACHE",action:"get",keys:r})}catch{}return n.map(i=>i?.text)}async set(t){let r=t.map(({originalText:n,toCode:i,fromCode:a,translatedText:o,translatorName:s})=>({key:this.getKey(n,i,a,s),text:o,updateAt:Date.now()}));try{if(Fe.default.tabs){let n=Er();await Promise.all(r.map(i=>n.setData(i)))}else await Fe.default.runtime.sendMessage({type:"TRANSLATION_CACHE",action:"set",values:r})}catch{}}async clear(){try{Fe.default.tabs?await Er().clearData():await Fe.default.runtime.sendMessage({type:"TRANSLATION_CACHE",action:"clear"})}catch{}}getKey(t,r,n,i){return ir(`${i||""}_${n}_${r}_${t}`)}};var fs=["SCRIPT","NOSCRIPT","STYLE","TEXTAREA","PRE","svg","TITLE","HEAD","SVG","RUBY","METER","PROCESS","SLOT","math","MATH"],ps=[".notranslate","[translate=no]"],ms=["CODE","PRE","ABBR","ACRONYM","KBD","SAMP","VAR","TIME"];var z="sider-trans",ds=z.toLowerCase(),Et="sider-trans-inline",Fn="sider-trans-block",St="sider-trans-text",gs=`<svg
  class="${z}-icon ${z}-loading"
  style="display: inline;"
  width="12"
  height="12"
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
  viewBox="0 0 24 24"
>
  <circle opacity="0.25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
  <path
    opacity="0.75"
    fill="currentColor"
    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
  ></path>
</svg>`,hs=`<svg class="${z}-icon ${z}-refresh" style="display: inline;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="12" height="12"><path d="M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z" fill="currentColor"></path></svg>`,Nr=`${z}-style`,ys=`
@keyframes ${z}-spin {
  to {transform: rotate(360deg);}
}

${z} * {
  visibility: visible !important;
}

${St}[data-display="underline"] {
  padding-bottom: 3px;
  background-image: linear-gradient(to right, #94a3b8 30%, rgba(255, 255, 255, 0) 0%);
  background-position: bottom;
  background-size: 5px 1px;
  background-repeat: repeat-x;
}
${St}[data-display="weaken"] {
  opacity: 0.6 !important;
}

${Et} {
  margin-inline-start: 4px !important;
}
${Fn} {
  display: block;
  margin: 4px 0 8px !important;
}
.${z}-icon {
  display: inline !important;
  border: none !important;
  background: transparent !important;
  color: #8a57ea !important;
  vertical-align: middle !important;
  fill: none !important;
  stroke: none !important;
}
.${z}-loading {
  animation: ${z}-spin 1s linear infinite !important;
}
.${z}-refresh {
  cursor: pointer;
}
`;function bs(e){let t=e;if(!t||Ed(t))return!1;for(;t&&t.nodeName!=="BODY";){if(Id(t)||Sd(t))return!1;t=t.parentElement}return!0}function Sd(e){let{display:t,opacity:r}=getComputedStyle(e);return t==="none"||r==="0"}function Ed(e){let{visibility:t}=getComputedStyle(e);return t==="hidden"}function Id(e){let t=e.nodeName;return!!(fs.includes(t)||ps.some(r=>e.matches(r)))}function xs(e){let t=e.map(r=>r.nodeValue||"").join("").trim();if(Pd(t))return!0;if(e.length<=1){let r=e[0]?.parentNode;for(;r&&r.nodeName!=="BODY";){if(r.nodeName==="CODE")return!0;r=r.parentNode}}return!1}function Pd(e){return e=e.trim(),!!(e.length<2||/^(.){0,3}(\d*[,:._-])*\d+(.){0,5}$/g.test(e)||/^(([A-Z0-9]+[_-])*[A-Z0-9]){1,8}$/g.test(e)||/^\w+@\w+[.]\w+$/g.test(e)||/^(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)$/.test(e)||/^@[\S]+$/g.test(e)||/^[-`~!@#$%^&*()_+=[\]{};:'",<.>/?]+$/g.test(e))}function $n(e){let{display:t}=getComputedStyle(e);return t==="none"||t.includes("inline")}function Hn(e){return!$n(e)}function Ts(e){let t=e.parentElement;for(;t&&t.nodeName!=="BODY"&&!Hn(t);)t=t.parentElement;return t}function vs(e){let t=e.parentElement,r=null;for(;t&&t.nodeName!=="BODY"&&$n(t);)r=t,t=t.parentElement;return r}function Vn(e){let t=e.parentElement,r=null;for(;t&&t.nodeName!=="BODY"&&$n(t)&&t.childNodes.length===1;)r=t,t=t.parentElement;return r}function _s(e){for(;e.children.length>0;)e=e.children?.[0];return e}function Wn(e,t){t.parentElement?.insertBefore(e,t.nextSibling)}var Cd=window.top!==window;var It=class extends de{constructor(){super();this.toCode="";this.fromCode="";this.displayStyle="none";this.translator=new At;this.state="initial";this.items=new Set;this.maxTranslateItems=30;this.waitingTranslateItems=[];this.retryTranslateItems=[];this.textNodeSet=new WeakSet;this.walking=!1;this.walkAgain=!0;this.cleaning=!1;this.ob=null;this.startTranslateDebounced=Y(this.startTranslate.bind(this),50),this.getTranslateItemsDebounced=Y(this.getTranslateItems.bind(this),100)}observeMutation(){this.ob||(this.ob=new MutationObserver(r=>{for(let n of r)n.addedNodes.forEach(i=>{let a=i.nodeName;i.nodeType===Node.ELEMENT_NODE&&a!==ds&&a!=="svg"&&i.textContent&&!i.closest(z)&&this.getTranslateItemsDebounced()})}),this.ob.observe(document.body,{subtree:!0,childList:!0}))}async translate(r,n=""){if(!document.body)return;this.sendMessage("translate",[r,n]);let i=!!this.toCode&&(this.toCode!==r||this.fromCode!==n);if(!(this.state==="translated"&&!i)){if(this.toCode=r,this.fromCode=n,i){this.unmountTranslateItems(),this.items.forEach(a=>a.refresh());return}if(this.state==="reset"){this.items.forEach(a=>a.remount()),this.state="translated",this.emit("stateChange",this.state),this.observeMutation();return}this.injectCSS(),this.getTranslateItems(),this.observeMutation()}}reset(){this.sendMessage("reset"),this.state==="translated"&&(this.ob?.disconnect(),this.ob=null,this.unmountTranslateItems(),this.state="reset",this.emit("stateChange",this.state))}clear(){this.sendMessage("clear"),this.state!=="initial"&&(this.ob?.disconnect(),this.ob=null,this.walking=!1,this.walkAgain=!0,this.cleaning=!1,this.removeCSS(),this.unmountTranslateItems(),this.items.clear(),this.textNodeSet=new WeakSet,this.waitingTranslateItems=[],this.retryTranslateItems=[],this.state="initial",this.emit("stateChange",this.state))}toggle(r,n=""){this.state==="translated"?this.reset():this.translate(r,n)}changeDisplayStyle(r){this.sendMessage("changeDisplayStyle",[r]),this.displayStyle=r,this.items.forEach(n=>{n.changeDisplayStyle(r)})}sendMessage(r,n){Cd||Ge({type:"PAGETRANSLAE_PROXY",data:{action:r,args:n}})}getTranslateItems(){this.walkTree(),this.cleanNodes()}walkTree(){if(this.walking){this.walkAgain=!0;return}this.walking=!0;let r=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,a=>{if(this.textNodeSet.has(a))return NodeFilter.FILTER_REJECT;let o=a.parentElement;return!(a.nodeValue||"").trim()||!o||o.closest(z)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}),n=null,i=[];pn(a=>{for(let o=0;a>0;a-=performance.now()-o){o=performance.now();let s=r.nextNode();if(!s)return n&&i.length&&this.newPageTranslateItem(i,n),this.walking=!1,this.walkAgain&&(this.walkAgain=!1,setTimeout(()=>{this.getTranslateItemsDebounced()},1e3)),!0;let l=Ts(s);if(!l||!bs(s.parentElement))continue;n||(n=l);let u=Vn(s),c=u?u.previousElementSibling:s.previousSibling,p=!1;c&&(p=c.nodeName==="BR"||c.nodeName==="LI"||("tagName"in c?Hn(c):!1)),n!==l||p?(this.newPageTranslateItem(i,n),n=l,i=[s]):i.push(s),this.walkAgain=!0}return!1})}cleanNodes(){if(this.cleaning)return;this.cleaning=!0;let r=this.items,n=function*(){for(let i of r)yield i}();pn(i=>{for(let a=0;i>0;i-=performance.now()-a){a=performance.now();let{done:o,value:s}=n.next();if(o||!s)return this.cleaning=!1,!0;s.removed&&(this.items.delete(s),s.textNodes.forEach(l=>this.textNodeSet.delete(l)))}return!1})}newPageTranslateItem(r,n){if(r.forEach(a=>this.textNodeSet.add(a)),xs(r))return;let i=new qn(r,n,this.displayStyle);this.items.add(i),i.on("visible",()=>{this.waitingTranslateItems.push(i),this.startTranslateDebounced()}).on("refresh",()=>{this.startTranslate(!0)})}async startTranslate(r=!1){let n=r?this.retryTranslateItems:this.waitingTranslateItems;if(!n.length)return;r?this.retryTranslateItems=[]:this.waitingTranslateItems=[];let i=r?Math.floor(this.maxTranslateItems*.8):this.maxTranslateItems,a=[];for(let o=0;o<n.length;o+=i)a.push(this.doTranslate(n.slice(o,o+i)));this.emit("loading",!0),await Promise.all(a),this.emit("loading",!1)}async doTranslate(r){if(!r.length)return;let n=!1,i=await ar(this.translator.translate(r.map(a=>(a.setLoading(!0),a.toBeTranslatedText)),this.toCode,this.fromCode),12e3).catch(()=>{n=!0,this.retryTranslateItems=[...this.retryTranslateItems,...r],r.forEach(a=>a.setTranslatedText(""))});if(!n){if(i)for(let a=0;a<r.length;a++){let o=r[a],s=i[a]||"";o.setTranslatedText(s)}this.state!=="translated"&&(this.state="translated",this.emit("stateChange",this.state))}}unmountTranslateItems(){this.items.forEach(r=>{r.unmount()})}injectCSS(){if(!document.querySelector(`#${Nr}`)){let n=document.createElement("style");n.id=Nr,n.innerHTML=ys,(document.head||document.body||document.documentElement)?.appendChild(n)}}removeCSS(){let r=document.querySelector(`#${Nr}`);r&&r.remove()}},zn=null,Cr=null,qn=class extends de{constructor(r,n,i){super();this.displayStyle="none";this._toBeTranslatedText="";this._rawText="";this.visible=!1;this.loading=!1;this.loadingNode=null;this.refreshNode=null;this.onlyChildContainerMap=new Map;this.ob=null;this.SEPARATOR_REG=/(.*?)< *sd *(\d+) *>([^]*?)<\/ *sd *(\d+) *>/g;this.TAG_REG=/(< *sd *\d+ *>)|(<\/ *sd *\d+ *>)/g;this.urlId="";this.displayStyle=i,this.urlId=ir(location.href),this.textNodes=r,this.blockContainer=n,this.translatedContainer=this.createTranslatedContainer(),this.textContainer=document.createElement(St),this.observeIntersection()}get rawText(){return this._rawText?this._rawText:this._rawText=this.textNodes.map(r=>r.nodeValue||"").join("").trim()}get toBeTranslatedText(){if(this._toBeTranslatedText)return this._toBeTranslatedText;if(this.textNodes.length<=1)return this._toBeTranslatedText=(this.textNodes[0]?.nodeValue||"").trim();let r=1;return this._toBeTranslatedText=this.textNodes.map(n=>{let i=n.parentElement,a=n.nodeValue||"",o=null;if(i&&i!==this.blockContainer&&(o=Vn(n))){let s=`sd${r++}`;return this.onlyChildContainerMap.set(s,o),`<${s}>${a}</${s}>`}return a}).join("").trim()}get removed(){return!this.textNodes[0].isConnected}observeIntersection(){this.ob||(this.ob=new IntersectionObserver(Y(r=>{!this.visible&&r[0].isIntersecting&&(this.visible=!0,this.mount(),this.emit("visible"),this.ob?.disconnect(),this.ob=null)},100),{rootMargin:`${innerHeight}px 0px ${innerHeight}px 0px`}),this.blockContainer&&this.ob.observe(this.blockContainer))}setLoading(r){if(this.loading!==r)if(this.loading=r,this.loading){if(!this.loadingNode){if(!zn){let n=document.createElement(Et);n.innerHTML=gs,zn=n}this.loadingNode=zn.cloneNode(!0)}this.emptyContainer(),this.translatedContainer.appendChild(this.loadingNode)}else this.loadingNode?.remove()}setRefreshIcon(){if(!this.refreshNode){if(!Cr){let r=document.createElement(Et);r.innerHTML=hs,Cr=r,Cr.setAttribute("title",cs("pageTranslation.transAgain"))}this.refreshNode=Cr.cloneNode(!0),this.refreshNode.onclick=()=>{this.emit("refresh")}}this.emptyContainer(),this.translatedContainer.appendChild(this.refreshNode)}setTranslatedText(r){if(this.setLoading(!1),!r){this.setRefreshIcon();return}let n=!1,{rawText:i}=this;i.match(/\p{Unified_Ideograph}/gu)?i.length<=.25*15&&(n=!0):i.length<=15&&i.split(" ").filter(l=>l.trim()).length<=2&&(n=!0);let a=this.parseTranslatedText(r),o=document.createDocumentFragment();a.forEach(({index:l,text:u})=>{if(!l)o.appendChild(document.createTextNode(u));else{let c=this.onlyChildContainerMap.get(`sd${l}`);if(c){let p=c.cloneNode(!0),f=_s(p);p.nodeName==="LI"&&(p.style.display="inline"),!["SUP","SUB"].includes(p.nodeName)&&!ms.includes(f.nodeName)&&(f.innerText=u),o.appendChild(p)}else o.appendChild(document.createTextNode(u))}}),this.emptyContainer(),this.textContainer=document.createElement(St),this.textContainer.dataset.display=this.displayStyle,this.textContainer.appendChild(o);let s=document.createElement(n?Et:Fn);s.appendChild(this.textContainer),this.translatedContainer.appendChild(s)}parseTranslatedText(r){let n=this.SEPARATOR_REG,i=[],a=r.replace(n,(o,s,l,u,c)=>(s&&i.push({text:s.replace(this.TAG_REG,"")}),u&&(l===c?i.push({index:l,text:u}):i.push({text:u.replace(this.TAG_REG,"")})),""));return a&&i.push({text:a.replace(this.TAG_REG,"")}),i}mount(){if(this.translatedContainer.isConnected)return;this.clearUnusedTranslatedContainer();let r=this.textNodes[this.textNodes.length-1];if(this.textNodes.length===1)Wn(this.translatedContainer,r);else{let n=vs(r);Wn(this.translatedContainer,n||r)}}unmount(){this.translatedContainer.remove(),this.ob?.disconnect(),this.ob=null}remount(){this.visible?this.mount():this.observeIntersection()}refresh(){this.emptyContainer(),this.visible=!1,this.observeIntersection()}changeDisplayStyle(r){this.displayStyle=r,this.textContainer.dataset.display=r}emptyContainer(){this.translatedContainer.isConnected?this.translatedContainer.childNodes.forEach(r=>r.remove()):this.translatedContainer=this.createTranslatedContainer()}createTranslatedContainer(){let r=document.createElement(z);return r.dataset.urlId=this.urlId,r}clearUnusedTranslatedContainer(){let r=`${z}:not([data-url-id="${this.urlId}"])`,n=this.blockContainer.querySelectorAll(r);n.length&&n.forEach(i=>i.remove())}};var Le=window.top!==window,Es=!Le,kr=un.sidebarShortcut,Rr=cn,Xn=new xt,As=new Tt;function kd(e){if(!e.isComposing){if(e.key==="Escape"){if(Reflect.get(window,"sider.comboboxOpen"))return;we.default.runtime.id&&we.default.runtime.sendMessage({type:"POPUP_OPEN",isShow:!1});return}(e.ctrlKey||e.metaKey||e.shiftKey||e.altKey)&&Ge({type:"KEYBOARD_MODIFIER_KEY",data:{Ctrl:e.ctrlKey,Meta:e.metaKey,Shift:e.shiftKey,Alt:e.altKey,key:e.key}}),kn(e,kr)&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),an()),kn(e,Rr)&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),we.default.runtime.id&&we.default.runtime.sendMessage({type:"TOGGLE_TRANSLATOR"}))}}async function Rd(e){e.target,e.target?.tagName==="CHATGPT-SIDEBAR"&&e.target?.shadowRoot?.querySelector(".query-chat-panel")||e.target?.id==="sider-translator"||e.target?.closest(".sider-remove-temp-btn")?(window.shouldClearSelection=!1,we.default.runtime.sendMessage({type:"set-should-clear-selection",value:!1})):(window.shouldClearSelection=!0,we.default.runtime.sendMessage({type:"set-should-clear-selection",value:!0}))}async function Od(e){let r=(jd(e)||{}).type,n=e.source;switch(r){case"get-iframe-pos":{let i=0,a=0;if(Le){let s=await Is();i=s.x-window.scrollX,a=s.y-window.scrollY}document.querySelectorAll("iframe").forEach(s=>{if(s.contentWindow&&n===s.contentWindow){let l=s.getBoundingClientRect();n.postMessage({type:"iframe-pos",pos:{x:i+l.left+window.scrollX,y:a+l.top+window.scrollY}},"*")}});break}case"iframe-click":{Es&&window.document.body.dispatchEvent(new CustomEvent("click"));break}}}function Or(e,t){Object.assign(e,t)}async function Md(){let{sidebarShortcut:e,translatorShortcut:t}=await J({sidebarShortcut:kr,translatorShortcut:Rr});Or(kr,e),Or(Rr,t)}async function Ld(){window.addEventListener("keydown",kd,!0),window.addEventListener("mousedown",Rd),window.addEventListener("message",Od),Le&&window.addEventListener("click",()=>{window.top?.postMessage(Ps({type:"iframe-click"}),"*")})}async function Dd(){we.default.storage.local.onChanged.addListener(t=>{if(t.sidebarShortcut){let r=t.sidebarShortcut.newValue||un.sidebarShortcut;Or(kr,r)}if(t.translatorShortcut){let r=t.translatorShortcut.newValue||cn;Or(Rr,r)}});let e=new It;if(Le){let t=await Ge({type:"SHOULD_I_TRANSLATE_PAGE"});t&&(e.changeDisplayStyle(t.displayStyle),e.translate(t.toCode,t.fromCode))}if(we.default.runtime.onMessage.addListener((t,r)=>{let n=to(t,r);if(n)return n;if(nn(t,"TEXT_INSERT_PROXY")){let i=t.data.action,a=t.data.args||[];Xn[i]?.(...a);return}switch(t.type){case"remove-selection":{let i=window.getSelection();i&&i.removeAllRanges();break}}if(Le){if(nn(t,"PAGETRANSLAE_PROXY")){let i=t.data.action,a=t.data.args||[];e[i]?.(...a)}}else switch(t.type){case"go-to-video-time":{es(t.time,t.url);break}case"get-readability-text":return Zo();case"WEB_PARSER_PROXY":{let i=t.action;return Me[i]?.()}}}),Es){let t;en("get-site-search-suggestion",async()=>t||(t=Cn().finally(()=>t=void 0))),location.origin==se.origin&&en("send-image-to-image-tools",({data:r})=>{let n=new CustomEvent("web-response",{detail:{type:"send-image-to-image-tools",data:r}});window.dispatchEvent(n)})}}function Is(){return new Promise((e,t)=>{let r=new AbortController;window.addEventListener("message",n=>{let i=n.data||{};i.type==="iframe-pos"&&(r.abort(),i.pos?e(i.pos):t(new Error("Failed to get iframe position")))},{signal:r.signal}),window.parent?.postMessage(Ps({type:"get-iframe-pos"}),"*")})}async function Bd(){Xn.register(),Xn.on("canInsert",({canInsert:e,triggerEl:t})=>{Le?Ge({type:"CAN_INSERT_CHANGE",data:{canInsert:e}}):window.dispatchEvent(new CustomEvent("CAN_INSERT_CHANGE",{detail:{canInsert:e,triggerEl:t}}))}),As.register(),As.on("select",async({text:e,triggerEl:t,pos:r})=>{let n=r.x||0,i=r.y||0;if(Le){let a=await Is();n+=a.x,i+=a.y}Le?Ge({type:"SELECT_TEXT_CHANGE",data:{text:e,pos:{x:n,y:i}}}):window.dispatchEvent(new CustomEvent("SELECT_TEXT_CHANGE",{detail:{text:e,triggerEl:t,pos:{x:n,y:i}}}))})}function Ps(e){return location.origin==="https://notebooks.githubusercontent.com"?{type:"render",payload:{},body:"",_data:e}:e}function jd(e){return e.origin==="https://notebooks.githubusercontent.com"?e.data._data:e.data}var Ss="__ALL_FRAMES_LISTEN__";window[Ss]||(window[Ss]=!0,Md(),Ld(),Dd(),Bd());})();
